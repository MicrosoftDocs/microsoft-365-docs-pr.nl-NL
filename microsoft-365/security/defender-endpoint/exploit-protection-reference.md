---
title: Gebruiksbeveiligingsverwijzing
keywords: risicobeperking, beveiligingslekken, kwetsbaarheid, mitigatie, misbruik, exploits, emet
description: Details over de manier waarop de exploitbeveiligingsfunctie werkt in Windows 10
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.date: 01/06/2021
ms.reviewer: cjacks
manager: dansimp
ms.custom: asr
ms.technology: mde
ms.topic: article
ms.openlocfilehash: a87215b0e23d56a73259bbee4600ec9e15a27f3b
ms.sourcegitcommit: dcb97fbfdae52960ae62b6faa707a05358193ed5
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 03/25/2021
ms.locfileid: "51199343"
---
# <a name="exploit-protection-reference"></a>Exploit Protection Reference

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


**Van toepassing op:**
- [Microsoft Defender voor Endpoint](https://go.microsoft.com/fwlink/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

>Wilt u Microsoft Defender voor Eindpunt ervaren? [Meld u aan voor een gratis proefabonnement.](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-enablesiem-abovefoldlink)

Exploitbeveiliging biedt geavanceerde beveiligingen voor toepassingen die de IT-professional kan toepassen nadat de ontwikkelaar de software heeft gecompileerd en gedistribueerd.

In dit artikel wordt beschreven hoe misbruikbeveiliging werkt, zowel op beleidsniveau als op individueel risicobeperkingsniveau, om u te helpen bij het maken en toepassen van exploitbeveiligingsbeleid.

## <a name="how-mitigations-are-applied"></a>Hoe mitigaties worden toegepast

Exploit Protection mitigaties worden per toepassing toegepast.

Risicobeperking wordt geconfigureerd via een registerinvoer voor elk programma waar u beveiligingen voor configureert. Deze instellingen worden opgeslagen in de **registerinvoer MitigationOptions** voor elk programma (HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Opties voor het uitvoeren van afbeeldingsbestand **\ *ImageFileName* \ MitigationOptions**). Deze worden van kracht wanneer u het programma opnieuw start en blijven van kracht totdat u ze wijzigt en het programma opnieuw start.

> [!IMPORTANT]
> Met Opties voor afbeeldingsbestandsuitvoering kunt u alleen een bestandsnaam of pad opgeven, en niet een versienummer, architectuur of een andere differentiator. Wees voorzichtig met het beperken van risico's voor apps met unieke namen of paden, waarbij deze alleen worden toegepast op apparaten waarop u die versie en die architectuur van de toepassing hebt getest.

Als u misbruikbeveiligingsbeperking configureert met behulp van een XML-configuratiebestand, hetzij via PowerShell, Groepsbeleid of MDM, worden bij het verwerken van dit XML-configuratiebestand afzonderlijke registerinstellingen voor u geconfigureerd.

Wanneer het beleid voor het distribueren van het XML-bestand niet meer wordt afgedwongen, worden instellingen die door dit XML-configuratiebestand worden geïmplementeerd, niet automatisch verwijderd. Als u de instellingen voor exploitbeveiliging wilt verwijderen, exporteert u de XML-configuratie van een schoon Windows 10-apparaat en implementeert u dit nieuwe XML-bestand. Microsoft biedt ook een XML-bestand als onderdeel van de Windows-beveiligingslijnlijnen voor het opnieuw instellen van de instellingen voor exploitbeveiliging.

Als u beveiligingsinstellingen voor exploits opnieuw wilt instellen met PowerShell, kunt u de volgende opdracht gebruiken:

```powershell
Set-ProcessMitigation -PolicyFilePath EP-reset.xml
```
Hieronder volgt de EP-reset.xml verdeeld met de Windows-beveiligingslijnlijnen:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<MitigationPolicy>
  <AppConfig Executable="ONEDRIVE.EXE">
    <DEP OverrideDEP="false" />
    <ASLR OverrideRelocateImages="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
  </AppConfig>
  <AppConfig Executable="firefox.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
  </AppConfig>
  <AppConfig Executable="fltldr.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
    <ChildProcess OverrideChildProcess="false" />
  </AppConfig>
  <AppConfig Executable="GROOVE.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
    <ChildProcess OverrideChildProcess="false" />
  </AppConfig>
  <AppConfig Executable="Acrobat.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="AcroRd32.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="chrome.exe">
    <DEP OverrideDEP="false" />
  </AppConfig>
  <AppConfig Executable="EXCEL.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="iexplore.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="INFOPATH.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="java.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="javaw.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="javaws.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="LYNC.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="MSACCESS.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="MSPUB.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="OIS.EXE">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="OUTLOOK.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="plugin-container.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="POWERPNT.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="PPTVIEW.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="VISIO.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="VPREVIEW.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="WINWORD.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="wmplayer.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="wordpad.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
</MitigationPolicy>
```

## <a name="mitigation-reference"></a>Mitigatieverwijzing

In de volgende secties worden de beveiligingen beschreven die worden geboden door elke beperking van de exploitbeveiliging, de compatibiliteitsoverwegingen voor de beperking en de beschikbare configuratieopties.

## <a name="arbitrary-code-guard"></a>Willekeurige codebeveiliger

### <a name="description"></a>Beschrijving

Willekeurige codebeveiliger beschermt tegen een kwaadwillende aanvaller die de code van zijn keuze in het geheugen laadt via een beveiligingsprobleem in het geheugen en die code kan uitvoeren.

Willekeurige codebeveiliger beschermt een toepassing tegen het uitvoeren van dynamisch gegenereerde code (code die niet wordt geladen, bijvoorbeeld van de exe zelf of een dll). Willekeurige codebeveiliger werkt door te voorkomen dat het geheugen wordt gemarkeerd als uitvoerbaar. Wanneer een toepassing geheugen [probeert toe te wijzen,](https://docs.microsoft.com/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)controleren we de beveiligingsvlaggen. (Geheugen kan worden toegewezen met lees-, schrijf- en/of uitvoerbeveiligingsvlaggen.) Als de toewijzing probeert [](https://docs.microsoft.com/windows/win32/memory/memory-protection-constants) de vlag voor het uitvoeren van beveiliging op te nemen, mislukt de toewijzing van het geheugen en wordt een foutcode (STATUS_DYNAMIC_CODE_BLOCKED). Als een toepassing op [](https://docs.microsoft.com/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) dezelfde manier probeert de beveiligingsvlaggen van [](https://docs.microsoft.com/windows/win32/memory/memory-protection-constants) het geheugen te wijzigen die al zijn toegewezen en de vlag voor het uitvoeren van beveiliging bevat, mislukt de machtigingswijziging en wordt een foutcode (STATUS_DYNAMIC_CODE_BLOCKED).

Door te voorkomen dat de *vlag* uitvoeren wordt ingesteld, kan de functie voor preventie van gegevensuitvoering van Windows 10 vervolgens worden beschermd tegen de instructieaanwijzer die is ingesteld op dat geheugen en die code uitvoert.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Willekeurige codebeveiliger voorkomt het toewijzen van geheugen als uitvoerbaar, wat een compatibiliteitsprobleem met benaderingen zoals JIT-compilers (Just-in-Time) presenteert. De meeste moderne browsers, bijvoorbeeld, compileren JavaScript in native code om de prestaties te optimaliseren. Om deze beperking te ondersteunen, moeten ze opnieuw worden gemaakt om de JIT-compilatie buiten het beveiligde proces te verplaatsen. Andere toepassingen waarvan het ontwerp dynamisch code genereert uit scripts of andere tussentalen, zijn op dezelfde manier niet compatibel met deze beperking.

### <a name="configuration-options"></a>Configuratieopties

**Opt-out van thread toestaan:** u kunt de beperking zo configureren dat een afzonderlijke thread zich kan opt-out van deze beveiliging. De ontwikkelaar moet de toepassing hebben geschreven met de kennis van deze beperking en de [**SetThreadInformation-API**](https://docs.microsoft.com/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadinformation) hebben gebeld met de parameter *ThreadInformation* die is ingesteld op **ThreadDynamicCodePolicy** om dynamische code op deze thread uit te kunnen voeren.

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met Geavanceerde jacht in [Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="block-low-integrity-images"></a>Afbeeldingen met een lage integriteit blokkeren

### <a name="description"></a>Beschrijving

Als u afbeeldingen met een lage integriteit blokkeert, wordt voorkomen dat de toepassing bestanden laadt die niet zijn vertrouwd, meestal omdat ze zijn gedownload van internet vanuit een sandbox-browser.

Deze beperking blokkeert het laden van afbeeldingen als de afbeelding een Access Control Entry (ACE) heeft die toegang verleent tot Low IL-processen en die geen vertrouwenslabel ACE heeft. Het wordt geïmplementeerd door de memory manager, die blokkeert dat het bestand in het geheugen wordt in kaart gebracht. Als een toepassing een afbeelding met een lage integriteit in kaart probeert te brengen, wordt er een fout STATUS_ACCESS_DENIED veroorzaakt. Zie Verplichte integriteitscontrole voor meer informatie over hoe [integriteitsniveaus werken.](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control)

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Als u afbeeldingen met een lage integriteit blokkeert, wordt voorkomen dat de toepassing bestanden laadt die van internet zijn gedownload. Als voor uw toepassingswerkstroom het laden van gedownloade afbeeldingen vereist is, wilt u ervoor zorgen dat ze worden gedownload vanuit een proces met een hogere vertrouwensrelatie of expliciet opnieuw worden gelabeld om deze beperking toe te passen.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="block-remote-images"></a>Externe afbeeldingen blokkeren

### <a name="description"></a>Beschrijving

Als u externe afbeeldingen blokkeert, voorkomt u dat de toepassing bestanden laadt die worden gehost op een extern apparaat, zoals een UNC-share. Als u externe afbeeldingen blokkeert, kunt u voorkomen dat binaries worden geladen in het geheugen op een extern apparaat dat door de aanvaller wordt beheerd.

Deze beperking blokkeert het laden van afbeeldingen als de afbeelding wordt bepaald op een extern apparaat. Het wordt geïmplementeerd door de memory manager, die blokkeert dat het bestand in het geheugen wordt in kaart gebracht. Als een toepassing een extern bestand in kaart probeert te brengen, wordt er een fout STATUS_ACCESS_DENIED veroorzaakt.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Als u externe afbeeldingen blokkeert, wordt voorkomen dat de toepassing afbeeldingen van externe apparaten laadt. Als uw toepassing bestanden of inpluggen laadt vanaf externe apparaten, is deze niet compatibel met deze beperking.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="block-untrusted-fonts"></a>Niet-vertrouwde lettertypen blokkeren

### <a name="description"></a>Beschrijving

Als u niet-vertrouwde lettertypen blokkeert, verkleint u het risico op een fout in het parseren van lettertypen, waardoor de aanvaller code op het apparaat kan uitvoeren. Alleen lettertypen die zijn geïnstalleerd in de windows\fonts-adreslijst, worden geladen voor verwerking door GDI.

Deze beperking wordt geïmplementeerd in GDI, waarmee de locatie van het bestand wordt gevalideerd. Als het bestand niet in de systeemlettertypenmap staat, wordt het lettertype niet geladen voor parsing en mislukt dat gesprek.

Deze beperking is een aanvulling op de ingebouwde beperking die wordt geboden in Windows 10 1607 en hoger, waardoor het parseren van lettertypen uit de kernel wordt verplaatst naar een app-container in de gebruikersmodus. Elke exploit op basis van het parseren van lettertypen vindt daarom plaats in een context met een sandbox en een geïsoleerde omgeving, waardoor het risico aanzienlijk wordt verkleind. Zie de blog [Hardening Windows 10 with zero-day exploit mitigations (Windows 10 hardening Windows 10 with zero-day exploit mitigations](https://www.microsoft.com/security/blog/2017/01/13/hardening-windows-10-with-zero-day-exploit-mitigations/)) voor meer informatie over deze beperking.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Het meest voorkomende gebruik van lettertypen buiten de systeemlettertypenmap is met [weblettertypen.](https://docs.microsoft.com/typography/fonts/font-faq#web) Moderne browsers, zoals Microsoft Edge, gebruiken DirectWrite in plaats van GDI en worden niet beïnvloed. Oudere browsers, zoals Internet Explorer 11 (en de IE-modus in de nieuwe Microsoft Edge) kunnen echter worden beïnvloed, met name bij toepassingen zoals Office 365, die lettertypen gebruiken om de gebruikersinterface weer te geven.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="code-integrity-guard"></a>Codeintegriteitswacht

### <a name="description"></a>Beschrijving

Codeintegriteitsbewaking zorgt ervoor dat alle binaries die in een proces zijn geladen, digitaal worden ondertekend door Microsoft. Codeintegriteitscontrole [bevat WHQL-handtekeningen](https://docs.microsoft.com/windows-hardware/drivers/install/whql-release-signature) (Windows Hardware Quality Labs), waarmee door WHQL goedgekeurde stuurprogramma's binnen het proces kunnen worden uitgevoerd.

Deze beperking wordt geïmplementeerd in de memory manager, waardoor de binaire optie niet in het geheugen wordt toegesneden. Als u probeert een binair te laden dat niet is ondertekend door Microsoft, retourneerd de geheugenmanger de foutmelding STATUS_INVALID_IMAGE_HASH. Door het blokkeren op het niveau van memory manager voorkomt u dat zowel binaries die worden geladen door het proces als binaries die in het proces zijn ingespoten, worden geladen.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Deze beperking blokkeert specifiek elke binaire optie die niet door Microsoft is ondertekend. Als zodanig is deze niet compatibel met de meeste software van derden, tenzij deze software wordt gedistribueerd door (en digitaal ondertekend door) de Microsoft Store en de optie voor het laden van afbeeldingen die zijn ondertekend door de Microsoft Store is geselecteerd.

### <a name="configuration-options"></a>Configuratieopties

Sta ook het laden toe van afbeeldingen die zijn ondertekend door **de Microsoft Store:** toepassingen die worden gedistribueerd door de Microsoft Store, worden digitaal ondertekend door de Microsoft Store. Als u deze configuratie toevoegt, kunnen binaries die het certificeringsproces voor de store hebben doorlopen, door de toepassing worden geladen.

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="control-flow-guard-cfg"></a>Control Flow Guard (CFG)

### <a name="description"></a>Beschrijving

Control Flow Guard (CFG) beperkt het risico van aanvallers met geheugencorruptieproblemen door indirecte functieoproepen te beschermen. Een aanvaller kan bijvoorbeeld een bufferoverloopprobleem gebruiken om geheugen met een functie-aanwijzer te overschrijven en deze functiewijzer te vervangen door een aanwijzer voor uitvoerbare code naar keuze (die mogelijk ook in het programma is ingespoten).

Deze beperking wordt geboden door een andere controle tijdens het compileren in te stellen. Vóór elke indirecte functieoproep worden er nog andere instructies toegevoegd om te controleren of het doel een geldig gespreksdoel is voordat het wordt aangeroepen. Als het doel geen geldig gespreksdoel is, wordt de toepassing beëindigd. Als zodanig kunnen alleen toepassingen die zijn gecompileerd met CFG-ondersteuning profiteren van deze beperking.

De controle op een geldig doel wordt geleverd door de Windows-kernel. Wanneer uitvoerbare bestanden worden geladen, worden de metagegevens voor indirecte oproepdoelen bij laadtijd geëxtraheerd en gemarkeerd als geldige gespreksdoelen. Wanneer geheugen wordt toegewezen en gemarkeerd als uitvoerbaar (zoals voor gegenereerde code), worden deze geheugenlocaties ook gemarkeerd als geldige gespreksdoelen, ter ondersteuning van mechanismen zoals JIT-compilatie.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Aangezien toepassingen moeten worden gecompileerd ter ondersteuning van CFG, verklaren ze impliciet hun compatibiliteit met cfg. De meeste toepassingen moeten daarom werken met deze beperking ingeschakeld. Omdat deze controles worden gecompileerd in het binaire bestand, is de configuratie die u kunt toepassen alleen om controles in de Windows-kernel uit te schakelen. Met andere woorden, de beperking is standaard ingeschakeld, maar u kunt de Windows-kernel zo configureren dat deze altijd 'ja' retourneert als u later vast stelt dat er een compatibiliteitsprobleem is dat de ontwikkelaar van de toepassing niet heeft ontdekt tijdens het testen, wat zeldzaam moet zijn.

### <a name="configuration-options"></a>Configuratieopties

**Strikt CFG** gebruiken: in de strikte modus moeten alle binaries die in het proces zijn geladen, worden gecompileerd voor Control Flow Guard (of moeten er geen uitvoerbare code in staan, zoals resourcedlls) om te kunnen worden geladen.

> [!Note]
> **Control Flow Guard** heeft geen auditmodus. Binaries worden gecompileerd met deze beperking ingeschakeld.

## <a name="data-execution-prevention-dep"></a>Preventie van gegevensuitvoering (DEP)

### <a name="description"></a>Beschrijving

Preventie van gegevensuitvoering (DEP) voorkomt dat geheugen dat niet expliciet als uitvoerbaar is toegewezen, wordt uitgevoerd. DEP helpt u te beschermen tegen een aanvaller die schadelijke code in het proces injecteert, bijvoorbeeld via een bufferoverloop en vervolgens die code uit te voeren.

Als u probeert de instructieaanwijzer in te stellen op een geheugenadres dat niet is gemarkeerd als uitvoerbaar, wordt er een uitzondering (algemene beveiligingsovertreding) gegeven, waardoor de toepassing vast loopt.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Alle x64 ARM en ARM-64 uitvoerbare bestanden hebben standaard DEP ingeschakeld en kunnen niet worden uitgeschakeld. Aangezien een toepassing nooit zonder DEP is uitgevoerd, wordt uitgegaan van compatibiliteit.

Alle x86-binaries (32-bits) hebben standaard DEP ingeschakeld, maar DEP kan per proces worden uitgeschakeld. Sommige oude oudere toepassingen, meestal toepassingen die zijn ontwikkeld vóór Windows XP SP2, zijn mogelijk niet compatibel met DEP. Dergelijke toepassingen genereren meestal code dynamisch (bijvoorbeeld JIT-compileren) of koppelen aan oudere bibliotheken (zoals oudere versies van ATL) die dynamisch code genereren.

### <a name="configuration-options"></a>Configuratieopties

**ATL Thunk-emulatie inschakelen:** met deze configuratieoptie schakelt u ATL Thunk-emulatie uit. ATL, de ActiveX-sjabloonbibliotheek, is ontworpen om zo klein en snel mogelijk te zijn. Om de binaire grootte te verkleinen, wordt een techniek gebruikt die *thunking wordt genoemd.* Thunking wordt meestal gebruikt voor de interactie tussen 32-bits en 16-bits toepassingen, maar er zijn hier geen 16-bits onderdelen in ATL. Om de binaire grootte te optimaliseren, wordt in ATL machinecode in het geheugen opgeslagen die niet is uitgelijnd (waardoor een kleiner binair getal wordt gemaakt) en wordt deze code vervolgens rechtstreeks aanroepen. ATL-onderdelen die zijn gecompileerd met Visual Studio 7.1 of eerder (Visual Studio 2003) wijzen dit geheugen niet toe als uitvoerbaar. Thunk-emulatie lost dat compatibiliteitsprobleem op. Toepassingen met een binair extensiemodel (zoals Internet Explorer 11) moeten vaak ATL Thunk-emulatie hebben ingeschakeld.

## <a name="disable-extension-points"></a>Uitbreidingspunten uitschakelen

### <a name="description"></a>Beschrijving

Met deze beperking worden verschillende uitbreidingspunten voor een toepassing uitgeschakeld, die kunnen worden gebruikt om persistentie vast te stellen of om de bevoegdheden van schadelijke inhoud te verhogen.

Dit omvat:

- **AppInit-DLL's:** wanneer een proces wordt gestart, wordt de opgegeven DLL in de context van het nieuw gestarte proces geladen voordat de functie van het invoerpunt wordt gebeld. [Details over AppInit-DLL's vindt u hier.](https://docs.microsoft.com/windows/win32/winmsg/about-window-classes#application-global-classes) Als deze beperking is toegepast, worden appInit-DLL's niet geladen. Vanaf Windows 7 moeten appInit-DLL's digitaal worden ondertekend, [zoals hier wordt beschreven.](https://docs.microsoft.com/windows/win32/win7appqual/appinit-dlls-in-windows-7-and-windows-server-2008-r2) Bovendien worden vanaf Windows 8 appInit-DLL's niet geladen als SecureBoot is ingeschakeld, zoals [hier wordt beschreven.](https://docs.microsoft.com/windows/win32/dlls/secure-boot-and-appinit-dlls)
- **Oudere chatberichten:** met een inputmethodeeditor (IME) kan een gebruiker tekst typen in een taal die meer tekens heeft dan op een toetsenbord kan worden weergegeven. Derden kunnen chatberichten maken. Een schadelijke IME kan referenties of andere gevoelige informatie verkrijgen uit deze invoeropname. Sommige chatberichten, ook wel oudere chatberichten genoemd, werken alleen in Windows Desktop-apps en niet in UWP-apps. Deze beperking voorkomt ook dat deze oudere IME wordt geladen in de opgegeven Windows Desktop-app.
- **Windows Event Hooks** - Een toepassing kan de [SetWinEventHook-API](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-setwineventhook) bellen om de interesse te registreren voor een gebeurtenis die plaatsvindt. Er wordt een DLL opgegeven en deze kan in het proces worden ingespoten. Deze beperking dwingt de haak om te worden geplaatst bij het registratieproces in plaats van dat de procedure wordt uitgevoerd via een geïnjecteerde DLL.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

De meeste van deze uitbreidingspunten worden relatief zelden gebruikt, dus de compatibiliteitseffecten zijn meestal klein, met name op individueel toepassingsniveau. De enige overweging is als gebruikers oudere chatberichten van derden gebruiken die niet met de beveiligde toepassing werken.

### <a name="configuration-options"></a>Configuratieopties

Er zijn geen configuratieopties voor deze beperking.

> [!Note]
> **Uitbreidingspunten uitschakelen** heeft geen auditmodus.

## <a name="disable-win32k-system-calls"></a>Win32k-systeemoproepen uitschakelen

### <a name="description"></a>Beschrijving

Win32k.sys biedt een breed aanvalsoppervlak voor een aanvaller. Als onderdeel van de kernelmodus is het vaak bedoeld als een escape-vector voor toepassingen met een sandbox. Deze beperking voorkomt dat oproepen in win32k.sys door te blokkeren dat een thread zichzelf converteert naar een GUI-thread, die vervolgens toegang krijgt om Win32k-functies aan te roepen. Een thread is niet-GUI wanneer deze wordt gemaakt, maar wordt geconverteerd bij het eerste gesprek naar win32k.sys of via een API-oproep naar [IsGuiThread.](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-isguithread)

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Deze beperking is ontworpen voor processen die zijn toegewezen niet-gebruikersinterfaceprocessen. In veel moderne browsers wordt bijvoorbeeld procesisolatie gebruikt en worden niet-gebruikersinterfaceprocessen opgenomen. Elke toepassing die een GUI wekt met één proces, wordt beïnvloed door deze beperking.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="do-not-allow-child-processes"></a>Onderliggende processen niet toestaan

### <a name="description"></a>Beschrijving

Deze beperking voorkomt dat een toepassing nieuwe onderliggende toepassingen maakt. Een veelgebruikte techniek die door tegenstanders wordt gebruikt, is het starten van een vertrouwd proces op het apparaat met schadelijke input (een 'living off the land'-aanval), waarbij vaak een andere toepassing op het apparaat moet worden gestart. Als er geen legitieme redenen zijn waarom een toepassing een onderliggend proces zou starten, wordt deze mogelijke aanvalsvector beperkt door deze beperking. De beperking wordt toegepast door een eigenschap in te stellen op het proces-token, waardoor het maken van een token voor het onderliggende proces met het foutbericht STATUS_CHILD_PROCESS_BLOCKED.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Als uw toepassing om welke reden dan ook onderliggende toepassingen start, zoals ondersteunende hyperlinks waarmee een browser of een externe browser wordt geopend, of die andere hulpprogramma's op de computer starten, wordt deze functionaliteit verbroken wanneer deze beperking wordt toegepast.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="export-address-filtering"></a>Adresfilters exporteren

### <a name="description"></a>Beschrijving

Met EAF (Export address filtering) wordt het risico beperkt dat schadelijke code de exportadrestabel van alle geladen modules bevat om modules te vinden die nuttige API's bevatten voor hun aanval. Dit is een veelgebruikte tactiek die door shellcode wordt gebruikt. Om het risico van een dergelijke aanval te beperken, beschermt deze beperking drie veelgebruikte modules:

- ntdll.dll
- kernelbase.dll
- kernel32.dll

De beperking beschermt de geheugenpagina in de [exportadreslijst die naar de [exportadrestabel wijst](https://docs.microsoft.com/windows/win32/debug/pe-format#export-address-table). Op deze geheugenpagina wordt de [PAGE_GUARD](https://docs.microsoft.com/windows/win32/memory/creating-guard-pages) toegepast. Wanneer iemand dit geheugen probeert te openen, wordt er een STATUS_GUARD_PAGE_VIOLATION. Met de beperking wordt deze uitzondering verwerkt en als de toegangsinstructie niet wordt gevalideerd, wordt het proces beëindigd.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Deze beperking is voornamelijk een probleem voor toepassingen zoals foutopsporing, sandbox-toepassingen, toepassingen met DRM of toepassingen die anti-foutopsporingstechnologie implementeren.

### <a name="configuration-options"></a>Configuratieopties

**Toegang valideren voor modules** die vaak worden misbruikt door exploits- Met deze optie, ook wel bekend als EAF+, worden beveiligingen toegevoegd voor andere veelgebruikte modules:

- `mshtml.dll`
- `flash*.ocx`
- `jscript*.ocx`
- `vbscript.dll`
- `vgx.dll`
- `mozjs.dll`
- `xul.dll`
- `acrord32.dll`
- `acrofx32.dll`
- `acroform.api`

Door EAF+ in te stellen, wordt met deze beperking bovendien de PAGE_GUARD-beveiliging toegevoegd aan de pagina met de koptekst 'MZ', de eerste twee bytes van de [DOS-koptekst in](https://docs.microsoft.com/windows/win32/debug/pe-format#ms-dos-stub-image-only)een PE-bestand. Dit is een ander aspect van bekende geheugeninhoud waar shellcode naar kan zoeken om modules te identificeren die mogelijk interessant zijn voor geheugen.

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="force-randomization-for-images-mandatory-aslr"></a>Randomisatie forceer voor afbeeldingen (Verplichte ASLR)

### <a name="description"></a>Beschrijving

AsLR (Address Space Layout Randomization) verkleint het risico dat een aanvaller zijn kennis van de geheugenindeling van het systeem gebruikt om code uit te voeren die al aanwezig is in het procesgeheugen en die al als uitvoerbaar is gemarkeerd. Dit kan het risico van een aanvaller beperken met behulp van technieken zoals return-to-libc-aanvallen, waarbij de aanvaller de context in stelt en vervolgens het retouradres wijzigt om bestaande code uit te voeren met context die past bij het doel van de aanvaller.

Verplichte ASLR dwingt een rebase van alle DLL's in het proces. Een ontwikkelaar kan ASLR inschakelen met [de optie /DYNAMICBASE](https://docs.microsoft.com/cpp/build/reference/dynamicbase-use-address-space-layout-randomization?view=vs-2019&preserve-view=true) linker en deze beperking heeft hetzelfde effect.

Wanneer de geheugenbeheerder de afbeelding inwijdt in het proces, worden DLL's en EXE's die niet zijn geregistreerd voor ASLR, door Verplichte ASLR geconverteerd. Houd er echter rekening mee dat deze rebasing geen entropie heeft en daarom op een voorspelbare locatie in het geheugen kan worden geplaatst. Voor een rebased en gerandomiseerde locatie van binaries moet deze beperking worden gekoppeld aan [Randomize memory allocations (Bottom-up ASLR).](#randomize-memory-allocations-bottom-up-aslr)

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Deze compatibiliteitseffecten van ASLR worden meestal beperkt tot oudere toepassingen die zijn gemaakt met compilers die aannames hebben gedaan over het basisadres van een binair bestand of basisverplaatsingsgegevens hebben verwijderd. Dit kan leiden tot onvoorspelbare fouten wanneer de uitvoeringsstroom naar de verwachte locatie probeert te gaan in plaats van naar de werkelijke locatie in het geheugen.

### <a name="configuration-options"></a>Configuratieopties

**Geen gestripte afbeeldingen toestaan:** met deze optie wordt het laden van afbeeldingen die verplaatsingsgegevens hebben verwijderd, niet meer geladen. De Windows PE-bestandsindeling bevat absolute adressen en de compiler genereert ook een [base relocatietabel die de lader kan gebruiken om alle relatieve geheugenverwijzingen en de verschuiving ervan te vinden, zodat deze kunnen worden bijgewerkt als de binaire waarde niet wordt geladen op het gewenste basisadres. Sommige oudere toepassingen strippen deze informatie uit in productie-builds, waardoor deze binaries niet opnieuw kunnen worden gebaseerd. Deze beperking blokkeert dat dergelijke binaries worden geladen (in plaats van dat ze op het gewenste basisadres kunnen worden geladen).

> [!Note]
> **Arandrisatie forceer voor afbeeldingen (Verplichte ASLR)** heeft geen auditmodus.

## <a name="import-address-filtering-iaf"></a>Adresfilters importeren (IAF)

### <a name="description"></a>Beschrijving

De beperking van het filteren van importadressen (IAF) helpt het risico te beperken dat een aanvaller de besturingsstroom van een toepassing wijzigt door de importadrestabel (IAT) te wijzigen om te leiden naar willekeurige code van de keuze van de aanvaller wanneer deze functie wordt aangeroepen. Een aanvaller kan deze methode gebruiken om controle te kapen of om oproepen naar gevoelige API's te onderscheppen, te controleren en mogelijk te blokkeren.

Op de geheugenpagina's voor alle beveiligde API's wordt de [PAGE_GUARD](https://docs.microsoft.com/windows/win32/memory/creating-guard-pages) toegepast. Wanneer iemand dit geheugen probeert te openen, wordt er een STATUS_GUARD_PAGE_VIOLATION. Met de beperking wordt deze uitzondering verwerkt en als de toegangsinstructie niet wordt gevalideerd, wordt het proces beëindigd.

Deze beperking beschermt de volgende Windows API's:

- `GetProcAddress`
- `GetProcAddressForCaller`
- `LoadLibraryA`
- `LoadLibraryExA`
- `LoadLibraryW`
- `LoadLibraryExW`
- `LdrGetProcedureAddress`
- `LdrGetProcedureAddressEx`
- `LdrGetProcedureAddressForCaller`
- `LdrLoadDll`
- `VirtualProtect`
- `VirtualProtectEx`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `NtProtectVirtualMemory`
- `CreateProcessA`
- `CreateProcessW`
- `WinExec`
- `CreateProcessAsUserA`
- `CreateProcessAsUserW`
- `GetModuleHandleA`
- `GetModuleHandleW`
- `RtlDecodePointer`
- `DecodePointer`

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Legitieme toepassingen die API-onderschepping uitvoeren, kunnen door deze beperking worden gedetecteerd en sommige toepassingen kunnen vast komen te werken. Voorbeelden hiervan zijn beveiligingssoftware en toepassingscompatibiliteitssjims.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="randomize-memory-allocations-bottom-up-aslr"></a>Geheugentoewijzingen willekeurig toewijzen (bottom-up ASLR)

### <a name="description"></a>Beschrijving

Randomize memory allocations (Bottom-up ASLR) voegt entropie toe aan verplaatsingen, zodat de locatie wordt gerandomiseerd en dus minder voorspelbaar. Voor deze beperking moet verplichte ASLR van kracht worden.

De grootte van de 32-bits adresruimte plaatst praktische beperkingen aan de entropie die kan worden toegevoegd, waardoor 64-bits toepassingen het lastiger maken voor een aanvaller om een locatie in het geheugen te raden.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

De meeste toepassingen die compatibel zijn met Mandatory ASLR (rebasing) zijn ook compatibel met de andere entropie van Bottom-up ASLR. Sommige toepassingen kunnen problemen hebben met het gebruik van aanwijzers als ze lokale aanwijzers opslaan in 32-bits variabelen (verwacht een basisadres onder 4 GB) en dus niet compatibel zijn met de optie hoge entropie (die kan worden uitgeschakeld).

### <a name="configuration-options"></a>Configuratieopties

Gebruik geen hoge **entropie:** met deze optie wordt het gebruik van ASLR met hoge entropie uitgeschakeld, waardoor 24 bits entropie (1 TB variantie) worden toegevoegd aan de bottom-uptoewijzing voor 64-bits toepassingen.

> [!Note]
> **Randomize memory allocations (Bottom-up ASLR)** heeft geen auditmodus.

## <a name="simulate-execution-simexec"></a>Uitvoering simuleren (SimExec)

### <a name="description"></a>Beschrijving

Het simuleren van uitvoering (SimExec) is alleen een beperking voor 32-bits toepassingen. Hiermee wordt gevalideerd dat oproepen naar gevoelige API's terugkeren naar legitieme bellerfuncties. Dit doet het door oproepen te onderscheppen in gevoelige API's en vervolgens de uitvoering van deze API's te simuleren door door de gecodeerde instructies voor de assemblytaal te lopen op zoek naar de RET-instructie, die moet terugkeren naar de beller. Vervolgens wordt deze functie gecontroleerd en wordt naar achteren in het geheugen gekeken naar de vorige INSTRUCTIE VOOR BELLEN om te bepalen of de functie en oproepinstructie overeenkomen en of de RET niet is onderschept.

De API's die door deze beperking worden onderschept, zijn:

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

Als een ROP-gadget wordt gedetecteerd, wordt het proces beëindigd.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Toepassingen die API-onderschepping uitvoeren, met name beveiligingssoftware, kunnen compatibiliteitsproblemen met deze beperking veroorzaken.

Deze beperking is niet compatibel met de mitigatie van willekeurige codebewaking.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="validate-api-invocation-callercheck"></a>API-aanroep valideren (bellercontrole)

### <a name="description"></a>Beschrijving

Api-aanroepen valideren (CallerCheck) is een beperking voor ROP-technieken (Return-Oriented Programming) waarmee wordt gevalideerd dat gevoelige API's zijn gebeld vanuit een geldige beller. Met deze beperking wordt het doorgegeven retouradres gecontroleerd en wordt vervolgens heuristisch naar achteren gedemonteerd om een oproep boven het adres van het retouradres te vinden om te bepalen of het doel van de oproep overeenkomt met de parameter die in de functie is doorgegeven.

De API's die door deze beperking worden onderschept, zijn:

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

Als een ROP-gadget wordt gedetecteerd, wordt het proces beëindigd.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Toepassingen die API-onderschepping uitvoeren, met name beveiligingssoftware, kunnen compatibiliteitsproblemen met deze beperking veroorzaken.

Deze beperking is niet compatibel met de mitigatie van willekeurige codebewaking.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="validate-exception-chains-sehop"></a>Uitzonderingsketens (SEHOP) valideren

### <a name="description"></a>Beschrijving

Valideren van uitzonderingsketens (SEHOP) is een beperking ten opzichte van *de SEH(Structured Exception Handler) overschrijven.* [Gestructureerde uitzonderingsafhandeling](https://docs.microsoft.com/windows/win32/debug/structured-exception-handling) is het proces waarmee een toepassing kan vragen om een bepaalde uitzondering af te handelen. Uitzonderings handlers worden aan elkaar geketend, zodat als een uitzonderings handler ervoor kiest om een bepaalde uitzondering niet te verwerken, deze kan worden doorgegeven aan de volgende uitzonderings handler in de keten totdat iemand besluit om deze af te handelen. Omdat de lijst met handler dynamisch is, wordt deze opgeslagen op de stapel. Een aanvaller kan een kwetsbaarheid voor stackoverloop gebruiken om vervolgens de uitzonderings handler te overschrijven met een aanwijzer naar de code van de keuze van de aanvaller.

Deze beperking is afhankelijk van het ontwerp van SEH, waarbij elke SEH-vermelding zowel een aanwijzer naar de uitzonderings handler bevat als een aanwijzer naar de volgende handler in de uitzonderingsketen. Deze beperking wordt genoemd door de uitzonderingsverdeler, die de SEH-keten valideert wanneer een uitzondering wordt aangeroepen. Het controleert of:

- Alle ketenrecords voor uitzonderingen zijn binnen de stapelgrenzen
- Alle uitzonderingsrecords worden uitgelijnd
- Geen uitzonderingswijzers wijzen naar de stapel
- Er zijn geen achterwaartse aanwijzers
- De uitzonderingsketen eindigt op een bekende laatste uitzonderingsgreep

Als deze validaties mislukken, wordt de afhandeling van uitzonderingen afgebroken en wordt de uitzondering niet verwerkt.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Compatibiliteitsproblemen met SEHOP zijn relatief zeldzaam. Het is ongebruikelijk dat een toepassing afhankelijk is van het beschadigd maken van de uitzonderingsketen. Sommige toepassingen worden echter beïnvloed door de subtiele wijzigingen in de timing, die zich kunnen manifesteren als een rasvoorwaarde die een latente multithreading-fout in de toepassing aan het licht komt.

### <a name="configuration-options"></a>Configuratieopties

> [!Note]
> **Valideer uitzonderingsketens (SEHOP)** heeft geen auditmodus.

## <a name="validate-handle-usage"></a>Gebruik van greep valideren

### <a name="description"></a>Beschrijving

*Valideren van het gebruik van* greep is een beperking die helpt bij het beveiligen tegen een aanvaller met behulp van een bestaande greep om toegang te krijgen tot een beveiligd object. Een [greep](https://docs.microsoft.com/windows/win32/sysinfo/handles-and-objects) is een verwijzing naar een beveiligd object. Als toepassingscode verwijst naar een ongeldige greep, kan dit aangeven dat een tegenstrever een eerder opgenomen greep probeert te gebruiken (maar waarvan het aantal toepassingsverwijzingen niet op de hoogte is). Als de toepassing probeert een ongeldig object te gebruiken in plaats van alleen null te retourneren, wordt er een uitzondering gemaakt (STATUS_INVALID_HANDLE).

Deze beperking wordt automatisch toegepast op Windows Store-toepassingen.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Toepassingen die geen nauwkeurige naslagverwijzingen bijhouden en die deze bewerkingen niet in een uitzonderingsgreep hebben verwerkt, worden mogelijk beïnvloed door deze beperking.

### <a name="configuration-options"></a>Configuratieopties

> [!Note]
> **Valideren van het gebruik van** de greep heeft geen auditmodus.

## <a name="validate-heap-integrity"></a>Integriteit van de stapel valideren

### <a name="description"></a>Beschrijving

De *beperking van de integriteit* van de stapel valideren verhoogt het beschermingsniveau van risicobeperking in Windows, door ervoor te zorgen dat de toepassing wordt beëindigd als er een enorm beschadiging wordt gedetecteerd. De risico's zijn onder andere:

- Voorkomen dat een STAPELgreep wordt losgeslagen
- Een andere validatie uitvoeren op uitgebreide blokkoppen voor stapeltoewijzingen
- Controleren of stapeltoewijzingen nog niet als in gebruik zijn gemarkeerd
- Beschermpagina's toevoegen aan grote toewijzingen, stapelsegmenten en subsegmenten boven een minimumgrootte

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Deze beperking wordt al standaard toegepast voor 64-bits toepassingen en voor 32-bits toepassingen die zijn gericht op Windows Vista of hoger. Oudere toepassingen van Windows XP of eerder lopen het meeste risico, hoewel compatibiliteitsproblemen zelden voorkomen.

### <a name="configuration-options"></a>Configuratieopties

> [!Note]
> **Valideren van de integriteit van de** stapel heeft geen auditmodus.

## <a name="validate-image-dependency-integrity"></a>Afhankelijkheidsintegriteit van afbeeldingen valideren

### <a name="description"></a>Beschrijving

De *beperking van de afhankelijkheid van* afbeeldingen helpt u te beschermen tegen aanvallen die code proberen te vervangen door dlls die statisch zijn gekoppeld door Windows-binaries. De techniek voor het planten van DLL maakt misbruik van het zoekmechanisme van de lader om schadelijke code te injecteren, waarmee schadelijke code in een verhoogde context kan worden uitgevoerd. Wanneer de lader een windows ondertekend binair laadt en vervolgens alle dlls laadt waar de binaire afhankelijk van is, worden deze binaries gecontroleerd om ervoor te zorgen dat ze ook digitaal zijn ondertekend als een Windows-binair. Als de handtekeningcontrole mislukt, wordt de dll niet geladen en wordt er een uitzondering gemaakt en wordt een status van STATUS_INVALID_IMAGE_HASH.

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Compatibiliteitsproblemen zijn ongebruikelijk. Toepassingen die afhankelijk zijn van het vervangen van Windows-binaries door lokale privéversies, worden beïnvloed en er is ook een klein risico dat subtiele tijdsinstellingen worden aan het licht gebracht in toepassingen met meerdere threads.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)

## <a name="validate-stack-integrity-stackpivot"></a>StackIntegriteit valideren (StackPivot)

### <a name="description"></a>Beschrijving

De beperking van stackintegriteit *(StackPivot)* helpt u te beschermen tegen de Stack Pivot-aanval, een ROP-aanval waarbij een aanvaller een valse stapel maakt in het geheugen van de stapel en vervolgens de toepassing om terug te keren naar de nep-stack die de uitvoeringsstroom bepaalt.

Met deze beperking worden veel Windows-API's onderschept en wordt de waarde van de stapelwijzer gecontroleerd. Als het adres van de stapelwijzer niet tussen de onderkant en de bovenkant van de stapel valt, wordt een gebeurtenis opgenomen en, indien niet in de auditmodus, wordt het proces beëindigd.

De API's die door deze beperking worden onderschept, zijn:

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

### <a name="compatibility-considerations"></a>Compatibiliteitsoverwegingen

Toepassingen die nepstapels gebruiken, worden beïnvloed en er is ook een klein risico dat subtiele timing bugs worden aan het licht gebracht in toepassingen met meerdere threads.
Toepassingen die API-onderschepping uitvoeren, met name beveiligingssoftware, kunnen compatibiliteitsproblemen met deze beperking veroorzaken.

Deze beperking is niet compatibel met de mitigatie van willekeurige codebewaking.

### <a name="configuration-options"></a>Configuratieopties

**Alleen controleren:** u kunt deze beperking in de auditmodus inschakelen om de mogelijke compatibiliteitseffecten op een toepassing te meten. Auditgebeurtenissen kunnen vervolgens worden bekeken in de viewer van de gebeurtenis of met geavanceerde zoekgebeurtenissen in [Microsoft Defender voor eindpunt.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)
