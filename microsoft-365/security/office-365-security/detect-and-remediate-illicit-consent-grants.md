---
title: Goedkeuringsgelden voor toestemming voor studenten detecteren en herstellen
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
description: Meer informatie over het herkennen en herstellen van de toestemming voor de toestemming van microsoft Microsoft Office 365.
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: a1c724bb3b201e0ddf1edea4794606c7083605e8
ms.sourcegitcommit: a1846b1ee2e4fa397e39c1271c997fc4cf6d5619
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 02/09/2021
ms.locfileid: "50165437"
---
# <a name="detect-and-remediate-illicit-consent-grants"></a><span data-ttu-id="e44f9-103">Goedkeuringsgelden voor toestemming voor studenten detecteren en herstellen</span><span class="sxs-lookup"><span data-stu-id="e44f9-103">Detect and Remediate Illicit Consent Grants</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

<span data-ttu-id="e44f9-104">**Van toepassing op**</span><span class="sxs-lookup"><span data-stu-id="e44f9-104">**Applies to**</span></span>
- [<span data-ttu-id="e44f9-105">Abonnement 1 en abonnement 2 voor Microsoft Defender voor Office 365</span><span class="sxs-lookup"><span data-stu-id="e44f9-105">Microsoft Defender for Office 365 plan 1 and plan 2</span></span>](https://go.microsoft.com/fwlink/?linkid=2148715)
- [<span data-ttu-id="e44f9-106">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="e44f9-106">Microsoft 365 Defender</span></span>](https://go.microsoft.com/fwlink/?linkid=2118804)

<span data-ttu-id="e44f9-107">**Overzicht**  Meer informatie over het herkennen en herstellen van de toestemming voor de toestemming van de gebruiker in Office 365.</span><span class="sxs-lookup"><span data-stu-id="e44f9-107">**Summary**  Learn how to recognize and remediate the illicit consent grants attack in Office 365.</span></span>

## <a name="what-is-the-illicit-consent-grant-attack-in-office-365"></a><span data-ttu-id="e44f9-108">Wat is de toestemmingsverklaring voor de toestemming om te aanvallen in Office 365?</span><span class="sxs-lookup"><span data-stu-id="e44f9-108">What is the illicit consent grant attack in Office 365?</span></span>

<span data-ttu-id="e44f9-109">Bij een aanval van toestemming via een toestemmingsverklaring maakt de aanvaller een in Azure geregistreerde toepassing waarin toegang wordt gevraagd tot gegevens, zoals contactgegevens, e-mail of documenten.</span><span class="sxs-lookup"><span data-stu-id="e44f9-109">In an illicit consent grant attack, the attacker creates an Azure-registered application that requests access to data such as contact information, email, or documents.</span></span> <span data-ttu-id="e44f9-110">De aanvaller trucs vervolgens een eindgebruiker om die toepassing toestemming te verlenen voor toegang tot zijn gegevens via een phishing-aanval of door code in te voeren op een vertrouwde website.</span><span class="sxs-lookup"><span data-stu-id="e44f9-110">The attacker then tricks an end user into granting that application consent to access their data either through a phishing attack, or by injecting illicit code into a trusted website.</span></span> <span data-ttu-id="e44f9-111">Nadat aan de aanvraag toestemming is verleend, heeft deze toegang op accountniveau tot gegevens zonder dat een organisatieaccount nodig is.</span><span class="sxs-lookup"><span data-stu-id="e44f9-111">After the illicit application has been granted consent, it has account-level access to data without the need for an organizational account.</span></span> <span data-ttu-id="e44f9-112">Normale herstelstappen, zoals het opnieuw instellen van wachtwoorden voor niet-geschonden accounts of het vereisen van Multi-Factor Authentication (MFA) voor accounts, zijn niet effectief tegen dit type aanval, omdat dit toepassingen van derden zijn en van buiten de organisatie zijn.</span><span class="sxs-lookup"><span data-stu-id="e44f9-112">Normal remediation steps, like resetting passwords for breached accounts or requiring Multi-Factor Authentication (MFA) on accounts, are not effective against this type of attack, since these are third-party applications and are external to the organization.</span></span>

<span data-ttu-id="e44f9-113">Deze aanvallen maken gebruik van een interactiemodel dat ervan uit gaat dat de entiteit die de informatie aanroept, automatisering is en geen mens.</span><span class="sxs-lookup"><span data-stu-id="e44f9-113">These attacks leverage an interaction model which presumes the entity that is calling the information is automation and not a human.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e44f9-114">Vermoedt u dat u momenteel problemen ondervindt met het verlenen van toestemming via een app?</span><span class="sxs-lookup"><span data-stu-id="e44f9-114">Do you suspect you're experiencing problems with illicit consent-grants from an app, right now?</span></span> <span data-ttu-id="e44f9-115">Microsoft Cloud App Security (MCAS) beschikt over hulpprogramma's voor het detecteren, onderzoeken en herstellen van uw OAuth-apps.</span><span class="sxs-lookup"><span data-stu-id="e44f9-115">Microsoft Cloud App Security (MCAS) has tools to detect, investigate, and remediate your OAuth apps.</span></span> <span data-ttu-id="e44f9-116">Dit MCAS-artikel bevat een zelfstudie over het onderzoeken van risicovolle [OAuth-apps.](https://docs.microsoft.com/cloud-app-security/investigate-risky-oauth)</span><span class="sxs-lookup"><span data-stu-id="e44f9-116">This MCAS article has a tutorial that outlines how to go about [investigating risky OAuth apps](https://docs.microsoft.com/cloud-app-security/investigate-risky-oauth).</span></span> <span data-ttu-id="e44f9-117">U kunt ook [OAuth-appbeleid](https://docs.microsoft.com/cloud-app-security/app-permission-policy) instellen om door de app aangevraagde machtigingen te onderzoeken, welke gebruikers deze apps mogen beheren, en deze machtigingsaanvragen op grote schaal goed te keuren of te verbieden.</span><span class="sxs-lookup"><span data-stu-id="e44f9-117">You can also set [OAuth app policies](https://docs.microsoft.com/cloud-app-security/app-permission-policy) to investigate app-requested permissions, which users are authorizing these apps, and widely approve or ban these permissions requests.</span></span>

## <a name="what-does-an-illicit-consent-grant-attack-look-like-in-office-365"></a><span data-ttu-id="e44f9-118">Hoe ziet een aanval van toestemming voor toestemming er in Office 365 uit?</span><span class="sxs-lookup"><span data-stu-id="e44f9-118">What does an illicit consent grant attack look like in Office 365?</span></span>

<span data-ttu-id="e44f9-119">U moet het **auditlogboek** doorzoeken om borden te vinden, ook wel Indicators of Compromise (IOC) van deze aanval genoemd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-119">You need to search the **audit log** to find signs, also called Indicators of Compromise (IOC) of this attack.</span></span> <span data-ttu-id="e44f9-120">Voor organisaties met veel in Azure geregistreerde toepassingen en een groot aantal gebruikers is de beste manier om de toestemmingsaanvragen van uw organisatie wekelijks te bekijken.</span><span class="sxs-lookup"><span data-stu-id="e44f9-120">For organizations with many Azure-registered applications and a large user base, the best practice is to review your organizations consent grants on a weekly basis.</span></span>

### <a name="steps-for-finding-signs-of-this-attack"></a><span data-ttu-id="e44f9-121">Stappen voor het vinden van tekenen van deze aanval</span><span class="sxs-lookup"><span data-stu-id="e44f9-121">Steps for finding signs of this attack</span></span>

1. <span data-ttu-id="e44f9-122">Open het **& compliancecentrum** <https://protection.office.com> op.</span><span class="sxs-lookup"><span data-stu-id="e44f9-122">Open the **Security & Compliance Center** at <https://protection.office.com>.</span></span>

2. <span data-ttu-id="e44f9-123">Navigeer **naar Zoeken** en selecteer **Zoeken in auditlogboek.**</span><span class="sxs-lookup"><span data-stu-id="e44f9-123">Navigate to **Search** and select **Audit log search**.</span></span>

3. <span data-ttu-id="e44f9-124">Zoek (alle activiteiten en alle gebruikers) en voer indien nodig de begin- en einddatum in en klik op **Zoeken.**</span><span class="sxs-lookup"><span data-stu-id="e44f9-124">Search (all activities and all users) and enter the start date and end date if required and then click **Search**.</span></span>

4. <span data-ttu-id="e44f9-125">Klik **op Resultaten filteren** en geef Toestemming voor de toepassing op in het **veld** Activiteit.</span><span class="sxs-lookup"><span data-stu-id="e44f9-125">Click **Filter results** and enter Consent to application in the **Activity** field.</span></span>

5. <span data-ttu-id="e44f9-126">Klik op het resultaat om de details van de activiteit te bekijken.</span><span class="sxs-lookup"><span data-stu-id="e44f9-126">Click on the result to see the details of the activity.</span></span> <span data-ttu-id="e44f9-127">Klik **op Meer informatie** voor meer informatie over de activiteit.</span><span class="sxs-lookup"><span data-stu-id="e44f9-127">Click **More Information** to get details of the activity.</span></span> <span data-ttu-id="e44f9-128">Controleer of IsAdminContent is ingesteld op Waar.</span><span class="sxs-lookup"><span data-stu-id="e44f9-128">Check to see if IsAdminContent is set to True.</span></span>

> [!NOTE]
>
> <span data-ttu-id="e44f9-129">Het kan 30 minuten tot 24 uur duren voordat de bijbehorende auditlogboekinvoer in de zoekresultaten wordt weergegeven nadat een gebeurtenis is uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-129">It can take from 30 minutes up to 24 hours for the corresponding audit log entry to be displayed in the search results after an event occurs.</span></span>
>
> <span data-ttu-id="e44f9-130">Hoe lang een auditrecord wordt bewaard en doorzoekbaar is in het auditlogboek, is afhankelijk van uw Microsoft 365-abonnement, en met name van het type licentie dat is toegewezen aan een specifieke gebruiker.</span><span class="sxs-lookup"><span data-stu-id="e44f9-130">The length of time that an audit record is retained and searchable in the audit log depends on your Microsoft 365 subscription, and specifically the type of the license that is assigned to a specific user.</span></span> <span data-ttu-id="e44f9-131">Zie Auditlogboek voor [meer informatie.](../../compliance/search-the-audit-log-in-security-and-compliance.md)</span><span class="sxs-lookup"><span data-stu-id="e44f9-131">For more information, see [Audit log](../../compliance/search-the-audit-log-in-security-and-compliance.md).</span></span>
>
> <span data-ttu-id="e44f9-132">Als deze waarde waar is, betekent dit dat iemand met globale beheerderstoegang algemene toegang tot gegevens heeft verleend.</span><span class="sxs-lookup"><span data-stu-id="e44f9-132">If this value is true, it indicates that someone with Global Administrator access may have granted broad access to data.</span></span> <span data-ttu-id="e44f9-133">Als dit onverwacht is, kunt u stappen ondernemen om [een aanval te bevestigen.](#how-to-confirm-an-attack)</span><span class="sxs-lookup"><span data-stu-id="e44f9-133">If this is unexpected, take steps to [confirm an attack](#how-to-confirm-an-attack).</span></span>

## <a name="how-to-confirm-an-attack"></a><span data-ttu-id="e44f9-134">Een aanval bevestigen</span><span class="sxs-lookup"><span data-stu-id="e44f9-134">How to confirm an attack</span></span>

<span data-ttu-id="e44f9-135">Als u een of meer exemplaren van de bovenstaande IOCs hebt, moet u nader onderzoek doen om te bevestigen dat de aanval heeft plaatsgevonden.</span><span class="sxs-lookup"><span data-stu-id="e44f9-135">If you have one or more instances of the IOCs listed above, you need to do further investigation to positively confirm that the attack occurred.</span></span> <span data-ttu-id="e44f9-136">U kunt een van deze drie methoden gebruiken om de aanval te bevestigen:</span><span class="sxs-lookup"><span data-stu-id="e44f9-136">You can use any of these three methods to confirm the attack:</span></span>

- <span data-ttu-id="e44f9-137">Inventaris van toepassingen en hun machtigingen met behulp van de Azure Active Directory-portal.</span><span class="sxs-lookup"><span data-stu-id="e44f9-137">Inventory applications and their permissions using the Azure Active Directory portal.</span></span> <span data-ttu-id="e44f9-138">Deze methode is grondig, maar u kunt slechts één gebruiker tegelijk controleren en dit kan erg tijdrovend zijn als er veel gebruikers zijn die u moet controleren.</span><span class="sxs-lookup"><span data-stu-id="e44f9-138">This method is thorough, but you can only check one user at a time which can be very time consuming if you have many users to check.</span></span>

- <span data-ttu-id="e44f9-139">Inventaristoepassingen en hun machtigingen met behulp van PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e44f9-139">Inventory applications and their permissions using PowerShell.</span></span> <span data-ttu-id="e44f9-140">Dit is de snelste en meest grondige methode, met de minste overhead.</span><span class="sxs-lookup"><span data-stu-id="e44f9-140">This is the fastest and most thorough method, with the least amount of overhead.</span></span>

- <span data-ttu-id="e44f9-141">Laat uw gebruikers hun apps en machtigingen afzonderlijk controleren en de resultaten rapporteren aan de beheerders voor herstel.</span><span class="sxs-lookup"><span data-stu-id="e44f9-141">Have your users individually check their apps and permissions and report the results back to the administrators for remediation.</span></span>

## <a name="inventory-apps-with-access-in-your-organization"></a><span data-ttu-id="e44f9-142">Inventaris-apps met toegang in uw organisatie</span><span class="sxs-lookup"><span data-stu-id="e44f9-142">Inventory apps with access in your organization</span></span>

<span data-ttu-id="e44f9-143">U kunt dit doen voor uw gebruikers met de Azure Active Directory-portal of PowerShell, of uw gebruikers afzonderlijk hun toepassingstoegang laten opspoort.</span><span class="sxs-lookup"><span data-stu-id="e44f9-143">You can do this for your users with either the Azure Active Directory Portal, or PowerShell or have your users individually enumerate their application access.</span></span>

### <a name="steps-for-using-the-azure-active-directory-portal"></a><span data-ttu-id="e44f9-144">Stappen voor het gebruik van de Azure Active Directory Portal</span><span class="sxs-lookup"><span data-stu-id="e44f9-144">Steps for using the Azure Active Directory Portal</span></span>

<span data-ttu-id="e44f9-145">U kunt de toepassingen waarvoor elke individuele gebruiker machtigingen heeft verleend op zoeken met behulp van de [Azure Active Directory Portal.](https://portal.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="e44f9-145">You can look up the applications to which any individual user has granted permissions by using the [Azure Active Directory Portal](https://portal.azure.com/).</span></span>

1. <span data-ttu-id="e44f9-146">Meld u aan bij de Azure Portal met beheerdersrechten.</span><span class="sxs-lookup"><span data-stu-id="e44f9-146">Sign in to the Azure Portal with administrative rights.</span></span>

2. <span data-ttu-id="e44f9-147">Selecteer de Azure Active Directory-blade.</span><span class="sxs-lookup"><span data-stu-id="e44f9-147">Select the Azure Active Directory blade.</span></span>

3. <span data-ttu-id="e44f9-148">Selecteer **Gebruikers**.</span><span class="sxs-lookup"><span data-stu-id="e44f9-148">Select **Users**.</span></span>

4. <span data-ttu-id="e44f9-149">Selecteer de gebruiker die u wilt controleren.</span><span class="sxs-lookup"><span data-stu-id="e44f9-149">Select the user that you want to review.</span></span>

5. <span data-ttu-id="e44f9-150">Selecteer **Toepassingen.**</span><span class="sxs-lookup"><span data-stu-id="e44f9-150">Select **Applications**.</span></span>

<span data-ttu-id="e44f9-151">Hier ziet u de apps die aan de gebruiker zijn toegewezen en welke machtigingen de toepassingen hebben.</span><span class="sxs-lookup"><span data-stu-id="e44f9-151">This will show you the apps that are assigned to the user and what permissions the applications have.</span></span>

### <a name="steps-for-having-your-users-enumerate-their-application-access"></a><span data-ttu-id="e44f9-152">Stappen voor het opsnoemen van de toepassingstoegang door uw gebruikers</span><span class="sxs-lookup"><span data-stu-id="e44f9-152">Steps for having your users enumerate their application access</span></span>

<span data-ttu-id="e44f9-153">Uw gebruikers daar hun https://myapps.microsoft.com eigen toepassingstoegang laten bekijken.</span><span class="sxs-lookup"><span data-stu-id="e44f9-153">Have your users go to https://myapps.microsoft.com and review their own application access there.</span></span> <span data-ttu-id="e44f9-154">Ze moeten alle apps met toegang kunnen zien, details over de apps kunnen bekijken (inclusief de omvang van de toegang) en de bevoegdheden voor verdachte apps of apps kunnen intrekken.</span><span class="sxs-lookup"><span data-stu-id="e44f9-154">They should be able to see all the apps with access, view details about them (including the scope of access), and be able to revoke privileges to suspicious or illicit apps.</span></span>

### <a name="steps-for-doing-this-with-powershell"></a><span data-ttu-id="e44f9-155">Stappen hiervoor met PowerShell</span><span class="sxs-lookup"><span data-stu-id="e44f9-155">Steps for doing this with PowerShell</span></span>

<span data-ttu-id="e44f9-156">De eenvoudigste manier om de aanval van toestemming voor de toestemming voor de volgens de toestemming van de gebruiker te verifiëren, is [ doorGet-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09)uit te voeren, waarmee alle OAuth-toestemmingsgelden en OAuth-apps voor alle gebruikers in uw tenancy in één CSV-bestand worden opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-156">The simplest way to verify the Illicit Consent Grant attack is to run [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09), which will dump all the OAuth consent grants and OAuth apps for all users in your tenancy into one .csv file.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="e44f9-157">Vereisten</span><span class="sxs-lookup"><span data-stu-id="e44f9-157">Pre-requisites</span></span>

- <span data-ttu-id="e44f9-158">De Azure AD PowerShell-bibliotheek is geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-158">The Azure AD PowerShell library installed.</span></span>

- <span data-ttu-id="e44f9-159">Globale beheerdersrechten voor de tenant op basis waar het script op wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-159">Global administrator rights on the tenant that the script will be run against.</span></span>

- <span data-ttu-id="e44f9-160">Lokale beheerder op de computer van waaruit de scripts worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-160">Local Administrator on the computer from which will run the scripts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e44f9-161">U ***wordt ten zeerste*** aangeraden meervoudige verificatie voor uw beheeraccount te vereisen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-161">We ***highly recommend*** that you require multi-factor authentication on your administrative account.</span></span> <span data-ttu-id="e44f9-162">Dit script ondersteunt MFA-verificatie.</span><span class="sxs-lookup"><span data-stu-id="e44f9-162">This script supports MFA authentication.</span></span>

1. <span data-ttu-id="e44f9-163">Meld u aan bij de computer vanaf waaruit u het script wilt uitvoeren met lokale beheerdersrechten.</span><span class="sxs-lookup"><span data-stu-id="e44f9-163">Sign in to the computer that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="e44f9-164">Download of kopieer het [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) script van GitHub naar een map waarin u het script gaat uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="e44f9-164">Download or copy the [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) script from GitHub to a folder from which you will run the script.</span></span> <span data-ttu-id="e44f9-165">Dit is de map waarin het uitvoerbestand 'permissions.csv' wordt geschreven.</span><span class="sxs-lookup"><span data-stu-id="e44f9-165">This will be the same folder to which the output "permissions.csv" file will be written.</span></span>

3. <span data-ttu-id="e44f9-166">Open een PowerShell-exemplaar als beheerder en open het in de map waarin u het script hebt opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-166">Open a PowerShell instance as an administrator and open to the folder you saved the script to.</span></span>

4. <span data-ttu-id="e44f9-167">Maak verbinding met uw adreslijst met behulp [van de cmdlet Connect-AzureAD.](https://docs.microsoft.com/powershell/module/azuread/connect-azuread)</span><span class="sxs-lookup"><span data-stu-id="e44f9-167">Connect to your directory using the [Connect-AzureAD](https://docs.microsoft.com/powershell/module/azuread/connect-azuread) cmdlet.</span></span>

5. <span data-ttu-id="e44f9-168">Voer deze PowerShell-opdracht uit:</span><span class="sxs-lookup"><span data-stu-id="e44f9-168">Run this PowerShell command:</span></span>

   ```powershell
   Get-AzureADPSPermissions.ps1 | Export-csv -Path "Permissions.csv" -NoTypeInformation
   ```

<span data-ttu-id="e44f9-169">Het script produceert één bestand met de naam Permissions.csv.</span><span class="sxs-lookup"><span data-stu-id="e44f9-169">The script produces one file named Permissions.csv.</span></span> <span data-ttu-id="e44f9-170">Volg deze stappen om te zoeken naar aanvraagmachtigingen voor studenten:</span><span class="sxs-lookup"><span data-stu-id="e44f9-170">Follow these steps to look for illicit application permission grants:</span></span>

1. <span data-ttu-id="e44f9-171">Zoek in de kolom ConsentType (kolom G) naar de waarde 'AllPrinciples'.</span><span class="sxs-lookup"><span data-stu-id="e44f9-171">In the ConsentType column (column G) search for the value "AllPrinciples".</span></span> <span data-ttu-id="e44f9-172">Met de machtiging AllPrincipals heeft de clienttoepassing toegang tot ieders inhoud in de tenancy.</span><span class="sxs-lookup"><span data-stu-id="e44f9-172">The AllPrincipals permission allows the client application to access everyone's content in the tenancy.</span></span> <span data-ttu-id="e44f9-173">Ineigen Microsoft 365-toepassingen hebben deze machtiging nodig om correct te werken.</span><span class="sxs-lookup"><span data-stu-id="e44f9-173">Native Microsoft 365 applications need this permission to work correctly.</span></span> <span data-ttu-id="e44f9-174">Elke niet-Microsoft-toepassing met deze machtiging moet zorgvuldig worden gecontroleerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-174">Every non-Microsoft application with this permission should be reviewed carefully.</span></span>

2. <span data-ttu-id="e44f9-175">Controleer in de kolom Machtigingen (kolom F) de machtigingen die elke gedelegeerde toepassing heeft voor de inhoud.</span><span class="sxs-lookup"><span data-stu-id="e44f9-175">In the Permission column (column F) review the permissions that each delegated application has to content.</span></span> <span data-ttu-id="e44f9-176">Zoek naar de machtiging Lezen en Schrijven of '\*. Alle machtigingen en controleer deze zorgvuldig omdat ze mogelijk niet geschikt zijn.</span><span class="sxs-lookup"><span data-stu-id="e44f9-176">Look for "Read" and "Write" permission or "\*.All" permission, and review these carefully because they may not be appropriate.</span></span>

3. <span data-ttu-id="e44f9-177">Bekijk de specifieke gebruikers die toestemming hebben verleend.</span><span class="sxs-lookup"><span data-stu-id="e44f9-177">Review the specific users that have consents granted.</span></span> <span data-ttu-id="e44f9-178">Als aan gebruikers met een hoge profiel- of hoge impact ongepaste toestemming is verleend, moet u nader onderzoek doen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-178">If high profile or high impact users have inappropriate consents granted, you should investigate further.</span></span>

4. <span data-ttu-id="e44f9-179">Zoek in de kolom ClientDisplayName (kolom C) naar apps die verdacht lijken.</span><span class="sxs-lookup"><span data-stu-id="e44f9-179">In the ClientDisplayName column (column C) look for apps that seem suspicious.</span></span> <span data-ttu-id="e44f9-180">Apps met onjuist gespelde namen, superlandnamen of hackergeluidsnamen moeten zorgvuldig worden beoordeeld.</span><span class="sxs-lookup"><span data-stu-id="e44f9-180">Apps with misspelled names, super bland names, or hacker-sounding names should be reviewed carefully.</span></span>

## <a name="determine-the-scope-of-the-attack"></a><span data-ttu-id="e44f9-181">De omvang van de aanval bepalen</span><span class="sxs-lookup"><span data-stu-id="e44f9-181">Determine the scope of the attack</span></span>

<span data-ttu-id="e44f9-182">Nadat u klaar bent met het inventariseren van de toepassingstoegang, bekijkt u het **auditlogboek** om het volledige bereik van de inbreuk te bepalen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-182">After you have finished inventorying application access, review the **audit log** to determine the full scope of the breach.</span></span> <span data-ttu-id="e44f9-183">Zoek op de betrokken gebruikers, de tijdframes die de toepassing toegang heeft tot uw organisatie en de machtigingen die de app had.</span><span class="sxs-lookup"><span data-stu-id="e44f9-183">Search on the affected users, the time frames that the illicit application had access to your organization, and the permissions the app had.</span></span> <span data-ttu-id="e44f9-184">U kunt het **auditlogboek doorzoeken** in het [Microsoft 365-beveiligings- en compliancecentrum.](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance)</span><span class="sxs-lookup"><span data-stu-id="e44f9-184">You can search the **audit log** in the [Microsoft 365 Security and Compliance Center](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e44f9-185">[Voor het](https://docs.microsoft.com/microsoft-365/compliance/enable-mailbox-auditing) [](https://docs.microsoft.com/microsoft-365/compliance/turn-audit-log-search-on-or-off) verkrijgen van deze informatie moet postvakcontrole en activiteitencontrole voor beheerders en gebruikers zijn ingeschakeld vóór de aanval.</span><span class="sxs-lookup"><span data-stu-id="e44f9-185">[Mailbox auditing](https://docs.microsoft.com/microsoft-365/compliance/enable-mailbox-auditing) and [Activity auditing for admins and users](https://docs.microsoft.com/microsoft-365/compliance/turn-audit-log-search-on-or-off) must have been enabled prior to the attack for you to get this information.</span></span>

## <a name="how-to-stop-and-remediate-an-illicit-consent-grant-attack"></a><span data-ttu-id="e44f9-186">Een aanval van toestemming voor een toestemmingsverklaring stoppen en herstellen</span><span class="sxs-lookup"><span data-stu-id="e44f9-186">How to stop and remediate an illicit consent grant attack</span></span>

<span data-ttu-id="e44f9-187">Nadat u een toepassing met machtigingen voor uitvoering hebt geïdentificeerd, kunt u deze toegang op verschillende manieren verwijderen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-187">After you have identified an application with illicit permissions, you have several ways to remove that access.</span></span>

- <span data-ttu-id="e44f9-188">U kunt de machtigingen van de toepassing intrekken in de Azure Active Directory Portal door:</span><span class="sxs-lookup"><span data-stu-id="e44f9-188">You can revoke the application's permission in the Azure Active Directory Portal by:</span></span>

  - <span data-ttu-id="e44f9-189">Navigeer naar de betreffende gebruiker in **het Azure Active Directory User** blade.</span><span class="sxs-lookup"><span data-stu-id="e44f9-189">Navigate to the affected user in the **Azure Active Directory User** blade.</span></span>

  - <span data-ttu-id="e44f9-190">Selecteer **Toepassingen.**</span><span class="sxs-lookup"><span data-stu-id="e44f9-190">Select **Applications**.</span></span>

  - <span data-ttu-id="e44f9-191">Selecteer de toepassing.</span><span class="sxs-lookup"><span data-stu-id="e44f9-191">Select the illicit application.</span></span>

  - <span data-ttu-id="e44f9-192">Klik **op Verwijderen** in het uitzoomen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-192">Click **Remove** in the drill down.</span></span>

- <span data-ttu-id="e44f9-193">U kunt de toestemmingsverlening voor OAuth met PowerShell intrekken door de stappen in [Remove-AzureADOAuth2Permission Wordt ingetrokken.](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADOAuth2PermissionGrant)</span><span class="sxs-lookup"><span data-stu-id="e44f9-193">You can revoke the OAuth consent grant with PowerShell by following the steps in [Remove-AzureADOAuth2PermissionGrant](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADOAuth2PermissionGrant).</span></span>

- <span data-ttu-id="e44f9-194">U kunt de toewijzing van de rol van de service-app met PowerShell intrekken door de stappen in [Remove-AzureADServiceAppRoleAssignment te volgen.](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADServiceAppRoleAssignment)</span><span class="sxs-lookup"><span data-stu-id="e44f9-194">You can revoke the Service App Role Assignment with PowerShell by following the steps in [Remove-AzureADServiceAppRoleAssignment](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADServiceAppRoleAssignment).</span></span>

- <span data-ttu-id="e44f9-195">U kunt het aanmelden voor het betreffende account ook helemaal uitschakelen, zodat de app geen toegang meer heeft tot gegevens in dat account.</span><span class="sxs-lookup"><span data-stu-id="e44f9-195">You can also disable sign-in for the affected account altogether, which will in turn disable app access to data in that account.</span></span> <span data-ttu-id="e44f9-196">Dit is natuurlijk niet ideaal voor de productiviteit van de eindgebruiker, maar als u het effect snel wilt beperken, kan dit een bruikbare herstel op korte termijn zijn.</span><span class="sxs-lookup"><span data-stu-id="e44f9-196">This isn't ideal for the end user's productivity, of course, but if you are working to limit impact quickly, it can be a viable short-term remediation.</span></span>

- <span data-ttu-id="e44f9-197">U kunt geïntegreerde toepassingen uitschakelen voor uw tenancy.</span><span class="sxs-lookup"><span data-stu-id="e44f9-197">You can turn integrated applications off for your tenancy.</span></span> <span data-ttu-id="e44f9-198">Deze stap is drastisch en betekent dat eindgebruikers niet meer in staat zijn toestemming te verlenen op tenantbasis.</span><span class="sxs-lookup"><span data-stu-id="e44f9-198">This is a drastic step that disables the ability for end users to grant consent on a tenant-wide basis.</span></span> <span data-ttu-id="e44f9-199">Hiermee voorkomt u dat uw gebruikers per ongeluk toegang verlenen tot een schadelijke toepassing.</span><span class="sxs-lookup"><span data-stu-id="e44f9-199">This prevents your users from inadvertently granting access to a malicious application.</span></span> <span data-ttu-id="e44f9-200">Dit wordt niet sterk aanbevolen, omdat hierdoor de mogelijkheid voor gebruikers om te werken met toepassingen van derden ernstig wordt beperkt.</span><span class="sxs-lookup"><span data-stu-id="e44f9-200">This isn't strongly recommended as it severely impairs your users' ability to be productive with third party applications.</span></span> <span data-ttu-id="e44f9-201">U kunt dit doen door de stappen te volgen voor het in- of uitschakelen [van geïntegreerde apps.](https://docs.microsoft.com/microsoft-365/admin/misc/integrated-apps)</span><span class="sxs-lookup"><span data-stu-id="e44f9-201">You can do this by following the steps in [Turning Integrated Apps on or off](https://docs.microsoft.com/microsoft-365/admin/misc/integrated-apps).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="e44f9-202">Microsoft 365 beveiligen als een cybersecurity pro</span><span class="sxs-lookup"><span data-stu-id="e44f9-202">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="e44f9-203">Uw Microsoft 365-abonnement heeft een krachtige reeks aan beveiligingsmogelijkheden die u kunt gebruiken om uw gegevens en gebruikers te beschermen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-203">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="e44f9-204">Gebruik de [Microsoft 365-roadmap voor beveiliging - Topprioriteiten voor de eerste 30 dagen, 90 dagen en verder](security-roadmap.md) om door Microsoft aanbevolen procedures voor het beveiligen van uw Microsoft 365-tenant te implementeren.</span><span class="sxs-lookup"><span data-stu-id="e44f9-204">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="e44f9-205">Taken die in de eerste 30 dagen moeten worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-205">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="e44f9-206">Deze hebben direct effect en weinig invloed op uw gebruikers.</span><span class="sxs-lookup"><span data-stu-id="e44f9-206">These have immediate affect and are low-impact to your users.</span></span>

- <span data-ttu-id="e44f9-207">Taken die binnen 90 dagen moeten worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e44f9-207">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="e44f9-208">Deze nemen qua planning en implementatie iets meer tijd in beslag, maar zorgen voor aanzienlijke verbeteringen in uw beveiligingspostuur.</span><span class="sxs-lookup"><span data-stu-id="e44f9-208">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="e44f9-209">Na 90 dagen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-209">Beyond 90 days.</span></span> <span data-ttu-id="e44f9-210">Deze verbeteringen zijn gebaseerd op de eerste 90 dagen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-210">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="e44f9-211">Zie ook:</span><span class="sxs-lookup"><span data-stu-id="e44f9-211">See also:</span></span>

- <span data-ttu-id="e44f9-212">[Met een onverwachte toepassing in mijn lijst](https://docs.microsoft.com/azure/active-directory/application-access-unexpected-application) met toepassingen worden beheerders door de diverse acties leiden die ze kunnen uitvoeren nadat ze zich realiseren dat er onverwachte toepassingen zijn met toegang tot gegevens.</span><span class="sxs-lookup"><span data-stu-id="e44f9-212">[Unexpected application in my applications list](https://docs.microsoft.com/azure/active-directory/application-access-unexpected-application) walks administrators through various actions they may want to take after realizing there are unexpected applications with access to data.</span></span>

- <span data-ttu-id="e44f9-213">[Het integreren van toepassingen met Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-apps-permissions-consent) is een uitgebreid overzicht van toestemming en machtigingen.</span><span class="sxs-lookup"><span data-stu-id="e44f9-213">[Integrating applications with Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-apps-permissions-consent) is a high-level overview of consent and permissions.</span></span>

- <span data-ttu-id="e44f9-214">[Problemen bij het ontwikkelen van mijn toepassing](https://docs.microsoft.com/azure/active-directory/active-directory-application-dev-development-content-map) bieden koppelingen naar verschillende artikelen met betrekking tot toestemming.</span><span class="sxs-lookup"><span data-stu-id="e44f9-214">[Problems developing my application](https://docs.microsoft.com/azure/active-directory/active-directory-application-dev-development-content-map) provides links to various consent related articles.</span></span>

- <span data-ttu-id="e44f9-215">[Toepassings- en service-principalobjecten in Azure Active Directory (Azure AD)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-application-objects) bieden een overzicht van de Application and Service principal-objecten die belangrijk zijn voor het toepassingsmodel.</span><span class="sxs-lookup"><span data-stu-id="e44f9-215">[Application and service principal objects in Azure Active Directory (Azure AD)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-application-objects) provides an overview of the Application and Service principal objects that are core to the application model.</span></span>

- <span data-ttu-id="e44f9-216">[Toegang tot apps](https://docs.microsoft.com/azure/active-directory/active-directory-managing-access-to-apps) beheren is een overzicht van de mogelijkheden die beheerders hebben om de gebruikerstoegang tot apps te beheren.</span><span class="sxs-lookup"><span data-stu-id="e44f9-216">[Manage access to apps](https://docs.microsoft.com/azure/active-directory/active-directory-managing-access-to-apps) is an overview of the capabilities that administrators have to manage user access to apps.</span></span>
