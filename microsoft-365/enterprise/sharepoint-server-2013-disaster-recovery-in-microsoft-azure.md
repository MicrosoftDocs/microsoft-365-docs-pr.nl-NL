---
title: Calamiteitenherstel SharePoint Server 2013 in Microsoft Azure
ms.author: bcarter
author: brendacarter
manager: laurawi
ms.date: 04/17/2018
audience: ITPro
ms.topic: article
ms.service: o365-solutions
localization_priority: Normal
search.appverid:
- MET150
ms.collection: Ent_O365
f1.keywords:
- CSH
ms.custom:
- Ent_Deployment
- seo-marvel-apr2020
ms.assetid: e9d14cb2-ff28-4a18-a444-cebf891880ea
description: In dit artikel wordt beschreven hoe u Azure gebruikt om een omgeving voor herstel na noodherstel te maken voor uw on-premises SharePoint-farm.
ms.openlocfilehash: 01a49cfa19711caa36190a795792635431dd7d04
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 03/19/2021
ms.locfileid: "50907430"
---
# <a name="sharepoint-server-2013-disaster-recovery-in-microsoft-azure"></a><span data-ttu-id="b110a-103">Calamiteitenherstel SharePoint Server 2013 in Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="b110a-103">SharePoint Server 2013 Disaster Recovery in Microsoft Azure</span></span>

 <span data-ttu-id="b110a-104">Met Azure kunt u een omgeving voor herstel na noodherstel maken voor uw on-premises SharePoint-farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-104">Using Azure, you can create a disaster-recovery environment for your on-premises SharePoint farm.</span></span> <span data-ttu-id="b110a-105">In dit artikel wordt beschreven hoe u deze oplossing ontwerpt en implementeert.</span><span class="sxs-lookup"><span data-stu-id="b110a-105">This article describes how to design and implement this solution.</span></span>

 <span data-ttu-id="b110a-106">**Bekijk de overzichtsvideo over herstel van SharePoint Server 2013**</span><span class="sxs-lookup"><span data-stu-id="b110a-106">**Watch the SharePoint Server 2013 disaster recovery overview video**</span></span>
> [!VIDEO https://www.microsoft.com/videoplayer/embed/1b73ec8f-29bd-44eb-aa3a-f7932784bfd9?autoplay=false]
  
 <span data-ttu-id="b110a-107">Wanneer er een ramp is in uw on-premises SharePoint-omgeving, hebt u de hoogste prioriteit om het systeem snel weer aan de slag te laten gaan.</span><span class="sxs-lookup"><span data-stu-id="b110a-107">When disaster strikes your SharePoint on-premises environment, your top priority is to get the system running again quickly.</span></span> <span data-ttu-id="b110a-108">Herstel na noodherstel met SharePoint gaat sneller en eenvoudiger wanneer er al een back-upomgeving wordt uitgevoerd in Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-108">Disaster recovery with SharePoint is quicker and easier when you have a backup environment already running in Microsoft Azure.</span></span> <span data-ttu-id="b110a-109">In deze video worden de belangrijkste concepten van een Warme Failover-omgeving van SharePoint beschreven en worden alle details in dit artikel beschreven.</span><span class="sxs-lookup"><span data-stu-id="b110a-109">This video explains the main concepts of a SharePoint warm failover environment and complements the full details available in this article.</span></span>
  
<span data-ttu-id="b110a-110">Gebruik dit artikel met het volgende oplossingsmodel: **SharePoint Disaster Recovery in Microsoft Azure**.</span><span class="sxs-lookup"><span data-stu-id="b110a-110">Use this article with the following solution model: **SharePoint Disaster Recovery in Microsoft Azure**.</span></span>
  
<span data-ttu-id="b110a-111">[![SharePoint-rampherstelproces naar Azure](../media/SP-DR-Azure.png)](https://go.microsoft.com/fwlink/p/?LinkId=392555)</span><span class="sxs-lookup"><span data-stu-id="b110a-111">[![SharePoint disaster-recovery process to Azure](../media/SP-DR-Azure.png)](https://go.microsoft.com/fwlink/p/?LinkId=392555)</span></span>
  
 <span data-ttu-id="b110a-112">[PDF](https://go.microsoft.com/fwlink/p/?LinkId=392555) |  [Visio](https://go.microsoft.com/fwlink/p/?LinkId=392554)</span><span class="sxs-lookup"><span data-stu-id="b110a-112">[PDF](https://go.microsoft.com/fwlink/p/?LinkId=392555) |  [Visio](https://go.microsoft.com/fwlink/p/?LinkId=392554)</span></span>
  
## <a name="use-azure-infrastructure-services-for-disaster-recovery"></a><span data-ttu-id="b110a-113">Azure Infrastructure Services gebruiken voor herstel na nood</span><span class="sxs-lookup"><span data-stu-id="b110a-113">Use Azure Infrastructure Services for disaster recovery</span></span>

<span data-ttu-id="b110a-114">Veel organisaties hebben geen omgeving voor noodherstel voor SharePoint, wat duur kan zijn om on-premises te bouwen en te onderhouden.</span><span class="sxs-lookup"><span data-stu-id="b110a-114">Many organizations do not have a disaster recovery environment for SharePoint, which can be expensive to build and maintain on-premises.</span></span> <span data-ttu-id="b110a-115">Azure Infrastructure Services biedt aantrekkelijke opties voor omgevingen voor noodherstel die flexibeler en goedkoper zijn dan de on-premises alternatieven.</span><span class="sxs-lookup"><span data-stu-id="b110a-115">Azure Infrastructure Services provides compelling options for disaster recovery environments that are more flexible and less expensive than the on-premises alternatives.</span></span>
  
<span data-ttu-id="b110a-116">De voordelen voor het gebruik van Azure Infrastructure Services zijn:</span><span class="sxs-lookup"><span data-stu-id="b110a-116">The advantages for using Azure Infrastructure Services include:</span></span>
  
- <span data-ttu-id="b110a-117">**Minder kostbare resources** Onderhoud en betaal voor minder resources dan on-premises omgevingen voor noodherstel.</span><span class="sxs-lookup"><span data-stu-id="b110a-117">**Fewer costly resources** Maintain and pay for fewer resources than on-premises disaster recovery environments.</span></span> <span data-ttu-id="b110a-118">Het aantal resources is afhankelijk van welke omgeving voor noodherstel u kiest: koud stand-by, warm stand-by of hot standby.</span><span class="sxs-lookup"><span data-stu-id="b110a-118">The number of resources depends on which disaster-recovery environment you choose: cold standby, warm standby, or hot standby.</span></span>
    
- <span data-ttu-id="b110a-119">**Betere resourceflexibiliteit** In geval van een ramp kunt u eenvoudig de sharePoint-herstelfarm schalen om te voldoen aan de laadvereisten.</span><span class="sxs-lookup"><span data-stu-id="b110a-119">**Better resource flexibility** In the event of a disaster, easily scale out your recovery SharePoint farm to meet load requirements.</span></span> <span data-ttu-id="b110a-120">Schaal in wanneer u de resources niet meer nodig hebt.</span><span class="sxs-lookup"><span data-stu-id="b110a-120">Scale in when you no longer need the resources.</span></span>
    
- <span data-ttu-id="b110a-121">**Lagere datacenterverplichting** Gebruik Azure Infrastructure Services in plaats van te investeren in een secundair datacenter in een andere regio.</span><span class="sxs-lookup"><span data-stu-id="b110a-121">**Lower datacenter commitment** Use Azure Infrastructure Services instead of investing in a secondary datacenter in a different region.</span></span>
    
<span data-ttu-id="b110a-122">Er zijn minder complexe opties voor organisaties die net aan de slag gaan met herstel na nood en geavanceerde opties voor organisaties met hoge tolerantievereisten.</span><span class="sxs-lookup"><span data-stu-id="b110a-122">There are less-complex options for organizations just getting started with disaster recovery and advanced options for organizations with high-resilience requirements.</span></span> <span data-ttu-id="b110a-123">De definities voor koude, warme en warme standby-omgevingen zijn iets anders wanneer de omgeving wordt gehost op een cloudplatform.</span><span class="sxs-lookup"><span data-stu-id="b110a-123">The definitions for cold, warm, and hot standby environments are a little different when the environment is hosted on a cloud platform.</span></span> <span data-ttu-id="b110a-124">In de volgende tabel worden deze omgevingen beschreven voor het bouwen van een SharePoint-herstelfarm in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-124">The following table describes these environments for building a SharePoint recovery farm in Azure.</span></span>
  
<span data-ttu-id="b110a-125">**Tabel: Herstelomgevingen**</span><span class="sxs-lookup"><span data-stu-id="b110a-125">**Table: Recovery environments**</span></span>

|<span data-ttu-id="b110a-126">**Type herstelomgeving**</span><span class="sxs-lookup"><span data-stu-id="b110a-126">**Type of recovery environment**</span></span>|<span data-ttu-id="b110a-127">**Beschrijving**</span><span class="sxs-lookup"><span data-stu-id="b110a-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b110a-128">Hot</span><span class="sxs-lookup"><span data-stu-id="b110a-128">Hot</span></span>  <br/> |<span data-ttu-id="b110a-129">Een volledig formaat farm is ingericht, bijgewerkt en wordt uitgevoerd op stand-by.</span><span class="sxs-lookup"><span data-stu-id="b110a-129">A fully sized farm is provisioned, updated, and running on standby.</span></span>  <br/> |
|<span data-ttu-id="b110a-130">Warm</span><span class="sxs-lookup"><span data-stu-id="b110a-130">Warm</span></span>  <br/> |<span data-ttu-id="b110a-131">De farm is gebouwd en virtuele machines worden uitgevoerd en bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="b110a-131">The farm is built and virtual machines are running and updated.</span></span>  <br/> <span data-ttu-id="b110a-132">Herstel omvat het koppelen van inhoudsdatabases, het inrichten van servicetoepassingen en het crawlen van inhoud.</span><span class="sxs-lookup"><span data-stu-id="b110a-132">Recovery includes attaching content databases, provisioning service applications, and crawling content.</span></span>  <br/> <span data-ttu-id="b110a-133">De farm kan een kleinere versie van de productiefarm zijn en vervolgens worden opgeschaald om het volledige gebruikersbestand te bedienen.</span><span class="sxs-lookup"><span data-stu-id="b110a-133">The farm can be a smaller version of the production farm and then scaled out to serve the full user base.</span></span>  <br/> |
|<span data-ttu-id="b110a-134">Koud</span><span class="sxs-lookup"><span data-stu-id="b110a-134">Cold</span></span>  <br/> |<span data-ttu-id="b110a-135">De farm is volledig gebouwd, maar de virtuele machines worden gestopt.</span><span class="sxs-lookup"><span data-stu-id="b110a-135">The farm is fully built, but the virtual machines are stopped.</span></span>  <br/> <span data-ttu-id="b110a-136">Het onderhouden van de omgeving omvat het van tijd tot tijd starten van de virtuele machines, het patchen, bijwerken en verifiëren van de omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-136">Maintaining the environment includes starting the virtual machines from time to time, patching, updating, and verifying the environment.</span></span>  <br/> <span data-ttu-id="b110a-137">Start de volledige omgeving in geval van een ramp.</span><span class="sxs-lookup"><span data-stu-id="b110a-137">Start the full environment in the event of a disaster.</span></span>  <br/> |
   
<span data-ttu-id="b110a-138">Het is belangrijk om de doelstellingen voor hersteltijd (RTOs) en herstelpuntdoelstellingen (RPOs) van uw organisatie te evalueren.</span><span class="sxs-lookup"><span data-stu-id="b110a-138">It's important to evaluate your organization's Recovery Time Objectives (RTOs) and Recovery Point Objectives (RPOs).</span></span> <span data-ttu-id="b110a-139">Aan de hand van deze vereisten wordt bepaald welke omgeving de meest geschikte investering is voor uw organisatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-139">These requirements determine which environment is the most appropriate investment for your organization.</span></span>
  
<span data-ttu-id="b110a-140">In de richtlijnen in dit artikel wordt beschreven hoe u een warme stand-by-omgeving implementeert.</span><span class="sxs-lookup"><span data-stu-id="b110a-140">The guidance in this article describes how to implement a warm standby environment.</span></span> <span data-ttu-id="b110a-141">U kunt de omgeving ook aanpassen aan een koude stand-by-omgeving, hoewel u aanvullende procedures moet volgen om dit soort omgevingen te ondersteunen.</span><span class="sxs-lookup"><span data-stu-id="b110a-141">You can also adapt it to a cold standby environment, although you need to follow additional procedures to support this kind of environment.</span></span> <span data-ttu-id="b110a-142">In dit artikel wordt niet beschreven hoe u een hot standby-omgeving implementeert.</span><span class="sxs-lookup"><span data-stu-id="b110a-142">This article does not describe how to implement a hot standby environment.</span></span>
  
<span data-ttu-id="b110a-143">Zie Concepten voor hoge beschikbaarheid en noodherstel [in SharePoint 2013](/SharePoint/administration/high-availability-and-disaster-recovery-concepts) en Een strategie voor noodherstel kiezen voor [SharePoint 2013](/SharePoint/administration/plan-for-disaster-recovery)voor meer informatie over oplossingen voor noodherstel.</span><span class="sxs-lookup"><span data-stu-id="b110a-143">For more information about disaster recovery solutions, see [High availability and disaster recovery concepts in SharePoint 2013](/SharePoint/administration/high-availability-and-disaster-recovery-concepts) and [Choose a disaster recovery strategy for SharePoint 2013](/SharePoint/administration/plan-for-disaster-recovery).</span></span>
  
## <a name="solution-description"></a><span data-ttu-id="b110a-144">Beschrijving van oplossing</span><span class="sxs-lookup"><span data-stu-id="b110a-144">Solution description</span></span>

<span data-ttu-id="b110a-145">Voor de oplossing voor het herstellen van noodscenario's met warme stand-by is de volgende omgeving vereist:</span><span class="sxs-lookup"><span data-stu-id="b110a-145">The warm standby disaster-recovery solution requires the following environment:</span></span>
  
- <span data-ttu-id="b110a-146">Een on-premises SharePoint-productiefarm</span><span class="sxs-lookup"><span data-stu-id="b110a-146">An on-premises SharePoint production farm</span></span>
    
- <span data-ttu-id="b110a-147">Een SharePoint-herstelfarm in Azure</span><span class="sxs-lookup"><span data-stu-id="b110a-147">A recovery SharePoint farm in Azure</span></span>
    
- <span data-ttu-id="b110a-148">Een SITE-naar-site VPN-verbinding tussen de twee omgevingen</span><span class="sxs-lookup"><span data-stu-id="b110a-148">A site-to-site VPN connection between the two environments</span></span>
    
<span data-ttu-id="b110a-149">In de volgende afbeelding worden deze drie elementen geïllustreerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-149">The following figure illustrates these three elements.</span></span>
  
<span data-ttu-id="b110a-150">**Afbeelding: Elementen van een warme standby-oplossing in Azure**</span><span class="sxs-lookup"><span data-stu-id="b110a-150">**Figure: Elements of a warm standby solution in Azure**</span></span>

![Elementen van een warme standby-oplossing van SharePoint in Azure](../media/AZarch-AZWarmStndby.png)
  
<span data-ttu-id="b110a-152">SQL Server-logboekverzending met DFSR (Distributed File System Replication) wordt gebruikt om databaseback-ups en transactielogboeken te kopiëren naar de herstelfarm in Azure:</span><span class="sxs-lookup"><span data-stu-id="b110a-152">SQL Server log shipping with Distributed File System Replication (DFSR) is used to copy database backups and transaction logs to the recovery farm in Azure:</span></span> 
  
- <span data-ttu-id="b110a-153">DFSR brengt logboeken over van de productieomgeving naar de herstelomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-153">DFSR transfers logs from the production environment to the recovery environment.</span></span> <span data-ttu-id="b110a-154">In een WAN-scenario is DFSR efficiënter dan het rechtstreeks verzenden van de logboeken naar de secundaire server in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-154">In a WAN scenario, DFSR is more efficient than shipping the logs directly to the secondary server in Azure.</span></span>
    
- <span data-ttu-id="b110a-155">Logboeken worden opnieuw afgespeeld naar de SQL Server in de herstelomgeving in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-155">Logs are replayed to the SQL Server in the recovery environment in Azure.</span></span>
    
- <span data-ttu-id="b110a-156">U koppelt sharepoint-inhoudsdatabases die zijn verzonden in logboeken pas toe in de herstelomgeving als er een hersteloefening is uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-156">You don't attach log-shipped SharePoint content databases in the recovery environment until a recovery exercise is performed.</span></span>
    
<span data-ttu-id="b110a-157">Voer de volgende stappen uit om de farm te herstellen:</span><span class="sxs-lookup"><span data-stu-id="b110a-157">Perform the following steps to recover the farm:</span></span>
  
1. <span data-ttu-id="b110a-158">Stoppen met het verzenden van logboeken.</span><span class="sxs-lookup"><span data-stu-id="b110a-158">Stop log shipping.</span></span>
    
2. <span data-ttu-id="b110a-159">Stop met het accepteren van verkeer naar de primaire farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-159">Stop accepting traffic to the primary farm.</span></span>
    
3. <span data-ttu-id="b110a-160">De uiteindelijke transactielogboeken opnieuw afspelen.</span><span class="sxs-lookup"><span data-stu-id="b110a-160">Replay the final transaction logs.</span></span>
    
4. <span data-ttu-id="b110a-161">Voeg de inhoudsdatabases toe aan de farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-161">Attach the content databases to the farm.</span></span>
    
5. <span data-ttu-id="b110a-162">Herstel servicetoepassingen uit de gerepliceerde servicesdatabases.</span><span class="sxs-lookup"><span data-stu-id="b110a-162">Restore service applications from the replicated services databases.</span></span>
    
6. <span data-ttu-id="b110a-163">Dns-records (Domain Name System) bijwerken om naar de herstelfarm te wijzen.</span><span class="sxs-lookup"><span data-stu-id="b110a-163">Update Domain Name System (DNS) records to point to the recovery farm.</span></span>
    
7. <span data-ttu-id="b110a-164">Start een volledige verkenning.</span><span class="sxs-lookup"><span data-stu-id="b110a-164">Start a full crawl.</span></span>
    
<span data-ttu-id="b110a-165">U wordt aangeraden deze stappen regelmatig te oefenen en deze te documenteren om ervoor te zorgen dat uw live herstel soepel verloopt.</span><span class="sxs-lookup"><span data-stu-id="b110a-165">We recommend that you rehearse these steps regularly and document them to help ensure that your live recovery runs smoothly.</span></span> <span data-ttu-id="b110a-166">Het koppelen van inhoudsdatabases en het herstellen van servicetoepassingen kan enige tijd duren en vereist meestal een handmatige configuratie.</span><span class="sxs-lookup"><span data-stu-id="b110a-166">Attaching content databases and restoring service applications can take some time and typically involves some manual configuration.</span></span>
  
<span data-ttu-id="b110a-167">Nadat een herstel is uitgevoerd, bevat deze oplossing de items die in de volgende tabel worden vermeld.</span><span class="sxs-lookup"><span data-stu-id="b110a-167">After a recovery is performed, this solution provides the items listed in the following table.</span></span>
  
<span data-ttu-id="b110a-168">**Tabel: Doelstellingen voor oplossingsherstel**</span><span class="sxs-lookup"><span data-stu-id="b110a-168">**Table: Solution recovery objectives**</span></span>

|<span data-ttu-id="b110a-169">**Item**</span><span class="sxs-lookup"><span data-stu-id="b110a-169">**Item**</span></span>|<span data-ttu-id="b110a-170">**Beschrijving**</span><span class="sxs-lookup"><span data-stu-id="b110a-170">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b110a-171">Sites en inhoud</span><span class="sxs-lookup"><span data-stu-id="b110a-171">Sites and content</span></span>  <br/> |<span data-ttu-id="b110a-172">Sites en inhoud zijn beschikbaar in de herstelomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-172">Sites and content are available in the recovery environment.</span></span>  <br/> |
|<span data-ttu-id="b110a-173">Een nieuw exemplaar van zoeken</span><span class="sxs-lookup"><span data-stu-id="b110a-173">A new instance of search</span></span>  <br/> |<span data-ttu-id="b110a-174">In deze warme standby-oplossing wordt zoeken niet hersteld vanuit zoekdatabases.</span><span class="sxs-lookup"><span data-stu-id="b110a-174">In this warm standby solution, search is not restored from search databases.</span></span> <span data-ttu-id="b110a-175">Zoekonderdelen in de herstelfarm zijn zo zo mogelijk geconfigureerd voor de productiefarm.</span><span class="sxs-lookup"><span data-stu-id="b110a-175">Search components in the recovery farm are configured as similarly as possible to the production farm.</span></span> <span data-ttu-id="b110a-176">Nadat de sites en inhoud zijn hersteld, wordt een volledige verkenning gestart om de zoekindex opnieuw op te bouwen.</span><span class="sxs-lookup"><span data-stu-id="b110a-176">After the sites and content are restored, a full crawl is started to rebuild the search index.</span></span> <span data-ttu-id="b110a-177">U hoeft niet te wachten totdat de verkenning is voltooid om de sites en inhoud beschikbaar te maken.</span><span class="sxs-lookup"><span data-stu-id="b110a-177">You do not need to wait for the crawl to complete to make the sites and content available.</span></span>  <br/> |
|<span data-ttu-id="b110a-178">Services</span><span class="sxs-lookup"><span data-stu-id="b110a-178">Services</span></span>  <br/> | <span data-ttu-id="b110a-179">Services die gegevens opslaan in databases, worden teruggezet uit de databases die zijn verzonden.</span><span class="sxs-lookup"><span data-stu-id="b110a-179">Services that store data in databases are restored from the log-shipped databases.</span></span> <span data-ttu-id="b110a-180">Services die geen gegevens opslaan in databases, worden gewoon gestart.</span><span class="sxs-lookup"><span data-stu-id="b110a-180">Services that do not store data in databases are simply started.</span></span> <br/>  <span data-ttu-id="b110a-181">Niet alle services met databases hoeven te worden hersteld.</span><span class="sxs-lookup"><span data-stu-id="b110a-181">Not all services with databases need to be restored.</span></span> <span data-ttu-id="b110a-182">De volgende services hoeven niet te worden hersteld uit databases en kunnen gewoon worden gestart na een failover:</span><span class="sxs-lookup"><span data-stu-id="b110a-182">The following services do not need to be restored from databases and can simply be started after failover:</span></span> <br/>  <span data-ttu-id="b110a-183">Gegevensverzameling gebruik en status</span><span class="sxs-lookup"><span data-stu-id="b110a-183">Usage and Health Data Collection</span></span> <br/>  <span data-ttu-id="b110a-184">State service</span><span class="sxs-lookup"><span data-stu-id="b110a-184">State service</span></span> <br/>  <span data-ttu-id="b110a-185">Word-automatisering</span><span class="sxs-lookup"><span data-stu-id="b110a-185">Word automation</span></span> <br/>  <span data-ttu-id="b110a-186">Een andere service die geen database gebruikt</span><span class="sxs-lookup"><span data-stu-id="b110a-186">Any other service that doesn't use a database</span></span> <br/> |
   
<span data-ttu-id="b110a-187">U kunt samenwerken met Microsoft Consulting Services (MCS) of een partner om complexere hersteldoelstellingen aan te pakken.</span><span class="sxs-lookup"><span data-stu-id="b110a-187">You can work with Microsoft Consulting Services (MCS) or a partner to address more-complex recovery objectives.</span></span> <span data-ttu-id="b110a-188">Deze worden samengevat in de volgende tabel.</span><span class="sxs-lookup"><span data-stu-id="b110a-188">These are summarized in the following table.</span></span>
  
<span data-ttu-id="b110a-189">**Tabel: Andere items die kunnen worden geadresseerd door MCS of een partner**</span><span class="sxs-lookup"><span data-stu-id="b110a-189">**Table: Other items that can be addressed by MCS or a partner**</span></span>

|<span data-ttu-id="b110a-190">**Item**</span><span class="sxs-lookup"><span data-stu-id="b110a-190">**Item**</span></span>|<span data-ttu-id="b110a-191">**Beschrijving**</span><span class="sxs-lookup"><span data-stu-id="b110a-191">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b110a-192">Aangepaste farmoplossingen synchroniseren</span><span class="sxs-lookup"><span data-stu-id="b110a-192">Synchronizing custom farm solutions</span></span>  <br/> |<span data-ttu-id="b110a-193">In het ideale ideaalbeeld is de configuratie van de herstelfarm identiek aan de productiefarm.</span><span class="sxs-lookup"><span data-stu-id="b110a-193">Ideally, the recovery farm configuration is identical to the production farm.</span></span> <span data-ttu-id="b110a-194">U kunt samenwerken met een consultant of partner om te evalueren of aangepaste farmoplossingen worden gerepliceerd en of het proces is gebruikt om de twee omgevingen gesynchroniseerd te houden.</span><span class="sxs-lookup"><span data-stu-id="b110a-194">You can work with a consultant or partner to evaluate whether custom farm solutions are replicated and whether the process is in place for keeping the two environments synchronized.</span></span>  <br/> |
|<span data-ttu-id="b110a-195">On-premises verbindingen met gegevensbronnen</span><span class="sxs-lookup"><span data-stu-id="b110a-195">Connections to data sources on-premises</span></span>  <br/> |<span data-ttu-id="b110a-196">Het is mogelijk niet handig om verbindingen met back-endgegevenssystemen te repliceren, zoals BDC-verbindingen (Backup Domain Controller) en zoekinhoudsbronnen.</span><span class="sxs-lookup"><span data-stu-id="b110a-196">It might not be practical to replicate connections to back-end data systems, such as backup domain controller (BDC) connections and search content sources.</span></span>  <br/> |
|<span data-ttu-id="b110a-197">Scenario's voor zoeken herstellen</span><span class="sxs-lookup"><span data-stu-id="b110a-197">Search restore scenarios</span></span>  <br/> |<span data-ttu-id="b110a-198">Omdat zoekimplementaties voor ondernemingen meestal vrij uniek en complex zijn, is het herstellen van zoekopdrachten uit databases een grotere investering vereist.</span><span class="sxs-lookup"><span data-stu-id="b110a-198">Because enterprise search deployments tend to be fairly unique and complex, restoring search from databases requires a greater investment.</span></span> <span data-ttu-id="b110a-199">U kunt samenwerken met een consultant of partner om scenario's voor het herstellen van zoekopdrachten te identificeren en te implementeren die uw organisatie mogelijk nodig heeft.</span><span class="sxs-lookup"><span data-stu-id="b110a-199">You can work with a consultant or partner to identify and implement search restore scenarios that your organization might require.</span></span>  <br/> |
   
<span data-ttu-id="b110a-200">De richtlijnen in dit artikel gaan ervan uit dat de on-premises farm al is ontworpen en geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-200">The guidance provided in this article assumes that the on-premises farm is already designed and deployed.</span></span>
  
## <a name="detailed-architecture"></a><span data-ttu-id="b110a-201">Gedetailleerde architectuur</span><span class="sxs-lookup"><span data-stu-id="b110a-201">Detailed architecture</span></span>

<span data-ttu-id="b110a-202">Idealiter is de configuratie van de herstelfarm in Azure identiek aan de on-premises productiefarm, inclusief de volgende:</span><span class="sxs-lookup"><span data-stu-id="b110a-202">Ideally, the recovery farm configuration in Azure is identical to the production farm on-premises, including the following:</span></span>
  
- <span data-ttu-id="b110a-203">Dezelfde weergave van serverrollen</span><span class="sxs-lookup"><span data-stu-id="b110a-203">The same representation of server roles</span></span>
    
- <span data-ttu-id="b110a-204">Dezelfde configuratie van aanpassingen</span><span class="sxs-lookup"><span data-stu-id="b110a-204">The same configuration of customizations</span></span>
    
- <span data-ttu-id="b110a-205">Dezelfde configuratie van zoekonderdelen</span><span class="sxs-lookup"><span data-stu-id="b110a-205">The same configuration of search components</span></span>
    
<span data-ttu-id="b110a-206">De omgeving in Azure kan een kleinere versie van de productiefarm zijn.</span><span class="sxs-lookup"><span data-stu-id="b110a-206">The environment in Azure can be a smaller version of the production farm.</span></span> <span data-ttu-id="b110a-207">Als u van plan bent om de herstelfarm uit te schalen na een failover, is het belangrijk dat elk type serverrol in eerste instantie wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="b110a-207">If you plan to scale out the recovery farm after failover, it's important that each type of server role be initially represented.</span></span>
  
<span data-ttu-id="b110a-208">Sommige configuraties zijn mogelijk niet praktisch om te repliceren in de failover-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-208">Some configurations might not be practical to replicate in the failover environment.</span></span> <span data-ttu-id="b110a-209">Test de failoverprocedures en -omgeving om ervoor te zorgen dat de failoverfarm het verwachte serviceniveau biedt.</span><span class="sxs-lookup"><span data-stu-id="b110a-209">Be sure to test the failover procedures and environment to help ensure that the failover farm provides the expected service level.</span></span>
  
<span data-ttu-id="b110a-210">Deze oplossing schrijft geen specifieke topologie voor voor een SharePoint-farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-210">This solution doesn't prescribe a specific topology for a SharePoint farm.</span></span> <span data-ttu-id="b110a-211">De focus van deze oplossing ligt op het gebruik van Azure voor de failoverfarm en het implementeren van logboekverzending en DFSR tussen de twee omgevingen.</span><span class="sxs-lookup"><span data-stu-id="b110a-211">The focus of this solution is to use Azure for the failover farm and to implement log shipping and DFSR between the two environments.</span></span>
  
### <a name="warm-standby-environments"></a><span data-ttu-id="b110a-212">Warme standby-omgevingen</span><span class="sxs-lookup"><span data-stu-id="b110a-212">Warm standby environments</span></span>

<span data-ttu-id="b110a-213">In een warme standby-omgeving worden alle virtuele machines in de Azure-omgeving uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-213">In a warm standby environment, all virtual machines in the Azure environment are running.</span></span> <span data-ttu-id="b110a-214">De omgeving is klaar voor een failover-oefening of gebeurtenis.</span><span class="sxs-lookup"><span data-stu-id="b110a-214">The environment is ready for a failover exercise or event.</span></span>
  
<span data-ttu-id="b110a-215">In de volgende afbeelding ziet u een oplossing voor noodherstel van een on-premises SharePoint-farm naar een Azure-sharePoint-farm die is geconfigureerd als een warme standby-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-215">The following figure illustrates a disaster recovery solution from an on-premises SharePoint farm to an Azure-based SharePoint farm that is configured as a warm standby environment.</span></span>
  
<span data-ttu-id="b110a-216">**Afbeelding: Topologie en belangrijke elementen van een productiefarm en een warm standby-herstelfarm**</span><span class="sxs-lookup"><span data-stu-id="b110a-216">**Figure: Topology and key elements of a production farm and a warm standby recovery farm**</span></span>

![Topologie van een SharePoint-farm en een warm standby-herstelfarm](../media/AZarch-AZWarmStndby.png)
  
<span data-ttu-id="b110a-218">In dit diagram:</span><span class="sxs-lookup"><span data-stu-id="b110a-218">In this diagram:</span></span>
  
- <span data-ttu-id="b110a-219">Twee omgevingen worden naast elkaar geïllustreerd: de on-premises SharePoint-farm en de warme stand-byfarm in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-219">Two environments are illustrated side by side: the on-premises SharePoint farm and the warm standby farm in Azure.</span></span>
    
- <span data-ttu-id="b110a-220">Elke omgeving bevat een bestands delen.</span><span class="sxs-lookup"><span data-stu-id="b110a-220">Each environment includes a file share.</span></span>
    
- <span data-ttu-id="b110a-221">Elke farm bevat vier lagen.</span><span class="sxs-lookup"><span data-stu-id="b110a-221">Each farm includes four tiers.</span></span> <span data-ttu-id="b110a-222">Als u hoge beschikbaarheid wilt bereiken, bevat elke laag twee servers of virtuele machines die identiek zijn geconfigureerd voor een specifieke rol, zoals front-endservices, gedistribueerde cache, back-endservices en databases.</span><span class="sxs-lookup"><span data-stu-id="b110a-222">To achieve high availability, each tier includes two servers or virtual machines that are configured identically for a specific role, such as front-end services, distributed cache, back-end services, and databases.</span></span> <span data-ttu-id="b110a-223">Het is niet belangrijk om in deze afbeelding specifieke onderdelen uit te roepen.</span><span class="sxs-lookup"><span data-stu-id="b110a-223">It isn't important in this illustration to call out specific components.</span></span> <span data-ttu-id="b110a-224">De twee farms zijn identiek geconfigureerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-224">The two farms are configured identically.</span></span>
    
- <span data-ttu-id="b110a-225">De vierde laag is de databaselaag.</span><span class="sxs-lookup"><span data-stu-id="b110a-225">The fourth tier is the database tier.</span></span> <span data-ttu-id="b110a-226">Logboekverzending wordt gebruikt om logboeken van de secundaire databaseserver in de on-premises omgeving te kopiëren naar de bestands delen in dezelfde omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-226">Log shipping is used to copy logs from the secondary database server in the on-premises environment to the file share in the same environment.</span></span>
    
- <span data-ttu-id="b110a-227">DFSR kopieert bestanden uit de bestands delen in de on-premises omgeving naar de bestands delen in de Azure-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-227">DFSR copies files from the file share in the on-premises environment to the file share in the Azure environment.</span></span>
    
- <span data-ttu-id="b110a-228">Logboekverzending herhaalt de logboeken van het bestandsdeel in de Azure-omgeving naar de primaire replica in de beschikbaarheidsgroep SQL Server AlwaysOn in de herstelomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-228">Log shipping replays the logs from the file share in the Azure environment to the primary replica in the SQL Server AlwaysOn availability group in the recovery environment.</span></span>
    
### <a name="cold-standby-environments"></a><span data-ttu-id="b110a-229">Koude stand-by-omgevingen</span><span class="sxs-lookup"><span data-stu-id="b110a-229">Cold standby environments</span></span>

<span data-ttu-id="b110a-230">In een koude stand-by omgeving kunnen de meeste virtuele SharePoint-farm-machines worden afgesloten.</span><span class="sxs-lookup"><span data-stu-id="b110a-230">In a cold standby environment, most of the SharePoint farm virtual machines can be shut down.</span></span> <span data-ttu-id="b110a-231">(Het is raadzaam om af en toe de virtuele machines te starten, bijvoorbeeld om de twee weken of eenmaal per maand, zodat elke virtuele machine kan worden gesynchroniseerd met het domein.) De volgende virtuele machines in de Azure-herstelomgeving moeten actief blijven om ervoor te zorgen dat logboekverzending en DFSR continu worden uitgevoerd:</span><span class="sxs-lookup"><span data-stu-id="b110a-231">(We recommend occasionally starting the virtual machines, such as every two weeks or once a month, so that each virtual machine can sync with the domain.) The following virtual machines in the Azure recovery environment must remain running to help ensure continuous operations of log shipping and DFSR:</span></span>
  
- <span data-ttu-id="b110a-232">Het bestand delen</span><span class="sxs-lookup"><span data-stu-id="b110a-232">The file share</span></span>
    
- <span data-ttu-id="b110a-233">De primaire databaseserver</span><span class="sxs-lookup"><span data-stu-id="b110a-233">The primary database server</span></span>
    
- <span data-ttu-id="b110a-234">Ten minste één virtuele computer met Windows Server Active Directory Domain Services en DNS</span><span class="sxs-lookup"><span data-stu-id="b110a-234">At least one virtual machine running Windows Server Active Directory Domain Services and DNS</span></span>
    
<span data-ttu-id="b110a-235">In de volgende afbeelding ziet u een Azure-failover-omgeving waarin de virtuele computer voor het delen van bestanden en de primaire virtuele SharePoint-database worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-235">The following figure shows an Azure failover environment in which the file share virtual machine and the primary SharePoint database virtual machine are running.</span></span> <span data-ttu-id="b110a-236">Alle andere virtuele SharePoint-machines worden gestopt.</span><span class="sxs-lookup"><span data-stu-id="b110a-236">All other SharePoint virtual machines are stopped.</span></span> <span data-ttu-id="b110a-237">De virtuele computer met Windows Server Active Directory en DNS wordt niet weergegeven.</span><span class="sxs-lookup"><span data-stu-id="b110a-237">The virtual machine that is running Windows Server Active Directory and DNS is not shown.</span></span>
  
<span data-ttu-id="b110a-238">**Afbeelding: Cold standby recovery farm with running virtual machines**</span><span class="sxs-lookup"><span data-stu-id="b110a-238">**Figure: Cold standby recovery farm with running virtual machines**</span></span>

![Elementen van een cold standby-oplossing van SharePoint in Azure](../media/AZarch-AZColdStndby.png)
  
<span data-ttu-id="b110a-240">Na een failover naar een koude stand-by-omgeving worden alle virtuele machines gestart en moet de methode voor een hoge beschikbaarheid van de databaseservers worden geconfigureerd, zoals beschikbaarheidsgroepen van SQL Server AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="b110a-240">After failover to a cold standby environment, all virtual machines are started, and the method to achieve high availability of the database servers must be configured, such as SQL Server AlwaysOn availability groups.</span></span>
  
<span data-ttu-id="b110a-241">Als meerdere opslaggroepen worden geïmplementeerd (databases zijn verspreid over meer dan één SQL Server-set met hoge beschikbaarheid), moet de primaire database voor elke opslaggroep worden uitgevoerd om de logboeken te accepteren die zijn gekoppeld aan de opslaggroep.</span><span class="sxs-lookup"><span data-stu-id="b110a-241">If multiple storage groups are implemented (databases are spread across more than one SQL Server high availability set), the primary database for each storage group must be running to accept the logs associated with its storage group.</span></span>
  
### <a name="skills-and-experience"></a><span data-ttu-id="b110a-242">Vaardigheden en ervaring</span><span class="sxs-lookup"><span data-stu-id="b110a-242">Skills and experience</span></span>

<span data-ttu-id="b110a-243">Er worden meerdere technologieën gebruikt in deze oplossing voor noodherstel.</span><span class="sxs-lookup"><span data-stu-id="b110a-243">Multiple technologies are used in this disaster recovery solution.</span></span> <span data-ttu-id="b110a-244">Om ervoor te zorgen dat deze technologieën werken zoals verwacht, moet elk onderdeel in de on-premises en Azure-omgeving correct zijn geïnstalleerd en geconfigureerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-244">To help ensure that these technologies interact as expected, each component in the on-premises and Azure environment must be installed and configured correctly.</span></span> <span data-ttu-id="b110a-245">Het is raadzaam dat de persoon of het team die deze oplossing in stelt, beschikt over een sterke kennis van en hands-on vaardigheden met de technologieën die in de volgende artikelen worden beschreven:</span><span class="sxs-lookup"><span data-stu-id="b110a-245">We recommend that the person or team who sets up this solution have a strong working knowledge of and hands-on skills with the technologies described in the following articles:</span></span>
  
- <span data-ttu-id="b110a-246">[DFS-replicatieservices (Distributed File System)](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj127250(v=ws.11))</span><span class="sxs-lookup"><span data-stu-id="b110a-246">[Distributed File System (DFS) Replication Services](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj127250(v=ws.11))</span></span>
    
- [<span data-ttu-id="b110a-247">Windows Server Failover Clustering (WSFC) met SQL Server</span><span class="sxs-lookup"><span data-stu-id="b110a-247">Windows Server Failover Clustering (WSFC) with SQL Server</span></span>](/sql/sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server)
    
- [<span data-ttu-id="b110a-248">AlwaysOn Availability Groups (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b110a-248">AlwaysOn Availability Groups (SQL Server)</span></span>](/sql/database-engine/availability-groups/windows/always-on-availability-groups-sql-server)
    
- [<span data-ttu-id="b110a-249">Back-up maken en herstellen van SQL Server-databases</span><span class="sxs-lookup"><span data-stu-id="b110a-249">Back Up and Restore of SQL Server Databases</span></span>](/sql/relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases)
    
- [<span data-ttu-id="b110a-250">Installatie en farm-implementatie van SharePoint Server 2013</span><span class="sxs-lookup"><span data-stu-id="b110a-250">SharePoint Server 2013 installation and farm deployment</span></span>](/SharePoint/install/installation-and-configuration-overview)
    
- [<span data-ttu-id="b110a-251">Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="b110a-251">Microsoft Azure</span></span>](/azure/)
    
<span data-ttu-id="b110a-252">Ten slotte raden we u aan scripts te maken die u kunt gebruiken om taken die aan deze technologieën zijn gekoppeld te automatiseren.</span><span class="sxs-lookup"><span data-stu-id="b110a-252">Finally, we recommend scripting skills that you can use to automate tasks associated with these technologies.</span></span> <span data-ttu-id="b110a-253">Het is mogelijk om de beschikbare gebruikersinterfaces te gebruiken om alle taken uit te voeren die in deze oplossing worden beschreven.</span><span class="sxs-lookup"><span data-stu-id="b110a-253">It's possible to use the available user interfaces to complete all the tasks described in this solution.</span></span> <span data-ttu-id="b110a-254">Een handmatige benadering kan echter tijdrovend en foutgevoelig zijn en levert inconsistente resultaten op.</span><span class="sxs-lookup"><span data-stu-id="b110a-254">However, a manual approach can be time consuming and error prone and delivers inconsistent results.</span></span>
  
<span data-ttu-id="b110a-255">Naast Windows PowerShell zijn er ook Windows PowerShell-bibliotheken voor SQL Server, SharePoint Server en Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-255">In addition to Windows PowerShell, there are also Windows PowerShell libraries for SQL Server, SharePoint Server, and Azure.</span></span> <span data-ttu-id="b110a-256">Vergeet T-SQL niet, waardoor u ook minder tijd hebt om uw omgeving voor herstel na noodherstel te configureren en te onderhouden.</span><span class="sxs-lookup"><span data-stu-id="b110a-256">Don't forget T-SQL, which can also help reduce the time to configure and maintain your disaster-recovery environment.</span></span>
  
## <a name="disaster-recovery-roadmap"></a><span data-ttu-id="b110a-257">Routekaart voor herstel na ramp</span><span class="sxs-lookup"><span data-stu-id="b110a-257">Disaster recovery roadmap</span></span>

![Visuele weergave van de routekaart voor rampherstel van SharePoint.](../media/Azure-DRroadmap.png)
  
<span data-ttu-id="b110a-259">In deze routekaart wordt ervan uitgenomen dat u al een SharePoint Server 2013-farm hebt geïmplementeerd in productie.</span><span class="sxs-lookup"><span data-stu-id="b110a-259">This roadmap assumes that you already have a SharePoint Server 2013 farm deployed in production.</span></span>
  
<span data-ttu-id="b110a-260">**Tabel: Routekaart voor herstel na ramp**</span><span class="sxs-lookup"><span data-stu-id="b110a-260">**Table: Roadmap for disaster recovery**</span></span>

|<span data-ttu-id="b110a-261">**Fase**</span><span class="sxs-lookup"><span data-stu-id="b110a-261">**Phase**</span></span>|<span data-ttu-id="b110a-262">**Beschrijving**</span><span class="sxs-lookup"><span data-stu-id="b110a-262">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b110a-263">Fase 1</span><span class="sxs-lookup"><span data-stu-id="b110a-263">Phase 1</span></span>  <br/> |<span data-ttu-id="b110a-264">Ontwerp de herstelomgeving voor rampen.</span><span class="sxs-lookup"><span data-stu-id="b110a-264">Design the disaster recovery environment.</span></span>  <br/> |
|<span data-ttu-id="b110a-265">Fase 2</span><span class="sxs-lookup"><span data-stu-id="b110a-265">Phase 2</span></span>  <br/> |<span data-ttu-id="b110a-266">Maak de virtuele Azure-netwerk- en VPN-verbinding.</span><span class="sxs-lookup"><span data-stu-id="b110a-266">Create the Azure virtual network and VPN connection.</span></span>  <br/> |
|<span data-ttu-id="b110a-267">Fase 3</span><span class="sxs-lookup"><span data-stu-id="b110a-267">Phase 3</span></span>  <br/> |<span data-ttu-id="b110a-268">Windows Active Directory en Domain Name Services implementeren in het virtuele Azure-netwerk.</span><span class="sxs-lookup"><span data-stu-id="b110a-268">Deploy Windows Active Directory and Domain Name Services to the Azure virtual network.</span></span>  <br/> |
|<span data-ttu-id="b110a-269">Fase 4</span><span class="sxs-lookup"><span data-stu-id="b110a-269">Phase 4</span></span>  <br/> |<span data-ttu-id="b110a-270">Implementeer de SharePoint-herstelfarm in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-270">Deploy the SharePoint recovery farm in Azure.</span></span>  <br/> |
|<span data-ttu-id="b110a-271">Fase 5</span><span class="sxs-lookup"><span data-stu-id="b110a-271">Phase 5</span></span>  <br/> |<span data-ttu-id="b110a-272">Stel DFSR in tussen de farms.</span><span class="sxs-lookup"><span data-stu-id="b110a-272">Set up DFSR between the farms.</span></span>  <br/> |
|<span data-ttu-id="b110a-273">Fase 6</span><span class="sxs-lookup"><span data-stu-id="b110a-273">Phase 6</span></span>  <br/> |<span data-ttu-id="b110a-274">Logboekzending instellen voor de herstelfarm.</span><span class="sxs-lookup"><span data-stu-id="b110a-274">Set up log shipping to the recovery farm.</span></span>  <br/> |
|<span data-ttu-id="b110a-275">Fase 7</span><span class="sxs-lookup"><span data-stu-id="b110a-275">Phase 7</span></span>  <br/> | <span data-ttu-id="b110a-276">Valideer failover- en hersteloplossingen.</span><span class="sxs-lookup"><span data-stu-id="b110a-276">Validate failover and recovery solutions.</span></span> <span data-ttu-id="b110a-277">Dit omvat de volgende procedures en technologieën:</span><span class="sxs-lookup"><span data-stu-id="b110a-277">This includes the following procedures and technologies:</span></span> <br/>  <span data-ttu-id="b110a-278">Stoppen met het verzenden van logboeken.</span><span class="sxs-lookup"><span data-stu-id="b110a-278">Stop log shipping.</span></span> <br/>  <span data-ttu-id="b110a-279">Herstel de back-ups.</span><span class="sxs-lookup"><span data-stu-id="b110a-279">Restore the backups.</span></span> <br/>  <span data-ttu-id="b110a-280">Inhoud crawlen.</span><span class="sxs-lookup"><span data-stu-id="b110a-280">Crawl content.</span></span> <br/>  <span data-ttu-id="b110a-281">Services herstellen.</span><span class="sxs-lookup"><span data-stu-id="b110a-281">Recover services.</span></span> <br/>  <span data-ttu-id="b110a-282">DNS-records beheren.</span><span class="sxs-lookup"><span data-stu-id="b110a-282">Manage DNS records.</span></span> <br/> |
   
## <a name="phase-1-design-the-disaster-recovery-environment"></a><span data-ttu-id="b110a-283">Fase 1: De herstelomgeving voor rampen ontwerpen</span><span class="sxs-lookup"><span data-stu-id="b110a-283">Phase 1: Design the disaster recovery environment</span></span>

<span data-ttu-id="b110a-284">Gebruik de richtlijnen in [Microsoft Azure Architectures voor SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) om de omgeving voor herstel na noodherstel te ontwerpen, inclusief de SharePoint-herstelfarm.</span><span class="sxs-lookup"><span data-stu-id="b110a-284">Use the guidance in [Microsoft Azure Architectures for SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) to design the disaster-recovery environment, including the SharePoint recovery farm.</span></span> <span data-ttu-id="b110a-285">U kunt de afbeeldingen in het [SharePoint Disaster Recovery Solution in Azure](https://go.microsoft.com/fwlink/p/?LinkId=392554) Visio-bestand gebruiken om het ontwerpproces te starten.</span><span class="sxs-lookup"><span data-stu-id="b110a-285">You can use the graphics in the [SharePoint Disaster Recovery Solution in Azure](https://go.microsoft.com/fwlink/p/?LinkId=392554) Visio file to start the design process.</span></span> <span data-ttu-id="b110a-286">U wordt aangeraden de hele omgeving te ontwerpen voordat u begint met werken in de Azure-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-286">We recommend that you design the entire environment before beginning any work in the Azure environment.</span></span>
  
<span data-ttu-id="b110a-287">Naast de richtlijnen in [Microsoft Azure Architectures voor SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) voor het ontwerpen van het virtuele netwerk, vpn-verbinding, Active Directory en SharePoint-farm, moet u een rol voor het delen van bestanden toevoegen aan de Azure-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-287">In addition to the guidance provided in [Microsoft Azure Architectures for SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) for designing the virtual network, VPN connection, Active Directory, and SharePoint farm, be sure to add a file share role to the Azure environment.</span></span>
  
<span data-ttu-id="b110a-288">Als u het verzenden van logboeken in een oplossing voor noodherstel wilt ondersteunen, wordt een virtuele computer voor bestands delen toegevoegd aan het subnet waar de databaserollen zich bevinden.</span><span class="sxs-lookup"><span data-stu-id="b110a-288">To support log shipping in a disaster-recovery solution, a file share virtual machine is added to the subnet where the database roles reside.</span></span> <span data-ttu-id="b110a-289">Het bestandsdeel fungeert ook als het derde knooppunt van een knooppuntmeerderheid voor de beschikbaarheidsgroep SQL Server AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="b110a-289">The file share also serves as the third node of a Node Majority for the SQL Server AlwaysOn availability group.</span></span> <span data-ttu-id="b110a-290">Dit is de aanbevolen configuratie voor een standaard SharePoint-farm met SQL Server AlwaysOn-beschikbaarheidsgroepen.</span><span class="sxs-lookup"><span data-stu-id="b110a-290">This is the recommended configuration for a standard SharePoint farm that uses SQL Server AlwaysOn availability groups.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b110a-291">Het is belangrijk dat u de vereisten voor een database bekijkt om deel te nemen aan een beschikbaarheidsgroep van SQL Server AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="b110a-291">It is important to review the prerequisites for a database to participate in a SQL Server AlwaysOn availability group.</span></span> <span data-ttu-id="b110a-292">Zie Vereisten, beperkingen en aanbevelingen voor [AlwaysOn Availability Groups](/sql/database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability)voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-292">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups](/sql/database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability).</span></span> 
  
<span data-ttu-id="b110a-293">**Afbeelding: Plaatsing van een bestandsserver die wordt gebruikt voor een oplossing voor noodherstel**</span><span class="sxs-lookup"><span data-stu-id="b110a-293">**Figure: Placement of a file server used for a disaster recovery solution**</span></span>

![Toont een VM voor bestands delen die is toegevoegd aan dezelfde cloudservice die de SharePoint-databaseserverrollen bevat.](../media/AZenv-FSforDFSRandWSFC.png)
  
<span data-ttu-id="b110a-295">In dit diagram wordt een virtuele computer voor het delen van bestanden toegevoegd aan hetzelfde subnet in Azure dat de databaseserverrollen bevat.</span><span class="sxs-lookup"><span data-stu-id="b110a-295">In this diagram, a file share virtual machine is added to the same subnet in Azure that contains the database server roles.</span></span> <span data-ttu-id="b110a-296">Voeg de virtuele computer voor het delen van bestanden niet toe aan een beschikbaarheidsset met andere serverrollen, zoals de SQL Server-rollen.</span><span class="sxs-lookup"><span data-stu-id="b110a-296">Do not add the file share virtual machine to an availability set with other server roles, such as the SQL Server roles.</span></span>
  
<span data-ttu-id="b110a-297">Als u zich zorgen maakt over de hoge beschikbaarheid van de logboeken, kunt u een andere benadering kiezen door SQL Server back-up te gebruiken en terug te zetten [met Azure Blob Storage Service.](/sql/relational-databases/backup-restore/sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service)</span><span class="sxs-lookup"><span data-stu-id="b110a-297">If you are concerned about the high availability of the logs, consider taking a different approach by using [SQL Server backup and restore with Azure Blob Storage Service](/sql/relational-databases/backup-restore/sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service).</span></span> <span data-ttu-id="b110a-298">Dit is een nieuwe functie in Azure waarmee logboeken rechtstreeks worden opgeslagen in een BLOB-opslag-URL.</span><span class="sxs-lookup"><span data-stu-id="b110a-298">This is a new feature in Azure that saves logs directly to a blob storage URL.</span></span> <span data-ttu-id="b110a-299">Deze oplossing bevat geen richtlijnen voor het gebruik van deze functie.</span><span class="sxs-lookup"><span data-stu-id="b110a-299">This solution does not include guidance about using this feature.</span></span>
  
<span data-ttu-id="b110a-300">Wanneer u de herstelfarm ontwerpt, moet u er rekening mee houden dat een succesvolle omgeving voor herstel na noodherstel nauwkeurig de productiefarm wedt die u wilt herstellen.</span><span class="sxs-lookup"><span data-stu-id="b110a-300">When you design the recovery farm, keep in mind that a successful disaster recovery environment accurately reflects the production farm that you want to recover.</span></span> <span data-ttu-id="b110a-301">De grootte van de herstelfarm is niet het belangrijkste in het ontwerp, de implementatie en het testen van de herstelfarm.</span><span class="sxs-lookup"><span data-stu-id="b110a-301">The size of the recovery farm is not the most important thing in the recovery farm's design, deployment, and testing.</span></span> <span data-ttu-id="b110a-302">De schaal van de farm verschilt per organisatie op basis van bedrijfsvereisten.</span><span class="sxs-lookup"><span data-stu-id="b110a-302">Farm scale varies from organization to organization based on business requirements.</span></span> <span data-ttu-id="b110a-303">Het is mogelijk om een geschaalde farm te gebruiken voor een korte uitval of totdat u de farm moet schalen door prestatie- en capaciteitseisen.</span><span class="sxs-lookup"><span data-stu-id="b110a-303">It might be possible to use a scaled-down farm for a short outage or until performance and capacity demands require you to scale the farm.</span></span>
  
<span data-ttu-id="b110a-304">Configureer de herstelfarm zo identiek mogelijk met de productiefarm, zodat deze voldoet aan uw SLA-vereisten (Service Level Agreement) en de functionaliteit biedt die u nodig hebt om uw bedrijf te ondersteunen.</span><span class="sxs-lookup"><span data-stu-id="b110a-304">Configure the recovery farm as identically as possible to the production farm so that it meets your service level agreement (SLA) requirements and provides the functionality that you need to support your business.</span></span> <span data-ttu-id="b110a-305">Wanneer u de herstelomgeving voor noodscenario's ontwerpt, bekijkt u ook uw wijzigingsbeheerproces voor uw productieomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-305">When you design the disaster recovery environment, also look at your change management process for your production environment.</span></span> <span data-ttu-id="b110a-306">U wordt aangeraden het wijzigingsbeheerproces uit te breiden naar de herstelomgeving door de herstelomgeving met hetzelfde interval als de productieomgeving bij te werken.</span><span class="sxs-lookup"><span data-stu-id="b110a-306">We recommend that you extend the change management process to the recovery environment by updating the recovery environment at the same interval as the production environment.</span></span> <span data-ttu-id="b110a-307">Als onderdeel van het proces voor wijzigingsbeheer wordt u aangeraden een gedetailleerde inventaris van uw farmconfiguratie, -toepassingen en -gebruikers bij te houden.</span><span class="sxs-lookup"><span data-stu-id="b110a-307">As part of the change management process, we recommend maintaining a detailed inventory of your farm configuration, applications, and users.</span></span> 
  
## <a name="phase-2-create-the-azure-virtual-network-and-vpn-connection"></a><span data-ttu-id="b110a-308">Fase 2: Het virtuele Azure-netwerk en de VPN-verbinding maken</span><span class="sxs-lookup"><span data-stu-id="b110a-308">Phase 2: Create the Azure virtual network and VPN connection</span></span>

<span data-ttu-id="b110a-309">[Als u een on-premises netwerk verbindt](connect-an-on-premises-network-to-a-microsoft-azure-virtual-network.md) met een virtueel Microsoft Azure-netwerk, kunt u zien hoe u het virtuele netwerk in Azure kunt plannen en implementeren en hoe u de VPN-verbinding kunt maken.</span><span class="sxs-lookup"><span data-stu-id="b110a-309">[Connect an on-premises network to a Microsoft Azure virtual network](connect-an-on-premises-network-to-a-microsoft-azure-virtual-network.md) shows you how to plan and deploy the virtual network in Azure and how to create the VPN connection.</span></span> <span data-ttu-id="b110a-310">Volg de richtlijnen in het onderwerp om de volgende procedures uit te voeren:</span><span class="sxs-lookup"><span data-stu-id="b110a-310">Follow the guidance in the topic to complete the following procedures:</span></span>
  
- <span data-ttu-id="b110a-311">Plan de privé-IP-adresruimte van het virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="b110a-311">Plan the private IP address space of the Virtual Network.</span></span>
    
- <span data-ttu-id="b110a-312">Plan de wijzigingen in de routeringsinfrastructuur voor het virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="b110a-312">Plan the routing infrastructure changes for the Virtual Network.</span></span>
    
- <span data-ttu-id="b110a-313">Plan firewallregels voor verkeer van en naar het on-premises VPN-apparaat.</span><span class="sxs-lookup"><span data-stu-id="b110a-313">Plan firewall rules for traffic to and from the on-premises VPN device.</span></span>
    
- <span data-ttu-id="b110a-314">Maak het cross-premises virtuele netwerk in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-314">Create the cross-premises virtual network in Azure.</span></span>
    
- <span data-ttu-id="b110a-315">Routering configureren tussen uw on-premises netwerk en het virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="b110a-315">Configure routing between your on-premises network and the Virtual Network.</span></span>
    
## <a name="phase-3-deploy-active-directory-and-domain-name-services-to-the-azure-virtual-network"></a><span data-ttu-id="b110a-316">Fase 3: Active Directory- en domeinnaamservices implementeren in het virtuele Azure-netwerk</span><span class="sxs-lookup"><span data-stu-id="b110a-316">Phase 3: Deploy Active Directory and Domain Name Services to the Azure virtual network</span></span>

<span data-ttu-id="b110a-317">Deze fase omvat het implementeren van zowel Windows Server Active Directory als DNS naar het virtuele netwerk in een hybride scenario zoals beschreven in [Microsoft Azure Architectures voor SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) en zoals wordt geïllustreerd in de volgende afbeelding.</span><span class="sxs-lookup"><span data-stu-id="b110a-317">This phase includes deploying both Windows Server Active Directory and DNS to the Virtual Network in a hybrid scenario as described in [Microsoft Azure Architectures for SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) and as illustrated in the following figure.</span></span>
  
<span data-ttu-id="b110a-318">**Afbeelding: Hybride Active Directory-domeinconfiguratie**</span><span class="sxs-lookup"><span data-stu-id="b110a-318">**Figure: Hybrid Active Directory domain configuration**</span></span>

![Twee virtuele machines die zijn geïmplementeerd in het virtuele Azure-netwerk en het subnet SharePoint Farm zijn replicadomeincontrollers en DNS-servers](../media/AZarch-HyADdomainConfig.png)
  
<span data-ttu-id="b110a-320">In de afbeelding worden twee virtuele machines geïmplementeerd op hetzelfde subnet.</span><span class="sxs-lookup"><span data-stu-id="b110a-320">In the illustration, two virtual machines are deployed to the same subnet.</span></span> <span data-ttu-id="b110a-321">Deze virtuele machines hosten elk twee rollen: Active Directory en DNS.</span><span class="sxs-lookup"><span data-stu-id="b110a-321">These virtual machines are each hosting two roles: Active Directory and DNS.</span></span>
  
<span data-ttu-id="b110a-322">Lees Richtlijnen voor het implementeren van Windows Server Active Directory op Azure Virtual Machines voordat u Active Directory implementeert in [Azure.](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100)</span><span class="sxs-lookup"><span data-stu-id="b110a-322">Before deploying Active Directory in Azure, read [Guidelines for Deploying Windows Server Active Directory on Azure Virtual Machines](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100).</span></span> <span data-ttu-id="b110a-323">Met deze richtlijnen kunt u bepalen of u een andere architectuur of andere configuratie-instellingen voor uw oplossing nodig hebt.</span><span class="sxs-lookup"><span data-stu-id="b110a-323">These guidelines help you determine whether you need a different architecture or different configuration settings for your solution.</span></span>
  
<span data-ttu-id="b110a-324">Zie Een Replica Active Directory-domeincontroller installeren in Azure Virtual Networks voor gedetailleerde instructies over het instellen [van een domeincontroller in Azure.](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100)</span><span class="sxs-lookup"><span data-stu-id="b110a-324">For detailed guidance on setting up a domain controller in Azure, see [Install a Replica Active Directory Domain Controller in Azure Virtual Networks](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100).</span></span>
  
<span data-ttu-id="b110a-325">Vóór deze fase hebt u geen virtuele machines geïmplementeerd in het virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="b110a-325">Before this phase, you didn't deploy virtual machines to the Virtual Network.</span></span> <span data-ttu-id="b110a-326">De virtuele machines voor het hosten van Active Directory en DNS zijn waarschijnlijk niet de grootste virtuele machines die u nodig hebt voor de oplossing.</span><span class="sxs-lookup"><span data-stu-id="b110a-326">The virtual machines for hosting Active Directory and DNS are likely not the largest virtual machines you need for the solution.</span></span> <span data-ttu-id="b110a-327">Voordat u deze virtuele machines implementeert, maakt u eerst de grootste virtuele machine die u wilt gebruiken in uw virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="b110a-327">Before you deploy these virtual machines, first create the largest virtual machine that you plan to use in your Virtual Network.</span></span> <span data-ttu-id="b110a-328">Dit helpt ervoor te zorgen dat uw oplossing op een tag in Azure terecht komt die de grootste grootte mogelijk maakt die u nodig hebt.</span><span class="sxs-lookup"><span data-stu-id="b110a-328">This helps ensure that your solution lands on a tag in Azure that allows the largest size you need.</span></span> <span data-ttu-id="b110a-329">U hoeft deze virtuele computer momenteel niet te configureren.</span><span class="sxs-lookup"><span data-stu-id="b110a-329">You do not need to configure this virtual machine at this time.</span></span> <span data-ttu-id="b110a-330">Maak het gewoon en zet het opzij.</span><span class="sxs-lookup"><span data-stu-id="b110a-330">Simply create it, and set it aside.</span></span> <span data-ttu-id="b110a-331">Als u dit niet doet, loopt u mogelijk een beperking op wanneer u later grotere virtuele machines probeert te maken, wat een probleem was op het moment dat dit artikel werd geschreven.</span><span class="sxs-lookup"><span data-stu-id="b110a-331">If you do not do this, you might run into a limitation when you try to create larger virtual machines later, which was an issue at the time this article was written.</span></span> 
  
## <a name="phase-4-deploy-the-sharepoint-recovery-farm-in-azure"></a><span data-ttu-id="b110a-332">Fase 4: De SharePoint-herstelfarm implementeren in Azure</span><span class="sxs-lookup"><span data-stu-id="b110a-332">Phase 4: Deploy the SharePoint recovery farm in Azure</span></span>

<span data-ttu-id="b110a-333">Implementeer de SharePoint-farm in uw virtuele netwerk volgens uw ontwerpplannen.</span><span class="sxs-lookup"><span data-stu-id="b110a-333">Deploy the SharePoint farm in your Virtual Network according to your design plans.</span></span> <span data-ttu-id="b110a-334">Het kan handig zijn om Planning voor [SharePoint 2013](/previous-versions/azure/dn275958(v=azure.100)) op Azure Infrastructure Services te bekijken voordat u SharePoint-rollen implementeert in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-334">It might be helpful to review [Planning for SharePoint 2013 on Azure Infrastructure Services](/previous-versions/azure/dn275958(v=azure.100)) before you deploy SharePoint roles in Azure.</span></span>
  
<span data-ttu-id="b110a-335">Houd rekening met de volgende procedures die we hebben geleerd door onze proof of concept-omgeving te bouwen:</span><span class="sxs-lookup"><span data-stu-id="b110a-335">Consider the following practices that we learned by building our proof of concept environment:</span></span>
  
- <span data-ttu-id="b110a-336">Maak virtuele machines met behulp van de Azure-portal of PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b110a-336">Create virtual machines by using the Azure portal or PowerShell.</span></span>
    
- <span data-ttu-id="b110a-337">Azure en Hyper-V ondersteunen geen dynamisch geheugen.</span><span class="sxs-lookup"><span data-stu-id="b110a-337">Azure and Hyper-V do not support dynamic memory.</span></span> <span data-ttu-id="b110a-338">Zorg ervoor dat dit wordt meegenomen in uw prestatie- en capaciteitsplannen.</span><span class="sxs-lookup"><span data-stu-id="b110a-338">Be sure this is factored into your performance and capacity plans.</span></span>
    
- <span data-ttu-id="b110a-339">Start virtuele machines opnieuw op via de Azure-interface, niet vanaf de virtuele computer die zich aanlogt.</span><span class="sxs-lookup"><span data-stu-id="b110a-339">Restart virtual machines through the Azure interface, not from the virtual machine logon itself.</span></span> <span data-ttu-id="b110a-340">Het gebruik van de Azure-interface werkt beter en is voorspelbaarder.</span><span class="sxs-lookup"><span data-stu-id="b110a-340">Using the Azure interface works better and is more predictable.</span></span>
    
- <span data-ttu-id="b110a-341">Als u een virtuele machine wilt afsluiten om kosten te besparen, gebruikt u de Azure-interface.</span><span class="sxs-lookup"><span data-stu-id="b110a-341">If you want to shut down a virtual machine to save costs, use the Azure interface.</span></span> <span data-ttu-id="b110a-342">Als u de aanmelding voor de virtuele computer uitzet, blijven de kosten toenemen.</span><span class="sxs-lookup"><span data-stu-id="b110a-342">If you shut down from the virtual machine logon, charges continue to accrue.</span></span>
    
- <span data-ttu-id="b110a-343">Gebruik een naamgevingsconventie voor de virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="b110a-343">Use a naming convention for the virtual machines.</span></span>
    
- <span data-ttu-id="b110a-344">Let op welke datacenterlocatie de virtuele machines worden geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-344">Pay attention to which datacenter location the virtual machines are being deployed.</span></span>
    
- <span data-ttu-id="b110a-345">De functie automatische schaal in Azure wordt niet ondersteund voor SharePoint-rollen.</span><span class="sxs-lookup"><span data-stu-id="b110a-345">The automatic scaling feature in Azure is not supported for SharePoint roles.</span></span>
    
- <span data-ttu-id="b110a-346">Configureer geen items in de farm die worden hersteld, zoals siteverzamelingen.</span><span class="sxs-lookup"><span data-stu-id="b110a-346">Do not configure items in the farm that will be restored, such as site collections.</span></span> 
    
## <a name="phase-5-set-up-dfsr-between-the-farms"></a><span data-ttu-id="b110a-347">Fase 5: DFSR instellen tussen de farms</span><span class="sxs-lookup"><span data-stu-id="b110a-347">Phase 5: Set up DFSR between the farms</span></span>

<span data-ttu-id="b110a-348">Als u bestandsreplicatie wilt instellen met DFSR, gebruikt u de module DNS Management.</span><span class="sxs-lookup"><span data-stu-id="b110a-348">To set up file replication by using DFSR, use the DNS Management snap-in.</span></span> <span data-ttu-id="b110a-349">Vóór de DFSR-instelling moet u zich echter aanmelden bij uw on-premises bestandsserver en Azure-bestandsserver en de service inSchakelen in Windows.</span><span class="sxs-lookup"><span data-stu-id="b110a-349">However, before the DFSR setup, log on to your on-premises file server and Azure file server and enable the service in Windows.</span></span>
  
<span data-ttu-id="b110a-350">Volg de volgende stappen in het serverbeheerdashboard:</span><span class="sxs-lookup"><span data-stu-id="b110a-350">From the Server Manager Dashboard, complete the following steps:</span></span>
  
- <span data-ttu-id="b110a-351">Configureer de lokale server.</span><span class="sxs-lookup"><span data-stu-id="b110a-351">Configure the local server.</span></span>
    
- <span data-ttu-id="b110a-352">Start de **wizard Rollen en functies toevoegen.**</span><span class="sxs-lookup"><span data-stu-id="b110a-352">Start the **Add Roles and Features Wizard**.</span></span>
    
- <span data-ttu-id="b110a-353">Open het **knooppunt Bestands- en opslagservices.**</span><span class="sxs-lookup"><span data-stu-id="b110a-353">Open the **File and Storage Services** node.</span></span>
    
- <span data-ttu-id="b110a-354">Selecteer **DFS-naamruimten en** **DFS-replicatie.**</span><span class="sxs-lookup"><span data-stu-id="b110a-354">Select **DFS Namespaces** and **DFS replication**.</span></span>
    
- <span data-ttu-id="b110a-355">Klik **op Volgende** om de wizardstappen te voltooien.</span><span class="sxs-lookup"><span data-stu-id="b110a-355">Click **Next** to finish the wizard steps.</span></span>
    
<span data-ttu-id="b110a-356">De volgende tabel bevat koppelingen naar DFSR-naslagartikelen en blogberichten.</span><span class="sxs-lookup"><span data-stu-id="b110a-356">The following table provides links to DFSR reference articles and blog posts.</span></span>
  
<span data-ttu-id="b110a-357">**Tabel: Naslagartikelen voor DFSR**</span><span class="sxs-lookup"><span data-stu-id="b110a-357">**Table: Reference articles for DFSR**</span></span>

|<span data-ttu-id="b110a-358">**Title**</span><span class="sxs-lookup"><span data-stu-id="b110a-358">**Title**</span></span>|<span data-ttu-id="b110a-359">**Beschrijving**</span><span class="sxs-lookup"><span data-stu-id="b110a-359">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b110a-360">[Replicatie](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770278(v=ws.11))</span><span class="sxs-lookup"><span data-stu-id="b110a-360">[Replication](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770278(v=ws.11))</span></span> <br/> |<span data-ttu-id="b110a-361">DFS Management TechNet-onderwerp met koppelingen voor replicatie</span><span class="sxs-lookup"><span data-stu-id="b110a-361">DFS Management TechNet topic with links for replication</span></span>  <br/> |
|[<span data-ttu-id="b110a-362">DFS-replicatie: survivalhandleiding</span><span class="sxs-lookup"><span data-stu-id="b110a-362">DFS Replication: Survival Guide</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=392737) <br/> |<span data-ttu-id="b110a-363">Wiki met koppelingen naar DFS-informatie</span><span class="sxs-lookup"><span data-stu-id="b110a-363">Wiki with links to DFS information</span></span>  <br/> |
|<span data-ttu-id="b110a-364">[DFS-replicatie: veelgestelde vragen](/previous-versions/windows/it-pro/windows-server-2003/cc773238(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="b110a-364">[DFS Replication: Frequently Asked Questions](/previous-versions/windows/it-pro/windows-server-2003/cc773238(v=ws.10))</span></span> <br/> |<span data-ttu-id="b110a-365">Onderwerp DFS-replicatie TechNet</span><span class="sxs-lookup"><span data-stu-id="b110a-365">DFS Replication TechNet topic</span></span>  <br/> |
|[<span data-ttu-id="b110a-366">Blog van Jose Barreto</span><span class="sxs-lookup"><span data-stu-id="b110a-366">Jose Barreto's Blog</span></span>](/archive/blogs/josebda/) <br/> |<span data-ttu-id="b110a-367">Blog geschreven door een Principal Program Manager in het File Server-team bij Microsoft</span><span class="sxs-lookup"><span data-stu-id="b110a-367">Blog written by a Principal Program Manager on the File Server team at Microsoft</span></span>  <br/> |
|[<span data-ttu-id="b110a-368">The Storage Team bij Microsoft - File Cabinet Blog</span><span class="sxs-lookup"><span data-stu-id="b110a-368">The Storage Team at Microsoft - File Cabinet Blog</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=392740) <br/> |<span data-ttu-id="b110a-369">Blog over bestandsservices en opslagfuncties in Windows Server</span><span class="sxs-lookup"><span data-stu-id="b110a-369">Blog about file services and storage features in Windows Server</span></span>  <br/> |
   
## <a name="phase-6-set-up-log-shipping-to-the-recovery-farm"></a><span data-ttu-id="b110a-370">Fase 6: Logboekzending instellen voor de herstelfarm</span><span class="sxs-lookup"><span data-stu-id="b110a-370">Phase 6: Set up log shipping to the recovery farm</span></span>

<span data-ttu-id="b110a-371">Logboekzending is het kritieke onderdeel voor het instellen van herstel na noodherstel in deze omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-371">Log shipping is the critical component for setting up disaster recovery in this environment.</span></span> <span data-ttu-id="b110a-372">U kunt logboekverzending gebruiken om automatisch transactielogboekbestanden voor databases van een primaire databaseserver-exemplaar naar een secundaire databaseserver-exemplaar te verzenden.</span><span class="sxs-lookup"><span data-stu-id="b110a-372">You can use log shipping to automatically send transaction log files for databases from a primary database server instance to a secondary database server instance.</span></span> <span data-ttu-id="b110a-373">Zie Logboekzending configureren [in SharePoint 2013](/sharepoint/administration/configure-log-shipping)als u logboekzending wilt instellen.</span><span class="sxs-lookup"><span data-stu-id="b110a-373">To set up log shipping, see [Configure log shipping in SharePoint 2013](/sharepoint/administration/configure-log-shipping).</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="b110a-374">Ondersteuning voor het verzenden van logboeken in SharePoint Server is beperkt tot bepaalde databases.</span><span class="sxs-lookup"><span data-stu-id="b110a-374">Log shipping support in SharePoint Server is limited to certain databases.</span></span> <span data-ttu-id="b110a-375">Zie Ondersteunde opties voor hoge beschikbaarheid en herstel na noodherstel [voor SharePoint-databases (SharePoint 2013)](/SharePoint/administration/supported-high-availability-and-disaster-recovery-options-for-sharepoint-databas)voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-375">For more information, see [Supported high availability and disaster recovery options for SharePoint databases (SharePoint 2013)](/SharePoint/administration/supported-high-availability-and-disaster-recovery-options-for-sharepoint-databas).</span></span> 
  
## <a name="phase-7-validate-failover-and-recovery"></a><span data-ttu-id="b110a-376">Fase 7: Failover en herstel valideren</span><span class="sxs-lookup"><span data-stu-id="b110a-376">Phase 7: Validate failover and recovery</span></span>

<span data-ttu-id="b110a-377">Het doel van deze laatste fase is om te controleren of de oplossing voor noodherstel werkt zoals gepland.</span><span class="sxs-lookup"><span data-stu-id="b110a-377">The goal of this final phase is to verify that the disaster recovery solution works as planned.</span></span> <span data-ttu-id="b110a-378">Maak hiervoor een failovergebeurtenis die de productiefarm sluit en de herstelfarm start als vervanging.</span><span class="sxs-lookup"><span data-stu-id="b110a-378">To do this, create a failover event that shuts down the production farm and starts up the recovery farm as a replacement.</span></span> <span data-ttu-id="b110a-379">U kunt handmatig een failover-scenario starten of scripts gebruiken.</span><span class="sxs-lookup"><span data-stu-id="b110a-379">You can start a failover scenario manually or by using scripts.</span></span>
  
<span data-ttu-id="b110a-380">De eerste stap is het stoppen van inkomende gebruikersaanvragen voor farmservices of -inhoud.</span><span class="sxs-lookup"><span data-stu-id="b110a-380">The first step is to stop incoming user requests for farm services or content.</span></span> <span data-ttu-id="b110a-381">U kunt dit doen door DNS-vermeldingen uit te sluiten of door de front-endwebservers af te sluiten.</span><span class="sxs-lookup"><span data-stu-id="b110a-381">You can do this by disabling DNS entries or by shutting down the front-end web servers.</span></span> <span data-ttu-id="b110a-382">Nadat de farm 'down' is, kunt u niet naar de herstelfarm gaan.</span><span class="sxs-lookup"><span data-stu-id="b110a-382">After the farm is "down," you can fail over to the recovery farm.</span></span>
  
### <a name="stop-log-shipping"></a><span data-ttu-id="b110a-383">Het verzenden van logboeken stoppen</span><span class="sxs-lookup"><span data-stu-id="b110a-383">Stop log shipping</span></span>

<span data-ttu-id="b110a-384">U moet de verzending van logboeken stoppen voordat u de farm herstelt.</span><span class="sxs-lookup"><span data-stu-id="b110a-384">You must stop log shipping before farm recovery.</span></span> <span data-ttu-id="b110a-385">Stop eerst de logboekverzending op de secundaire server in Azure en stop deze vervolgens op de on-premises primaire server.</span><span class="sxs-lookup"><span data-stu-id="b110a-385">Stop log shipping on the secondary server in Azure first, and then stop it on the primary server on-premises.</span></span> <span data-ttu-id="b110a-386">Gebruik het volgende script om eerst de logboekverzending op de secundaire server te stoppen en vervolgens op de primaire server.</span><span class="sxs-lookup"><span data-stu-id="b110a-386">Use the following script to stop log shipping on the secondary server first and then on the primary server.</span></span> <span data-ttu-id="b110a-387">De databasenamen in het script kunnen verschillen, afhankelijk van uw omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-387">The database names in the script might be different, depending on your environment.</span></span>
  
```
-- This script removes log shipping from the server.
-- Commands must be executed on the secondary server first and then on the primary server.

SET NOCOUNT ON
DECLARE  @PriDB nvarchar(max)
,@SecDB nvarchar(250)
,@PriSrv nvarchar(250)
,@SecSrv nvarchar(250)

Set @PriDB= ''
SET @PriDB = UPPER(@PriDB)
SET @PriDB = REPLACE(@PriDB, ' ', '')
SET @PriDB = '''' + REPLACE(@PriDB, ',', ''', ''') + ''''

Set @SecDB = @PriDB

Exec ( 'Select  ''exec master..sp_delete_log_shipping_secondary_database '' + '''''''' + prm.primary_database +  ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

Exec ( 'Select  ''exec master..sp_delete_log_shipping_primary_secondary '' + '''''''' + prm.Primary_Database + '''''', '''''' + sec.Secondary_Server + '''''', '''''' + sec.Secondary_database + ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

Exec ( 'Select  ''exec master..sp_delete_log_shipping_primary_database '' + '''''''' + prm.primary_database +  ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

Exec ( 'Select  ''exec master..sp_delete_log_shipping_secondary_primary '' + '''''''' + prm.primary_server + '''''', '''''' + prm.primary_database +  ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

```

### <a name="restore-the-backups"></a><span data-ttu-id="b110a-388">Back-ups herstellen</span><span class="sxs-lookup"><span data-stu-id="b110a-388">Restore the backups</span></span>

<span data-ttu-id="b110a-389">Back-ups moeten worden hersteld in de volgorde waarin ze zijn gemaakt.</span><span class="sxs-lookup"><span data-stu-id="b110a-389">Backups must be restored in the order in which they were created.</span></span> <span data-ttu-id="b110a-390">Voordat u een bepaalde back-up van een transactielogboek kunt herstellen, moet u eerst de volgende eerdere back-ups herstellen zonder niet-gecomprimeerd transacties terug te draaien (dat wil zeggen met behulp van  `WITH NORECOVERY` ):</span><span class="sxs-lookup"><span data-stu-id="b110a-390">Before you can restore a particular transaction log backup, you must first restore the following previous backups without rolling back uncommitted transactions (that is, by using  `WITH NORECOVERY`):</span></span>
  
- <span data-ttu-id="b110a-391">De volledige databaseback-up en de laatste differentiële back-up: herstel deze back-ups, indien aanwezig, die vóór de specifieke back-up van het transactielogboek zijn gemaakt.</span><span class="sxs-lookup"><span data-stu-id="b110a-391">The full database backup and the last differential backup - Restore these backups, if any exist, taken before the particular transaction log backup.</span></span> <span data-ttu-id="b110a-392">Voordat de meest recente volledige of differentiële databaseback-up werd gemaakt, gebruikte de database het volledige herstelmodel of bulksgewijs vastgelegde herstelmodel.</span><span class="sxs-lookup"><span data-stu-id="b110a-392">Before the most recent full or differential database backup was created, the database was using the full recovery model or bulk-logged recovery model.</span></span>
    
- <span data-ttu-id="b110a-393">Alle back-ups van het transactielogboek: herstel eventuele back-ups van het transactielogboek die zijn gemaakt na de volledige databaseback-up of de differentiële back-up (als u er een herstelt) en vóór de specifieke back-up van het transactielogboek.</span><span class="sxs-lookup"><span data-stu-id="b110a-393">All transaction log backups - Restore any transaction log backups taken after the full database backup or the differential backup (if you restore one) and before the particular transaction log backup.</span></span> <span data-ttu-id="b110a-394">Logboekback-ups moeten worden toegepast in de volgorde waarin ze zijn gemaakt, zonder hiaten in de logboekketen.</span><span class="sxs-lookup"><span data-stu-id="b110a-394">Log backups must be applied in the sequence in which they were created, without any gaps in the log chain.</span></span>
    
<span data-ttu-id="b110a-395">Als u de inhoudsdatabase op de secundaire server wilt herstellen zodat de sites worden weergegeven, verwijdert u alle databaseverbindingen vóór herstel.</span><span class="sxs-lookup"><span data-stu-id="b110a-395">To recover the content database on the secondary server so that the sites render, remove all database connections before recovery.</span></span> <span data-ttu-id="b110a-396">Voer de volgende SQL-instructie uit om de database te herstellen.</span><span class="sxs-lookup"><span data-stu-id="b110a-396">To restore the database, run the following SQL statement.</span></span>
  
```
restore database WSS_Content with recovery

```

> [!IMPORTANT]
> <span data-ttu-id="b110a-397">Wanneer u T-SQL expliciet gebruikt, geeft u IN **GEENHERSTEL OF** **MET HERSTEL** op in elke RESTORE-instructie om dubbelzinnigheid te voorkomen. Dit is erg belangrijk bij het schrijven van scripts.</span><span class="sxs-lookup"><span data-stu-id="b110a-397">When you use T-SQL explicitly, specify either **WITH NORECOVERY** or **WITH RECOVERY** in every RESTORE statement to eliminate ambiguity—this is very important when writing scripts.</span></span> <span data-ttu-id="b110a-398">Nadat de volledige en differentiële back-ups zijn hersteld, kunnen de transactielogboeken worden hersteld in SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="b110a-398">After the full and differential backups are restored, the transaction logs can be restored in SQL Server Management Studio.</span></span> <span data-ttu-id="b110a-399">Omdat het verzenden van logboeken al is gestopt, bevindt de inhoudsdatabase zich in de stand-bystand, dus moet u de status wijzigen in volledige toegang.</span><span class="sxs-lookup"><span data-stu-id="b110a-399">Also, because log shipping is already stopped, the content database is in a standby state, so you must change the state to full access.</span></span>
  
<span data-ttu-id="b110a-400">Klik in SQL Server Management Studio met de rechtermuisknop op de **WSS_Content-database,** wijs Taken herstellen aan en klik vervolgens op Transactielogboek (als u de volledige back-up niet hebt hersteld, is dit niet  >  beschikbaar). </span><span class="sxs-lookup"><span data-stu-id="b110a-400">In SQL Server Management Studio, right-click the **WSS_Content** database, point to **Tasks** > **Restore**, and then click **Transaction Log** (if you have not restored the full backup, this is not available).</span></span> <span data-ttu-id="b110a-401">Zie Een[Sql Server (Transaction Log Backup) herstellen voor meer informatie.](/sql/relational-databases/backup-restore/restore-a-transaction-log-backup-sql-server)</span><span class="sxs-lookup"><span data-stu-id="b110a-401">For more information, see[Restore a Transaction Log Backup (SQL Server)](/sql/relational-databases/backup-restore/restore-a-transaction-log-backup-sql-server).</span></span>
  
### <a name="crawl-the-content-source"></a><span data-ttu-id="b110a-402">De inhoudsbron crawlen</span><span class="sxs-lookup"><span data-stu-id="b110a-402">Crawl the content source</span></span>

<span data-ttu-id="b110a-403">U moet een volledige verkenning voor elke inhoudsbron starten om de zoekservice te herstellen.</span><span class="sxs-lookup"><span data-stu-id="b110a-403">You must start a full crawl for each content source to restore the Search Service.</span></span> <span data-ttu-id="b110a-404">Houd er rekening mee dat u bepaalde analysegegevens van de on-premises farm kwijt bent, zoals zoekaanbevelingen.</span><span class="sxs-lookup"><span data-stu-id="b110a-404">Note that you lose some analytics information from the on-premises farm, such as search recommendations.</span></span> <span data-ttu-id="b110a-405">Voordat u de volledige verkenningen start, gebruikt u de Windows PowerShell-cmdlet **Restore-SPEnterpriseSearchServiceApplication** en geeft u de database voor logboekverhuur en gerepliceerd zoekbeheer **op, Search_Service__DB_. <GUID>**</span><span class="sxs-lookup"><span data-stu-id="b110a-405">Before you start the full crawls, use the Windows PowerShell cmdlet **Restore-SPEnterpriseSearchServiceApplication** and specify the log-shipped and replicated Search Administration database, **Search_Service__DB_<GUID>**.</span></span> <span data-ttu-id="b110a-406">Deze cmdlet bevat de zoekconfiguratie, het schema, beheerde eigenschappen, regels en bronnen en maakt een standaardset van de andere onderdelen.</span><span class="sxs-lookup"><span data-stu-id="b110a-406">This cmdlet gives the search configuration, schema, managed properties, rules, and sources and creates a default set of the other components.</span></span>
  
<span data-ttu-id="b110a-407">Als u een volledige verkenning wilt starten, gaat u als volgt te werk:</span><span class="sxs-lookup"><span data-stu-id="b110a-407">To start a full crawl, complete the following steps:</span></span>
  
1. <span data-ttu-id="b110a-408">Ga in centraal beheer van SharePoint 2013 naar **Application Management** Service Applications Manage service applications en klik vervolgens op de zoekservicetoepassing die  >    >  u wilt crawlen.</span><span class="sxs-lookup"><span data-stu-id="b110a-408">In the SharePoint 2013 Central Administration, go to **Application Management** > **Service Applications** > **Manage service applications**, and then click the Search Service application that you want to crawl.</span></span>
    
2. <span data-ttu-id="b110a-409">Klik op **de pagina Zoekbeheer** op **Inhoudsbronnen,** wijs de gezochte inhoudsbron aan, klik op de pijl en klik vervolgens op Volledige verkenning **starten.**</span><span class="sxs-lookup"><span data-stu-id="b110a-409">On the **Search Administration** page, click **Content Sources**, point to the content source that you want, click the arrow, and then click **Start Full Crawl**.</span></span>
    
### <a name="recover-farm-services"></a><span data-ttu-id="b110a-410">Farmservices herstellen</span><span class="sxs-lookup"><span data-stu-id="b110a-410">Recover farm services</span></span>

<span data-ttu-id="b110a-411">In de volgende tabel ziet u hoe u services kunt herstellen die zijn verzonden met logboekdatabases, de services die databases bevatten, maar niet worden aanbevolen om te herstellen met logboekverzending en de services die geen databases hebben.</span><span class="sxs-lookup"><span data-stu-id="b110a-411">The following table shows how to recover services that have log-shipped databases, the services that have databases but are not recommended to restore with log shipping, and the services that do not have databases.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="b110a-412">Als u een on-premises SharePoint-database herstelt in de Azure-omgeving, worden sharePoint-services die u nog niet handmatig in Azure hebt geïnstalleerd, niet hersteld.</span><span class="sxs-lookup"><span data-stu-id="b110a-412">Restoring an on-premises SharePoint database into the Azure environment will not recover any SharePoint services that you did not already install in Azure manually.</span></span> 
  
<span data-ttu-id="b110a-413">**Tabel: Databaseverwijzing servicetoepassing**</span><span class="sxs-lookup"><span data-stu-id="b110a-413">**Table: Service application database reference**</span></span>

|<span data-ttu-id="b110a-414">**Deze services herstellen uit databases met logboeken**</span><span class="sxs-lookup"><span data-stu-id="b110a-414">**Restore these services from log-shipped databases**</span></span>|<span data-ttu-id="b110a-415">**Deze services hebben databases, maar we raden u aan deze services te starten zonder hun databases te herstellen**</span><span class="sxs-lookup"><span data-stu-id="b110a-415">**These services have databases, but we recommend that you start these services without restoring their databases**</span></span>|<span data-ttu-id="b110a-416">**Deze services slaan geen gegevens op in databases. deze services starten na failover**</span><span class="sxs-lookup"><span data-stu-id="b110a-416">**These services do not store data in databases; start these services after failover**</span></span>|
|:-----|:-----|:-----|
| <span data-ttu-id="b110a-417">MachineVertalingsservice</span><span class="sxs-lookup"><span data-stu-id="b110a-417">Machine Translation Service</span></span> <br/>  <span data-ttu-id="b110a-418">Beheerde metagegevensservice</span><span class="sxs-lookup"><span data-stu-id="b110a-418">Managed Metadata Service</span></span> <br/>  <span data-ttu-id="b110a-419">Secure Store-service</span><span class="sxs-lookup"><span data-stu-id="b110a-419">Secure Store Service</span></span> <br/>  <span data-ttu-id="b110a-420">Gebruikersprofiel.</span><span class="sxs-lookup"><span data-stu-id="b110a-420">User Profile.</span></span> <span data-ttu-id="b110a-421">(Alleen de databases Profiel en Sociaal labelen worden ondersteund.</span><span class="sxs-lookup"><span data-stu-id="b110a-421">(Only the Profile and Social Tagging databases are supported.</span></span> <span data-ttu-id="b110a-422">De synchronisatiedatabase wordt niet ondersteund.)</span><span class="sxs-lookup"><span data-stu-id="b110a-422">The Synchronization database is not supported.)</span></span> <br/>  <span data-ttu-id="b110a-423">Microsoft SharePoint Foundation Subscription Settings Service</span><span class="sxs-lookup"><span data-stu-id="b110a-423">Microsoft SharePoint Foundation Subscription Settings Service</span></span> <br/> | <span data-ttu-id="b110a-424">Gegevensverzameling gebruik en status</span><span class="sxs-lookup"><span data-stu-id="b110a-424">Usage and Health Data Collection</span></span> <br/>  <span data-ttu-id="b110a-425">State service</span><span class="sxs-lookup"><span data-stu-id="b110a-425">State service</span></span> <br/>  <span data-ttu-id="b110a-426">Word-automatisering</span><span class="sxs-lookup"><span data-stu-id="b110a-426">Word automation</span></span> <br/> | <span data-ttu-id="b110a-427">Excel Services</span><span class="sxs-lookup"><span data-stu-id="b110a-427">Excel Services</span></span> <br/>  <span data-ttu-id="b110a-428">PerformancePoint Services</span><span class="sxs-lookup"><span data-stu-id="b110a-428">PerformancePoint Services</span></span> <br/>  <span data-ttu-id="b110a-429">PowerPoint-conversie</span><span class="sxs-lookup"><span data-stu-id="b110a-429">PowerPoint Conversion</span></span> <br/>  <span data-ttu-id="b110a-430">Visio Graphics Service</span><span class="sxs-lookup"><span data-stu-id="b110a-430">Visio Graphics Service</span></span> <br/>  <span data-ttu-id="b110a-431">Werkbeheer</span><span class="sxs-lookup"><span data-stu-id="b110a-431">Work Management</span></span> <br/> |
   
<span data-ttu-id="b110a-432">In het volgende voorbeeld ziet u hoe u de service Beheerde metagegevens uit een database kunt herstellen.</span><span class="sxs-lookup"><span data-stu-id="b110a-432">The following example shows how to restore the Managed Metadata service from a database.</span></span>
  
<span data-ttu-id="b110a-433">Hiervoor wordt de bestaande Managed_Metadata_DB database gebruikt.</span><span class="sxs-lookup"><span data-stu-id="b110a-433">This uses the existing Managed_Metadata_DB database.</span></span> <span data-ttu-id="b110a-434">Deze database is logboek verzonden, maar er is geen actieve servicetoepassing op de secundaire farm, dus deze moet worden verbonden nadat de servicetoepassing is gemaakt.</span><span class="sxs-lookup"><span data-stu-id="b110a-434">This database is log shipped, but there is no active service application on the secondary farm, so it needs to be connected after the service application is in place.</span></span>
  
<span data-ttu-id="b110a-435">Gebruik eerst de schakelknop en geef de naam van de  `New-SPMetadataServiceApplication`  `DatabaseName` herstelde database op.</span><span class="sxs-lookup"><span data-stu-id="b110a-435">First, use  `New-SPMetadataServiceApplication`, and specify the  `DatabaseName` switch with the name of the restored database.</span></span>
  
<span data-ttu-id="b110a-436">Configureer vervolgens de nieuwe servicetoepassing voor beheerde metagegevens op de secundaire server als volgt:</span><span class="sxs-lookup"><span data-stu-id="b110a-436">Next, configure the new Managed Metadata Service Application on the secondary server, as follows:</span></span>
  
- <span data-ttu-id="b110a-437">Naam: Beheerde metagegevensservice</span><span class="sxs-lookup"><span data-stu-id="b110a-437">Name: Managed Metadata Service</span></span>
    
- <span data-ttu-id="b110a-438">Databaseserver: de databasenaam uit het verzonden transactielogboek</span><span class="sxs-lookup"><span data-stu-id="b110a-438">Database server: The database name from the shipped transaction log</span></span>
    
- <span data-ttu-id="b110a-439">Databasenaam: Managed_Metadata_DB</span><span class="sxs-lookup"><span data-stu-id="b110a-439">Database name: Managed_Metadata_DB</span></span>
    
- <span data-ttu-id="b110a-440">Toepassingsgroep: SharePoint-servicetoepassingen</span><span class="sxs-lookup"><span data-stu-id="b110a-440">Application pool: SharePoint Service Applications</span></span> 
    
### <a name="manage-dns-records"></a><span data-ttu-id="b110a-441">DNS-records beheren</span><span class="sxs-lookup"><span data-stu-id="b110a-441">Manage DNS records</span></span>

<span data-ttu-id="b110a-442">U moet handmatig DNS-records maken om naar uw SharePoint-farm te wijzen.</span><span class="sxs-lookup"><span data-stu-id="b110a-442">You must manually create DNS records to point to your SharePoint farm.</span></span>
  
<span data-ttu-id="b110a-443">In de meeste gevallen waarin u meerdere front-endwebservers hebt, is het zinvol om te profiteren van de functie Netwerkbelasting balanceren in Windows Server 2012 of een hardware load balancer om aanvragen te distribueren tussen de web-front-endservers in uw farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-443">In most cases where you have multiple front-end web servers, it makes sense to take advantage of the Network Load Balancing feature in Windows Server 2012 or a hardware load balancer to distribute requests among the web-front-end servers in your farm.</span></span> <span data-ttu-id="b110a-444">Netwerkbelastingsverdeling kan ook de risico's verminderen door aanvragen te distribueren naar de andere servers als een van uw web-front-endservers mislukt.</span><span class="sxs-lookup"><span data-stu-id="b110a-444">Network load balancing can also help reduce risk by distributing requests to the other servers if one of your web-front-end servers fails.</span></span> 
  
<span data-ttu-id="b110a-445">Wanneer u netwerkladingsverdeling instelt, krijgt uw cluster meestal één IP-adres toegewezen.</span><span class="sxs-lookup"><span data-stu-id="b110a-445">Typically, when you set up network load balancing, your cluster is assigned a single IP address.</span></span> <span data-ttu-id="b110a-446">Vervolgens maakt u een DNS-hostrecord in de DNS-provider voor uw netwerk die naar het cluster wijst.</span><span class="sxs-lookup"><span data-stu-id="b110a-446">You then create a DNS host record in the DNS provider for your network that points to the cluster.</span></span> <span data-ttu-id="b110a-447">(Voor dit project hebben we een DNS-server in Azure gezet voor tolerantie in geval van een on-premises datacenterfout.) U kunt bijvoorbeeld een DNS-record maken, in DNS Manager in Active Directory, bijvoorbeeld , die naar het IP-adres voor uw geladen  `https://sharepoint.contoso.com` cluster wijst.</span><span class="sxs-lookup"><span data-stu-id="b110a-447">(For this project, we put a DNS server in Azure for resiliency in case of an on-premises datacenter failure.) For instance, you can create a DNS record, in DNS Manager in Active Directory, for example, called  `https://sharepoint.contoso.com`, that points to the IP address for your load-balanced cluster.</span></span>
  
<span data-ttu-id="b110a-448">Voor externe toegang tot uw SharePoint-farm kunt u een hostrecord maken op een externe DNS-server met dezelfde URL die clients op uw intranet gebruiken (bijvoorbeeld) die naar een extern IP-adres in uw `https://sharepoint.contoso.com` firewall wijst.</span><span class="sxs-lookup"><span data-stu-id="b110a-448">For external access to your SharePoint farm, you can create a host record on an external DNS server with the same URL that clients use on your intranet (for example, `https://sharepoint.contoso.com`) that points to an external IP address in your firewall.</span></span> <span data-ttu-id="b110a-449">(In dit voorbeeld is het een goede gewoonte om gesplitste DNS zo in te stellen dat de interne DNS-server gezaghebbend is voor en aanvragen rechtstreeks naar het SharePoint-farmcluster routert, in plaats van DNS-aanvragen naar uw externe `contoso.com` DNS-server te routeren.) Vervolgens kunt u het externe IP-adres in kaart brengen aan het interne IP-adres van uw on-premises cluster, zodat clients de resources vinden die ze zoeken.</span><span class="sxs-lookup"><span data-stu-id="b110a-449">(A best practice, using this example, is to set up split DNS so that the internal DNS server is authoritative for `contoso.com` and routes requests directly to the SharePoint farm cluster, rather than routing DNS requests to your external DNS server.) You can then map the external IP address to the internal IP address of your on-premises cluster so that clients find the resources they are looking for.</span></span>
  
<span data-ttu-id="b110a-450">Hier ziet u mogelijk een aantal verschillende scenario's voor het herstel van rampen:</span><span class="sxs-lookup"><span data-stu-id="b110a-450">From here, you might run into a couple of different disaster-recovery scenarios:</span></span>
  
 <span data-ttu-id="b110a-451">**Voorbeeldscenario: De on-premises SharePoint-farm is niet beschikbaar vanwege een hardwarefout in de on-premises SharePoint-farm.**</span><span class="sxs-lookup"><span data-stu-id="b110a-451">**Example scenario: The on-premises SharePoint farm is unavailable because of hardware failure in the on-premises SharePoint farm.**</span></span> <span data-ttu-id="b110a-452">In dit geval kunt u, nadat u de stappen voor failover naar de Azure SharePoint-farm hebt voltooid, de netwerkbelastingsverdeling configureren op de web-front-endservers van de SharePoint-farm, net zoals u dat deed met de on-premises farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-452">In this case, after you have completed the steps for failover to the Azure SharePoint farm, you can configure network load balancing on the recovery SharePoint farm's web-front-end servers, the same way you did with the on-premises farm.</span></span> <span data-ttu-id="b110a-453">Vervolgens kunt u de hostrecord in uw interne DNS-provider omleiden om het IP-adres van de herstelfarm aan te wijzen.</span><span class="sxs-lookup"><span data-stu-id="b110a-453">You can then redirect the host record in your internal DNS provider to point to the recovery farm's cluster IP address.</span></span> <span data-ttu-id="b110a-454">Houd er rekening mee dat het enige tijd kan duren voordat DNS-records in de cache op clients worden vernieuwd en de herstelfarm worden aanwijzer.</span><span class="sxs-lookup"><span data-stu-id="b110a-454">Note that it can take some time before cached DNS records on clients are refreshed and point to the recovery farm.</span></span>
  
 <span data-ttu-id="b110a-455">**Voorbeeldscenario: Het on-premises datacenter gaat volledig verloren.**</span><span class="sxs-lookup"><span data-stu-id="b110a-455">**Example scenario: The on-premises datacenter is lost completely.**</span></span> <span data-ttu-id="b110a-456">Dit scenario kan optreden als gevolg van een natuurramp, zoals een brand of een vloedgolf.</span><span class="sxs-lookup"><span data-stu-id="b110a-456">This scenario might occur due to a natural disaster, such as a fire or flood.</span></span> <span data-ttu-id="b110a-457">In dit geval wordt voor een onderneming waarschijnlijk een secundair datacenter gehost in een andere regio, evenals uw Azure-subnet met eigen adreslijstservices en DNS.</span><span class="sxs-lookup"><span data-stu-id="b110a-457">In this case, for an enterprise, you would likely have a secondary datacenter hosted in another region as well as your Azure subnet that has its own directory services and DNS.</span></span> <span data-ttu-id="b110a-458">Net als in het vorige rampscenario kunt u uw interne en externe DNS-records omleiden om te wijzen naar de Azure SharePoint-farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-458">As in the previous disaster scenario, you can redirect your internal and external DNS records to point to the Azure SharePoint farm.</span></span> <span data-ttu-id="b110a-459">Houd er nogmaals rekening mee dat het doorgeven van DNS-records enige tijd kan duren.</span><span class="sxs-lookup"><span data-stu-id="b110a-459">Again, take note that DNS-record propagation can take some time.</span></span>
  
<span data-ttu-id="b110a-460">Als u siteverzamelingen met een hostnaam gebruikt, zoals aanbevolen in de architectuur en implementatie van de hostsiteverzameling [(SharePoint 2013),](/SharePoint/administration/host-named-site-collection-architecture-and-deployment)kunt u verschillende siteverzamelingen hosten die worden gehost door dezelfde webtoepassing in uw SharePoint-farm, met unieke DNS-namen (bijvoorbeeld en `https://sales.contoso.com` `https://marketing.contoso.com` ).</span><span class="sxs-lookup"><span data-stu-id="b110a-460">If you are using host-named site collections, as recommended in [Host-named site collection architecture and deployment (SharePoint 2013)](/SharePoint/administration/host-named-site-collection-architecture-and-deployment), you might have several site collections hosted by the same web application in your SharePoint farm, with unique DNS names (for example, `https://sales.contoso.com` and `https://marketing.contoso.com`).</span></span> <span data-ttu-id="b110a-461">In dit geval kunt u DNS-records maken voor elke siteverzameling die naar uw CLUSTER-IP-adres wijzen.</span><span class="sxs-lookup"><span data-stu-id="b110a-461">In this case, you can create DNS records for each site collection that point to your cluster IP address.</span></span> <span data-ttu-id="b110a-462">Nadat een aanvraag uw SharePoint-web-front-endservers heeft bereikt, verwerken ze het routeren van elke aanvraag naar de juiste siteverzameling.</span><span class="sxs-lookup"><span data-stu-id="b110a-462">After a request reaches your SharePoint web-front-end servers, they handle routing each request to the appropriate site collection.</span></span>
  
## <a name="microsoft-proof-of-concept-environment"></a><span data-ttu-id="b110a-463">Microsoft proof-of-concept-omgeving</span><span class="sxs-lookup"><span data-stu-id="b110a-463">Microsoft proof-of-concept environment</span></span>

<span data-ttu-id="b110a-464">We hebben voor deze oplossing een proof-of-concept-omgeving ontworpen en getest.</span><span class="sxs-lookup"><span data-stu-id="b110a-464">We designed and tested a proof-of-concept environment for this solution.</span></span> <span data-ttu-id="b110a-465">Het ontwerpdoel voor onze testomgeving was het implementeren en herstellen van een SharePoint-farm die we mogelijk vinden in een klantomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-465">The design goal for our test environment was to deploy and recover a SharePoint farm that we might find in a customer environment.</span></span> <span data-ttu-id="b110a-466">We hebben verschillende aannames gedaan, maar we wisten dat de farm alle functionaliteit van de out-of-the-box moest leveren zonder aanpassingen.</span><span class="sxs-lookup"><span data-stu-id="b110a-466">We made several assumptions, but we knew that the farm needed to provide all of the out-of-the-box functionality without any customizations.</span></span> <span data-ttu-id="b110a-467">De topologie is ontworpen voor hoge beschikbaarheid met behulp van richtlijnen voor best practice van de veld- en productgroep.</span><span class="sxs-lookup"><span data-stu-id="b110a-467">The topology was designed for high availability by using best practice guidance from the field and product group.</span></span>
  
<span data-ttu-id="b110a-468">In de volgende tabel worden de virtuele Hyper-V-machines beschreven die we hebben gemaakt en geconfigureerd voor de on-premises testomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-468">The following table describes the Hyper-V virtual machines that we created and configured for the on-premises test environment.</span></span>
  
<span data-ttu-id="b110a-469">**Tabel: Virtuele machines voor on-premises test**</span><span class="sxs-lookup"><span data-stu-id="b110a-469">**Table: Virtual machines for on-premises test**</span></span>

|<span data-ttu-id="b110a-470">**Servernaam**</span><span class="sxs-lookup"><span data-stu-id="b110a-470">**Server name**</span></span>|<span data-ttu-id="b110a-471">**Rol**</span><span class="sxs-lookup"><span data-stu-id="b110a-471">**Role**</span></span>|<span data-ttu-id="b110a-472">**Configuratie**</span><span class="sxs-lookup"><span data-stu-id="b110a-472">**Configuration**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b110a-473">DC1</span><span class="sxs-lookup"><span data-stu-id="b110a-473">DC1</span></span>  <br/> |<span data-ttu-id="b110a-474">Domeincontroller met Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b110a-474">Domain controller with Active Directory.</span></span>  <br/> |<span data-ttu-id="b110a-475">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-475">Two processors</span></span>  <br/> <span data-ttu-id="b110a-476">Van 512 MB tot 4 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-476">From 512 MB through 4 GB of RAM</span></span>  <br/> <span data-ttu-id="b110a-477">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-477">1 x 127-GB hard disk</span></span>  <br/> |
|<span data-ttu-id="b110a-478">RRAS</span><span class="sxs-lookup"><span data-stu-id="b110a-478">RRAS</span></span>  <br/> |<span data-ttu-id="b110a-479">Server die is geconfigureerd met de RRAS-rol (Routing and Remote Access Service).</span><span class="sxs-lookup"><span data-stu-id="b110a-479">Server configured with the Routing and Remote Access Service (RRAS) role.</span></span>  <br/> |<span data-ttu-id="b110a-480">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-480">Two processors</span></span>  <br/> <span data-ttu-id="b110a-481">2-8 GB RAM-GEHEUGEN</span><span class="sxs-lookup"><span data-stu-id="b110a-481">2-8 GB of RAM</span></span>  <br/> <span data-ttu-id="b110a-482">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-482">1 x 127-GB hard disk</span></span>  <br/> |
|<span data-ttu-id="b110a-483">FS1</span><span class="sxs-lookup"><span data-stu-id="b110a-483">FS1</span></span>  <br/> |<span data-ttu-id="b110a-484">Bestandsserver met aandelen voor back-ups en een eindpunt voor DFSR.</span><span class="sxs-lookup"><span data-stu-id="b110a-484">File server with shares for backups and an end point for DFSR.</span></span>  <br/> |<span data-ttu-id="b110a-485">Vier processors</span><span class="sxs-lookup"><span data-stu-id="b110a-485">Four processors</span></span>  <br/> <span data-ttu-id="b110a-486">2-12 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-486">2-12 GB of RAM</span></span>  <br/> <span data-ttu-id="b110a-487">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-487">1 x 127-GB hard disk</span></span>  <br/> <span data-ttu-id="b110a-488">1 x 1 TB harde schijf (SAN)</span><span class="sxs-lookup"><span data-stu-id="b110a-488">1 x 1-TB hard disk (SAN)</span></span>  <br/> <span data-ttu-id="b110a-489">Harde schijf van 1 x 750 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-489">1 x 750-GB hard disk</span></span>  <br/> |
|<span data-ttu-id="b110a-490">SP-WFE1, SP-WFE2</span><span class="sxs-lookup"><span data-stu-id="b110a-490">SP-WFE1, SP-WFE2</span></span>  <br/> |<span data-ttu-id="b110a-491">Front-endwebservers.</span><span class="sxs-lookup"><span data-stu-id="b110a-491">Front-end web servers.</span></span>  <br/> |<span data-ttu-id="b110a-492">Vier processors</span><span class="sxs-lookup"><span data-stu-id="b110a-492">Four processors</span></span>  <br/> <span data-ttu-id="b110a-493">16 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-493">16 GB of RAM</span></span>  <br/> |
|<span data-ttu-id="b110a-494">SP-APP1, SP-APP2, SP-APP3</span><span class="sxs-lookup"><span data-stu-id="b110a-494">SP-APP1, SP-APP2, SP-APP3</span></span>  <br/> |<span data-ttu-id="b110a-495">Toepassingsservers.</span><span class="sxs-lookup"><span data-stu-id="b110a-495">Application servers.</span></span>  <br/> |<span data-ttu-id="b110a-496">Vier processors</span><span class="sxs-lookup"><span data-stu-id="b110a-496">Four processors</span></span>  <br/> <span data-ttu-id="b110a-497">2-16 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-497">2-16 GB of RAM</span></span>  <br/> |
|<span data-ttu-id="b110a-498">SP-SQL-HA1, SP-SQL-HA2</span><span class="sxs-lookup"><span data-stu-id="b110a-498">SP-SQL-HA1, SP-SQL-HA2</span></span>  <br/> |<span data-ttu-id="b110a-499">Databaseservers, geconfigureerd met SQL Server 2012 AlwaysOn beschikbaarheidsgroepen om hoge beschikbaarheid te bieden.</span><span class="sxs-lookup"><span data-stu-id="b110a-499">Database servers, configured with SQL Server 2012 AlwaysOn availability groups to provide high availability.</span></span> <span data-ttu-id="b110a-500">In deze configuratie worden SP-SQL-HA1 en SP-SQL-HA2 gebruikt als primaire en secundaire replica's.</span><span class="sxs-lookup"><span data-stu-id="b110a-500">This configuration uses SP-SQL-HA1 and SP-SQL-HA2 as the primary and secondary replicas.</span></span>  <br/> |<span data-ttu-id="b110a-501">Vier processors</span><span class="sxs-lookup"><span data-stu-id="b110a-501">Four processors</span></span>  <br/> <span data-ttu-id="b110a-502">2-16 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-502">2-16 GB of RAM</span></span>  <br/> |
   
<span data-ttu-id="b110a-503">In de volgende tabel worden schijfconfiguraties beschreven voor de virtuele Hyper-V-machines die we hebben gemaakt en geconfigureerd voor de front-endweb- en toepassingsservers voor de on-premises testomgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-503">The following table describes drive configurations for the Hyper-V virtual machines that we created and configured for the front-end web and application servers for the on-premises test environment.</span></span>
  
<span data-ttu-id="b110a-504">**Tabel: Vereisten voor virtuele machinestation voor de front-endweb- en toepassingsservers voor de on-premises test**</span><span class="sxs-lookup"><span data-stu-id="b110a-504">**Table: Virtual machine drive requirements for the Front End Web and Application servers for the on-premises test**</span></span>

|<span data-ttu-id="b110a-505">**Brief van station**</span><span class="sxs-lookup"><span data-stu-id="b110a-505">**Drive letter**</span></span>|<span data-ttu-id="b110a-506">**Grootte**</span><span class="sxs-lookup"><span data-stu-id="b110a-506">**Size**</span></span>|<span data-ttu-id="b110a-507">**Adreslijstnaam**</span><span class="sxs-lookup"><span data-stu-id="b110a-507">**Directory name**</span></span>|<span data-ttu-id="b110a-508">**Pad**</span><span class="sxs-lookup"><span data-stu-id="b110a-508">**Path**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="b110a-509">C</span><span class="sxs-lookup"><span data-stu-id="b110a-509">C</span></span>  <br/> |<span data-ttu-id="b110a-510">80</span><span class="sxs-lookup"><span data-stu-id="b110a-510">80</span></span>  <br/> |<span data-ttu-id="b110a-511">Systeemstation</span><span class="sxs-lookup"><span data-stu-id="b110a-511">System drive</span></span>  <br/> |<span data-ttu-id="b110a-512"><DriveLetter>: \\ Programmabestanden \\ Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="b110a-512"><DriveLetter>:\\Program Files\\Microsoft SQL Server</span></span>\\  <br/> |
|<span data-ttu-id="b110a-513">E</span><span class="sxs-lookup"><span data-stu-id="b110a-513">E</span></span>  <br/> |<span data-ttu-id="b110a-514">80</span><span class="sxs-lookup"><span data-stu-id="b110a-514">80</span></span>  <br/> |<span data-ttu-id="b110a-515">Logboekstation (40 GB)</span><span class="sxs-lookup"><span data-stu-id="b110a-515">Log drive (40 GB)</span></span>  <br/> |<span data-ttu-id="b110a-516"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="b110a-516"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="b110a-517">F</span><span class="sxs-lookup"><span data-stu-id="b110a-517">F</span></span>  <br/> |<span data-ttu-id="b110a-518">80</span><span class="sxs-lookup"><span data-stu-id="b110a-518">80</span></span>  <br/> |<span data-ttu-id="b110a-519">Pagina (36 GB)</span><span class="sxs-lookup"><span data-stu-id="b110a-519">Page (36 GB)</span></span>  <br/> |<span data-ttu-id="b110a-520"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="b110a-520"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL\\DATA</span></span>  <br/> |
   
<span data-ttu-id="b110a-521">In de volgende tabel worden schijfconfiguraties beschreven voor de virtuele Hyper-V-machines die zijn gemaakt en geconfigureerd als de on-premises databaseservers.</span><span class="sxs-lookup"><span data-stu-id="b110a-521">The following table describes drive configurations for the Hyper-V virtual machines created and configured to serve as the on-premises database servers.</span></span> <span data-ttu-id="b110a-522">Ga op **de pagina Database Engine Configuration** naar het tabblad Gegevens **directories** om de instellingen in te stellen en te bevestigen die in de volgende tabel worden weergegeven.</span><span class="sxs-lookup"><span data-stu-id="b110a-522">On the **Database Engine Configuration** page, access the **Data Directories** tab to set and confirm the settings shown in the following table.</span></span>
  
<span data-ttu-id="b110a-523">**Tabel: Vereisten voor virtuele machinestation voor de databaseserver voor de on-premises test**</span><span class="sxs-lookup"><span data-stu-id="b110a-523">**Table: Virtual machine drive requirements for the database server for the on-premises test**</span></span>

|<span data-ttu-id="b110a-524">**Brief van station**</span><span class="sxs-lookup"><span data-stu-id="b110a-524">**Drive letter**</span></span>|<span data-ttu-id="b110a-525">**Grootte**</span><span class="sxs-lookup"><span data-stu-id="b110a-525">**Size**</span></span>|<span data-ttu-id="b110a-526">**Adreslijstnaam**</span><span class="sxs-lookup"><span data-stu-id="b110a-526">**Directory name**</span></span>|<span data-ttu-id="b110a-527">**Pad**</span><span class="sxs-lookup"><span data-stu-id="b110a-527">**Path**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="b110a-528">C</span><span class="sxs-lookup"><span data-stu-id="b110a-528">C</span></span>  <br/> |<span data-ttu-id="b110a-529">80</span><span class="sxs-lookup"><span data-stu-id="b110a-529">80</span></span>  <br/> |<span data-ttu-id="b110a-530">Adreslijst met gegevenswortels</span><span class="sxs-lookup"><span data-stu-id="b110a-530">Data root directory</span></span>  <br/> |<span data-ttu-id="b110a-531"><DriveLetter>: \\ Programmabestanden \\ Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="b110a-531"><DriveLetter>:\\Program Files\\Microsoft SQL Server</span></span>\\  <br/> |
|<span data-ttu-id="b110a-532">E</span><span class="sxs-lookup"><span data-stu-id="b110a-532">E</span></span>  <br/> |<span data-ttu-id="b110a-533">500</span><span class="sxs-lookup"><span data-stu-id="b110a-533">500</span></span>  <br/> |<span data-ttu-id="b110a-534">Gebruikersdatabasemap</span><span class="sxs-lookup"><span data-stu-id="b110a-534">User database directory</span></span>  <br/> |<span data-ttu-id="b110a-535"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="b110a-535"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="b110a-536">F</span><span class="sxs-lookup"><span data-stu-id="b110a-536">F</span></span>  <br/> |<span data-ttu-id="b110a-537">500</span><span class="sxs-lookup"><span data-stu-id="b110a-537">500</span></span>  <br/> |<span data-ttu-id="b110a-538">Gebruikersdatabaselogboekmap</span><span class="sxs-lookup"><span data-stu-id="b110a-538">User database log directory</span></span>  <br/> |<span data-ttu-id="b110a-539"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="b110a-539"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="b110a-540">G</span><span class="sxs-lookup"><span data-stu-id="b110a-540">G</span></span>  <br/> |<span data-ttu-id="b110a-541">500</span><span class="sxs-lookup"><span data-stu-id="b110a-541">500</span></span>  <br/> |<span data-ttu-id="b110a-542">Temp DB-adreslijst</span><span class="sxs-lookup"><span data-stu-id="b110a-542">Temp DB directory</span></span>  <br/> |<span data-ttu-id="b110a-543"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="b110a-543"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="b110a-544">H</span><span class="sxs-lookup"><span data-stu-id="b110a-544">H</span></span>  <br/> |<span data-ttu-id="b110a-545">500</span><span class="sxs-lookup"><span data-stu-id="b110a-545">500</span></span>  <br/> |<span data-ttu-id="b110a-546">Logboekmap temp DB</span><span class="sxs-lookup"><span data-stu-id="b110a-546">Temp DB log directory</span></span>  <br/> |<span data-ttu-id="b110a-547"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="b110a-547"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
   
### <a name="setting-up-the-test-environment"></a><span data-ttu-id="b110a-548">De testomgeving instellen</span><span class="sxs-lookup"><span data-stu-id="b110a-548">Setting up the test environment</span></span>

<span data-ttu-id="b110a-549">Tijdens de verschillende implementatiefasen heeft het testteam meestal eerst aan de on-premises architectuur gewerkt en vervolgens aan de bijbehorende Azure-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-549">During the different deployment phases, the test team typically worked on the on-premises architecture first and then on the corresponding Azure environment.</span></span> <span data-ttu-id="b110a-550">Dit komt overeen met de algemene reële gevallen waarin in-house productiebedrijven al actief zijn.</span><span class="sxs-lookup"><span data-stu-id="b110a-550">This reflects the general real-world cases where in-house production farms are already running.</span></span> <span data-ttu-id="b110a-551">Wat nog belangrijker is, is dat u de huidige productiebelasting, capaciteit en normale prestaties moet kennen.</span><span class="sxs-lookup"><span data-stu-id="b110a-551">What is even more important is that you should know the current production workload, capacity, and typical performance.</span></span> <span data-ttu-id="b110a-552">Naast het maken van een herstelmodel voor noodscenario's dat aan de bedrijfsvereisten kan voldoen, moet u de herstelfarmservers zo groot mogelijk maken om een minimaal serviceniveau te leveren.</span><span class="sxs-lookup"><span data-stu-id="b110a-552">In addition to building a disaster recovery model that can meet business requirements, you should size the recovery farm servers to deliver a minimum level of service.</span></span> <span data-ttu-id="b110a-553">In een koude of warme standby-omgeving is een herstelfarm meestal kleiner dan een productiefarm.</span><span class="sxs-lookup"><span data-stu-id="b110a-553">In a cold or warm standby environment, a recovery farm is typically smaller than a production farm.</span></span> <span data-ttu-id="b110a-554">Nadat de herstelfarm stabiel is en in productie is, kan de farm worden opgeschaald en uitgeschaald om te voldoen aan de vereisten voor werkbelasting.</span><span class="sxs-lookup"><span data-stu-id="b110a-554">After the recovery farm is stable and in production, the farm can be scaled up and out to meet workload requirements.</span></span>
  
<span data-ttu-id="b110a-555">We hebben onze testomgeving geïmplementeerd in de volgende drie fasen:</span><span class="sxs-lookup"><span data-stu-id="b110a-555">We deployed our test environment in the following three phases:</span></span>
  
- <span data-ttu-id="b110a-556">De hybride infrastructuur instellen</span><span class="sxs-lookup"><span data-stu-id="b110a-556">Set up the hybrid infrastructure</span></span>
    
- <span data-ttu-id="b110a-557">De servers inrichten</span><span class="sxs-lookup"><span data-stu-id="b110a-557">Provision the servers</span></span>
    
- <span data-ttu-id="b110a-558">SharePoint-farms implementeren</span><span class="sxs-lookup"><span data-stu-id="b110a-558">Deploy the SharePoint farms</span></span>
    
#### <a name="set-up-the-hybrid-infrastructure"></a><span data-ttu-id="b110a-559">De hybride infrastructuur instellen</span><span class="sxs-lookup"><span data-stu-id="b110a-559">Set up the hybrid infrastructure</span></span>

<span data-ttu-id="b110a-560">Deze fase betrof het instellen van een domeinomgeving voor de on-premises farm en voor de herstelfarm in Azure.</span><span class="sxs-lookup"><span data-stu-id="b110a-560">This phase involved setting up a domain environment for the on-premises farm and for the recovery farm in Azure.</span></span> <span data-ttu-id="b110a-561">Naast de normale taken die zijn gekoppeld aan het configureren van Active Directory, heeft het testteam een routeringsoplossing en een VPN-verbinding tussen de twee omgevingen geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="b110a-561">In addition to the normal tasks associated with configuring Active Directory, the test team implemented a routing solution and a VPN connection between the two environments.</span></span>
  
#### <a name="provision-the-servers"></a><span data-ttu-id="b110a-562">De servers inrichten</span><span class="sxs-lookup"><span data-stu-id="b110a-562">Provision the servers</span></span>

<span data-ttu-id="b110a-563">Naast de farmservers was het nodig om servers voor de domeincontrollers in te stellen en een server te configureren voor het verwerken van RRAS en de SITE-to-site VPN.</span><span class="sxs-lookup"><span data-stu-id="b110a-563">In addition to the farm servers, it was necessary to provision servers for the domain controllers and configure a server to handle RRAS as well as the site-to-site VPN.</span></span> <span data-ttu-id="b110a-564">Er zijn twee bestandsservers ingericht voor de DFSR-service en verschillende clientcomputers zijn ingericht voor testers.</span><span class="sxs-lookup"><span data-stu-id="b110a-564">Two file servers were provisioned for the DFSR service, and several client computers were provisioned for testers.</span></span>
  
#### <a name="deploy-the-sharepoint-farms"></a><span data-ttu-id="b110a-565">SharePoint-farms implementeren</span><span class="sxs-lookup"><span data-stu-id="b110a-565">Deploy the SharePoint farms</span></span>

<span data-ttu-id="b110a-566">De SharePoint-farms zijn in twee fasen geïmplementeerd om de omgevingsstabilisatie en probleemoplossing zo nodig te vereenvoudigen.</span><span class="sxs-lookup"><span data-stu-id="b110a-566">The SharePoint farms were deployed in two stages in order to simplify environment stabilization and troubleshooting, if required.</span></span> <span data-ttu-id="b110a-567">Tijdens de eerste fase is elke farm geïmplementeerd op het minimum aantal servers voor elke laag van de topologie ter ondersteuning van de vereiste functionaliteit.</span><span class="sxs-lookup"><span data-stu-id="b110a-567">During the first stage, each farm was deployed on the minimum number of servers for each tier of the topology to support the required functionality.</span></span>
  
<span data-ttu-id="b110a-568">We hebben de databaseservers gemaakt waarop SQL Server is geïnstalleerd voordat we de SharePoint 2013-servers maken.</span><span class="sxs-lookup"><span data-stu-id="b110a-568">We created the database servers with SQL Server installed before creating the SharePoint 2013 servers.</span></span> <span data-ttu-id="b110a-569">Omdat dit een nieuwe implementatie was, hebben we de beschikbaarheidsgroepen gemaakt voordat we SharePoint implementeren.</span><span class="sxs-lookup"><span data-stu-id="b110a-569">Because this was a new deployment, we created the availability groups before deploying SharePoint.</span></span> <span data-ttu-id="b110a-570">We hebben drie groepen gemaakt op basis van mcs-richtlijnen voor best practice.</span><span class="sxs-lookup"><span data-stu-id="b110a-570">We created three groups based on MCS best practice guidance.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b110a-571">Maak tijdelijke aanduidingendatabases zodat u beschikbaarheidsgroepen kunt maken vóór de SharePoint-installatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-571">Create placeholder databases so that you can create availability groups before the SharePoint installation.</span></span> <span data-ttu-id="b110a-572">Zie Sql [Server 2012 AlwaysOn Availability Groups for SharePoint 2013 configureren](/SharePoint/administration/configure-an-alwayson-availability-group) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-572">For more information, see [Configure SQL Server 2012 AlwaysOn Availability Groups for SharePoint 2013](/SharePoint/administration/configure-an-alwayson-availability-group)</span></span>
  
<span data-ttu-id="b110a-573">We hebben de farm gemaakt en hebben in de volgende volgorde aanvullende servers samengevoegd:</span><span class="sxs-lookup"><span data-stu-id="b110a-573">We created the farm and joined additional servers in the following order:</span></span>
  
- <span data-ttu-id="b110a-574">Inrichting SP-SQL-HA1 en SP-SQL-HA2.</span><span class="sxs-lookup"><span data-stu-id="b110a-574">Provision SP-SQL-HA1 and SP-SQL-HA2.</span></span>
    
- <span data-ttu-id="b110a-575">Configureer AlwaysOn en maak de drie beschikbaarheidsgroepen voor de farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-575">Configure AlwaysOn and create the three availability groups for the farm.</span></span> 
    
- <span data-ttu-id="b110a-576">Sp-APP1 inrichten om Centraal beheer te hosten.</span><span class="sxs-lookup"><span data-stu-id="b110a-576">Provision SP-APP1 to host Central Administration.</span></span>
    
- <span data-ttu-id="b110a-577">Inrichting SP-WFE1 en SP-WFE2 om de gedistribueerde cache te hosten.</span><span class="sxs-lookup"><span data-stu-id="b110a-577">Provision SP-WFE1 and SP-WFE2 to host the distributed cache.</span></span> 
    
<span data-ttu-id="b110a-578">We hebben de  _parameter SkipRegisterAsDistributedCachehost_ gebruiktpsconfig.exe **de** opdrachtregel.</span><span class="sxs-lookup"><span data-stu-id="b110a-578">We used the  _skipRegisterAsDistributedCachehost_ parameter when we ran **psconfig.exe** at the command line.</span></span> <span data-ttu-id="b110a-579">Zie Plannen voor feeds en de [distributed cache-service in SharePoint Server 2013](/sharepoint/administration/plan-for-feeds-and-the-distributed-cache-service)voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-579">For more information, see [Plan for feeds and the Distributed Cache service in SharePoint Server 2013](/sharepoint/administration/plan-for-feeds-and-the-distributed-cache-service).</span></span> 
  
<span data-ttu-id="b110a-580">We hebben de volgende stappen in de herstelomgeving herhaald:</span><span class="sxs-lookup"><span data-stu-id="b110a-580">We repeated the following steps in the recovery environment:</span></span>
  
- <span data-ttu-id="b110a-581">Inrichting AZ-SQL-HA1 en AZ-SQL-HA2.</span><span class="sxs-lookup"><span data-stu-id="b110a-581">Provision AZ-SQL-HA1 and AZ-SQL-HA2.</span></span>
    
- <span data-ttu-id="b110a-582">Configureer AlwaysOn en maak de drie beschikbaarheidsgroepen voor de farm.</span><span class="sxs-lookup"><span data-stu-id="b110a-582">Configure AlwaysOn and create the three availability groups for the farm.</span></span>
    
- <span data-ttu-id="b110a-583">Inrichting AZ-APP1 voor het hosten van Centraal beheer.</span><span class="sxs-lookup"><span data-stu-id="b110a-583">Provision AZ-APP1 to host Central Administration.</span></span>
    
- <span data-ttu-id="b110a-584">Inrichting AZ-WFE1 en AZ-WFE2 om de gedistribueerde cache te hosten.</span><span class="sxs-lookup"><span data-stu-id="b110a-584">Provision AZ-WFE1 and AZ-WFE2 to host the distributed cache.</span></span>
    
<span data-ttu-id="b110a-585">Nadat we de gedistribueerde cache hebben geconfigureerd en testgebruikers en testinhoud hebben toegevoegd, zijn we gestart met fase twee van de implementatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-585">After we configured the distributed cache and added test users and test content, we started stage two of the deployment.</span></span> <span data-ttu-id="b110a-586">Dit vereist het uitschalen van de lagen en het configureren van de farmservers ter ondersteuning van de topologie met hoge beschikbaarheid die in de farmarchitectuur wordt beschreven.</span><span class="sxs-lookup"><span data-stu-id="b110a-586">This required scaling out the tiers and configuring the farm servers to support the high-availability topology described in the farm architecture.</span></span>
  
<span data-ttu-id="b110a-587">In de volgende tabel worden de virtuele machines, subnetten en beschikbaarheidssets beschreven die we voor onze herstelfarm hebben ingesteld.</span><span class="sxs-lookup"><span data-stu-id="b110a-587">The following table describes the virtual machines, subnets, and availability sets we set up for our recovery farm.</span></span>
  
<span data-ttu-id="b110a-588">**Tabel: Herstelfarminfrastructuur**</span><span class="sxs-lookup"><span data-stu-id="b110a-588">**Table: Recovery farm infrastructure**</span></span>

|<span data-ttu-id="b110a-589">**Servernaam**</span><span class="sxs-lookup"><span data-stu-id="b110a-589">**Server name**</span></span>|<span data-ttu-id="b110a-590">**Rol**</span><span class="sxs-lookup"><span data-stu-id="b110a-590">**Role**</span></span>|<span data-ttu-id="b110a-591">**Configuratie**</span><span class="sxs-lookup"><span data-stu-id="b110a-591">**Configuration**</span></span>|<span data-ttu-id="b110a-592">**Subnet**</span><span class="sxs-lookup"><span data-stu-id="b110a-592">**Subnet**</span></span>|<span data-ttu-id="b110a-593">**Beschikbaarheidsset**</span><span class="sxs-lookup"><span data-stu-id="b110a-593">**Availability set**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="b110a-594">spDRAD</span><span class="sxs-lookup"><span data-stu-id="b110a-594">spDRAD</span></span>  <br/> |<span data-ttu-id="b110a-595">Domeincontroller met Active Directory</span><span class="sxs-lookup"><span data-stu-id="b110a-595">Domain controller with Active Directory</span></span>  <br/> |<span data-ttu-id="b110a-596">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-596">Two processors</span></span>  <br/> <span data-ttu-id="b110a-597">Van 512 MB tot 4 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-597">From 512 MB through 4 GB of RAM</span></span>  <br/> <span data-ttu-id="b110a-598">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-598">1 x 127-GB hard disk</span></span>  <br/> |<span data-ttu-id="b110a-599">sp-ADservers</span><span class="sxs-lookup"><span data-stu-id="b110a-599">sp-ADservers</span></span>  <br/> ||
|<span data-ttu-id="b110a-600">AZ-SP-FS</span><span class="sxs-lookup"><span data-stu-id="b110a-600">AZ-SP-FS</span></span>  <br/> |<span data-ttu-id="b110a-601">Bestandsserver met aandelen voor back-ups en een eindpunt voor DFSR</span><span class="sxs-lookup"><span data-stu-id="b110a-601">File server with shares for backups and an endpoint for DFSR</span></span>  <br/> | <span data-ttu-id="b110a-602">A5-configuratie:</span><span class="sxs-lookup"><span data-stu-id="b110a-602">A5 configuration:</span></span> <br/>  <span data-ttu-id="b110a-603">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-603">Two processors</span></span> <br/>  <span data-ttu-id="b110a-604">14 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-604">14 GB of RAM</span></span> <br/>  <span data-ttu-id="b110a-605">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-605">1 x 127-GB hard disk</span></span> <br/>  <span data-ttu-id="b110a-606">Harde schijf van 1 x 135 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-606">1 x 135-GB hard disk</span></span> <br/>  <span data-ttu-id="b110a-607">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-607">1 x 127-GB hard disk</span></span> <br/>  <span data-ttu-id="b110a-608">Harde schijf van 1 x 150 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-608">1 x 150-GB hard disk</span></span> <br/> |<span data-ttu-id="b110a-609">sp-databaseservers</span><span class="sxs-lookup"><span data-stu-id="b110a-609">sp-databaseservers</span></span>  <br/> |<span data-ttu-id="b110a-610">DATA_SET</span><span class="sxs-lookup"><span data-stu-id="b110a-610">DATA_SET</span></span>  <br/> |
|<span data-ttu-id="b110a-611">AZ-WFE1, AZ -WFE2</span><span class="sxs-lookup"><span data-stu-id="b110a-611">AZ-WFE1, AZ -WFE2</span></span>  <br/> |<span data-ttu-id="b110a-612">Front End-webservers</span><span class="sxs-lookup"><span data-stu-id="b110a-612">Front End Web servers</span></span>  <br/> | <span data-ttu-id="b110a-613">A5-configuratie:</span><span class="sxs-lookup"><span data-stu-id="b110a-613">A5 configuration:</span></span> <br/>  <span data-ttu-id="b110a-614">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-614">Two processors</span></span> <br/>  <span data-ttu-id="b110a-615">14 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-615">14 GB of RAM</span></span> <br/>  <span data-ttu-id="b110a-616">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-616">1 x 127-GB hard disk</span></span> <br/> |<span data-ttu-id="b110a-617">sp-webservers</span><span class="sxs-lookup"><span data-stu-id="b110a-617">sp-webservers</span></span>  <br/> |<span data-ttu-id="b110a-618">WFE_SET</span><span class="sxs-lookup"><span data-stu-id="b110a-618">WFE_SET</span></span>  <br/> |
|<span data-ttu-id="b110a-619">AZ -APP1, AZ -APP2, AZ -APP3</span><span class="sxs-lookup"><span data-stu-id="b110a-619">AZ -APP1, AZ -APP2, AZ -APP3</span></span>  <br/> |<span data-ttu-id="b110a-620">Toepassingsservers</span><span class="sxs-lookup"><span data-stu-id="b110a-620">Application servers</span></span>  <br/> | <span data-ttu-id="b110a-621">A5-configuratie:</span><span class="sxs-lookup"><span data-stu-id="b110a-621">A5 configuration:</span></span> <br/>  <span data-ttu-id="b110a-622">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-622">Two processors</span></span> <br/>  <span data-ttu-id="b110a-623">14 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-623">14 GB of RAM</span></span> <br/>  <span data-ttu-id="b110a-624">Harde schijf van 1 x 127 GB</span><span class="sxs-lookup"><span data-stu-id="b110a-624">1 x 127-GB hard disk</span></span> <br/> |<span data-ttu-id="b110a-625">sp-applicationservers</span><span class="sxs-lookup"><span data-stu-id="b110a-625">sp-applicationservers</span></span>  <br/> |<span data-ttu-id="b110a-626">APP_SET</span><span class="sxs-lookup"><span data-stu-id="b110a-626">APP_SET</span></span>  <br/> |
|<span data-ttu-id="b110a-627">AZ -SQL-HA1, AZ -SQL-HA2</span><span class="sxs-lookup"><span data-stu-id="b110a-627">AZ -SQL-HA1, AZ -SQL-HA2</span></span>  <br/> |<span data-ttu-id="b110a-628">Databaseservers en primaire en secundaire replica's voor AlwaysOn-beschikbaarheidsgroepen</span><span class="sxs-lookup"><span data-stu-id="b110a-628">Database servers and primary and secondary replicas for AlwaysOn availability groups</span></span>  <br/> | <span data-ttu-id="b110a-629">A5-configuratie:</span><span class="sxs-lookup"><span data-stu-id="b110a-629">A5 configuration:</span></span> <br/>  <span data-ttu-id="b110a-630">Twee processors</span><span class="sxs-lookup"><span data-stu-id="b110a-630">Two processors</span></span> <br/>  <span data-ttu-id="b110a-631">14 GB RAM</span><span class="sxs-lookup"><span data-stu-id="b110a-631">14 GB of RAM</span></span> <br/> |<span data-ttu-id="b110a-632">sp-databaseservers</span><span class="sxs-lookup"><span data-stu-id="b110a-632">sp-databaseservers</span></span>  <br/> |<span data-ttu-id="b110a-633">DATA_SET</span><span class="sxs-lookup"><span data-stu-id="b110a-633">DATA_SET</span></span>  <br/> |
   
### <a name="operations"></a><span data-ttu-id="b110a-634">Operations</span><span class="sxs-lookup"><span data-stu-id="b110a-634">Operations</span></span>

<span data-ttu-id="b110a-635">Nadat het testteam de farmomgevingen heeft gestabiliseerd en functionele tests heeft voltooid, zijn de volgende bewerkingen uitgevoerd die nodig zijn om de on-premises herstelomgeving te configureren:</span><span class="sxs-lookup"><span data-stu-id="b110a-635">After the test team stabilized the farm environments and completed functional testing, they started the following operations tasks required to configure the on-premises recovery environment:</span></span>
  
- <span data-ttu-id="b110a-636">Volledige en differentiële back-ups configureren.</span><span class="sxs-lookup"><span data-stu-id="b110a-636">Configure full and differential backups.</span></span>
    
- <span data-ttu-id="b110a-637">Configureer DFSR op de bestandsservers die transactielogboeken overbrengen tussen de on-premises omgeving en de Azure-omgeving.</span><span class="sxs-lookup"><span data-stu-id="b110a-637">Configure DFSR on the file servers that transfer transaction logs between the on-premises environment and the Azure environment.</span></span>
    
- <span data-ttu-id="b110a-638">Logboekverzending configureren op de primaire databaseserver.</span><span class="sxs-lookup"><span data-stu-id="b110a-638">Configure log shipping on the primary database server.</span></span>
    
- <span data-ttu-id="b110a-639">Stabiliseren, valideren en probleemoplossing voor het verzenden van logboeken, indien vereist.</span><span class="sxs-lookup"><span data-stu-id="b110a-639">Stabilize, validate, and troubleshoot log shipping, as required.</span></span> <span data-ttu-id="b110a-640">Dit omvatte het identificeren en documenteren van gedrag dat problemen kan veroorzaken, zoals netwerklatentie, waardoor logboekverzending of DFSR-bestandssynchronisatiefouten zouden veroorzaken.</span><span class="sxs-lookup"><span data-stu-id="b110a-640">This included identifying and documenting any behavior that might cause issues, such as network latency, which would cause log shipping or DFSR file synchronization failures.</span></span>
    
### <a name="databases"></a><span data-ttu-id="b110a-641">Databases</span><span class="sxs-lookup"><span data-stu-id="b110a-641">Databases</span></span>

<span data-ttu-id="b110a-642">Bij onze failovertests zijn de volgende databases betrokken:</span><span class="sxs-lookup"><span data-stu-id="b110a-642">Our failover tests involved the following databases:</span></span> 
  
- <span data-ttu-id="b110a-643">WSS_Content</span><span class="sxs-lookup"><span data-stu-id="b110a-643">WSS_Content</span></span>
    
- <span data-ttu-id="b110a-644">ManagedMetadata</span><span class="sxs-lookup"><span data-stu-id="b110a-644">ManagedMetadata</span></span>
    
- <span data-ttu-id="b110a-645">Profiel DB</span><span class="sxs-lookup"><span data-stu-id="b110a-645">Profile DB</span></span>
    
- <span data-ttu-id="b110a-646">DB synchroniseren</span><span class="sxs-lookup"><span data-stu-id="b110a-646">Sync DB</span></span>
    
- <span data-ttu-id="b110a-647">Sociale DB</span><span class="sxs-lookup"><span data-stu-id="b110a-647">Social DB</span></span>
    
- <span data-ttu-id="b110a-648">Hub inhoudstype (een database voor een speciale Hub voor syndicatie van inhoudstype)</span><span class="sxs-lookup"><span data-stu-id="b110a-648">Content Type Hub (a database for a dedicated Content Type Syndication Hub)</span></span>
    
## <a name="troubleshooting-tips"></a><span data-ttu-id="b110a-649">Tips voor probleemoplossing</span><span class="sxs-lookup"><span data-stu-id="b110a-649">Troubleshooting tips</span></span>

<span data-ttu-id="b110a-650">In de sectie worden de problemen uitgelegd die we hebben ondervonden tijdens het testen en hun oplossingen.</span><span class="sxs-lookup"><span data-stu-id="b110a-650">The section explains the problems we encountered during our testing and their solutions.</span></span> 
  
### <a name="using-the-term-store-management-tool-caused-the-error-the-managed-metadata-store-or-connection-is-currently-not-available"></a><span data-ttu-id="b110a-651">Met behulp van het hulpprogramma voor beheer van het Term Store is de fout opgetreden: 'Het beheerde metagegevensopslag- of verbindingsbeheer is momenteel niet beschikbaar'.</span><span class="sxs-lookup"><span data-stu-id="b110a-651">Using the Term Store Management Tool caused the error, "The Managed Metadata Store or Connection is currently not available."</span></span>

<span data-ttu-id="b110a-652">Zorg ervoor dat het account voor de groep toepassingen dat door de webtoepassing wordt gebruikt, de machtiging Leestoegang tot het termstore heeft.</span><span class="sxs-lookup"><span data-stu-id="b110a-652">Ensure that the application pool account used by the web application has the Read Access to Term Store permission.</span></span>
  
### <a name="custom-term-sets-are-not-available-in-the-site-collection"></a><span data-ttu-id="b110a-653">Aangepaste termsets zijn niet beschikbaar in de siteverzameling</span><span class="sxs-lookup"><span data-stu-id="b110a-653">Custom term sets are not available in the site collection</span></span>

<span data-ttu-id="b110a-654">Controleer of er een ontbrekende servicetoepassingsverzameling is tussen uw inhoudssiteverzameling en uw hub voor inhoudstype.</span><span class="sxs-lookup"><span data-stu-id="b110a-654">Check for a missing service application association between your content site collection and your content type hub.</span></span> <span data-ttu-id="b110a-655">Zorg er bovendien voor dat deze optie is ingeschakeld onder het scherm Beheerde metagegevens **- <site collection name>** Verbindingseigenschappen: Deze servicetoepassing is de standaardopslaglocatie voor **kolomspecifieke termsets.**</span><span class="sxs-lookup"><span data-stu-id="b110a-655">In addition, under the **Managed Metadata - <site collection name> Connection** properties screen, make sure this option is enabled: **This service application is the default storage location for column specific term sets.**</span></span>
  
### <a name="the-get-adforest-windows-powershell-command-generates-the-error-the-term-get-adforest-is-not-recognized-as-the-name-of-a-cmdlet-function-script-file-or-operable-program"></a><span data-ttu-id="b110a-656">De Get-ADForest Windows PowerShell-opdracht genereert de fout 'Get-ADForest' wordt niet herkend als de naam van een cmdlet, functie, scriptbestand of operabaar programma.</span><span class="sxs-lookup"><span data-stu-id="b110a-656">The Get-ADForest Windows PowerShell command generates the error, "The term 'Get-ADForest' is not recognized as the name of a cmdlet, function, script file, or operable program."</span></span>

<span data-ttu-id="b110a-657">Wanneer u gebruikersprofielen instelt, hebt u de active directory-forestnaam nodig.</span><span class="sxs-lookup"><span data-stu-id="b110a-657">When setting up user profiles, you need the Active Directory forest name.</span></span> <span data-ttu-id="b110a-658">Controleer in de wizard Rollen en functies toevoegen of u de Active Directory-module voor Windows PowerShell hebt ingeschakeld (onder de sectie Hulpprogramma's voor extern serverbeheer>Hulpprogramma's voor rollenbeheer>de sectie **AD DS- en AD LDS-hulpmiddelen).**</span><span class="sxs-lookup"><span data-stu-id="b110a-658">In the Add Roles and Features Wizard, ensure that you have enabled the Active Directory Module for Windows PowerShell (under the **Remote Server Administration Tools>Role Administration Tools>AD DS and AD LDS Tools** section).</span></span> <span data-ttu-id="b110a-659">Voer bovendien de volgende opdrachten uit voordat u **Get-ADForest** gebruikt om ervoor te zorgen dat uw softwareafhankelijkheden worden geladen.</span><span class="sxs-lookup"><span data-stu-id="b110a-659">In addition, run the following commands before using **Get-ADForest** to help ensure that your software dependencies are loaded.</span></span>
  
```
Import-module servermanager
Import-module activedirectory

```

### <a name="availability-group-creation-fails-at-starting-the-alwayson_health-xevent-session-on-server-name"></a><span data-ttu-id="b110a-660">Het maken van beschikbaarheidsgroep mislukt bij Het starten van de 'AlwaysOn_health' XEvent-sessie op <server name> '</span><span class="sxs-lookup"><span data-stu-id="b110a-660">Availability group creation fails at Starting the 'AlwaysOn_health' XEvent session on '<server name>'</span></span>

<span data-ttu-id="b110a-661">Zorg ervoor dat beide knooppunten van uw failovercluster zich in de status 'Up' en niet 'Onderbroken' of 'Gestopt' hebben.</span><span class="sxs-lookup"><span data-stu-id="b110a-661">Ensure that both nodes of your failover cluster are in the Status "Up" and not "Paused" or "Stopped".</span></span> 
  
### <a name="sql-server-log-shipping-job-fails-with-access-denied-error-trying-to-connect-to-the-file-share"></a><span data-ttu-id="b110a-662">Verzendklus van SQL Server-logboek mislukt met fout bij toegang geweigerd bij het maken van verbinding met de bestandsindeling</span><span class="sxs-lookup"><span data-stu-id="b110a-662">SQL Server log shipping job fails with access denied error trying to connect to the file share</span></span>

<span data-ttu-id="b110a-663">Zorg ervoor dat uw SQL Server-agent wordt uitgevoerd onder netwerkreferenties, in plaats van de standaardreferenties.</span><span class="sxs-lookup"><span data-stu-id="b110a-663">Ensure that your SQL Server Agent is running under network credentials, instead of the default credentials.</span></span>
  
### <a name="sql-server-log-shipping-job-indicates-success-but-no-files-are-copied"></a><span data-ttu-id="b110a-664">Sql Server-logboekzendingsbaan geeft succes aan, maar er worden geen bestanden gekopieerd</span><span class="sxs-lookup"><span data-stu-id="b110a-664">SQL Server log shipping job indicates success, but no files are copied</span></span>

<span data-ttu-id="b110a-665">Dit gebeurt omdat de standaardvoorkeur voor een back-up voor een beschikbaarheidsgroep **De voorkeur geeft aan Secundair**.</span><span class="sxs-lookup"><span data-stu-id="b110a-665">This happens because the default backup preference for an availability group is **Prefer Secondary**.</span></span> <span data-ttu-id="b110a-666">Controleer of u de taak voor het verzenden van logboeken vanaf de secundaire server voor de beschikbaarheidsgroep in plaats van de primaire taak hebt uitgevoerd. anders mislukt de taak in stilte.</span><span class="sxs-lookup"><span data-stu-id="b110a-666">Ensure that you run the log shipping job from the secondary server for the availability group instead of the primary; otherwise, the job will fail silently.</span></span> 
  
### <a name="managed-metadata-service-or-other-sharepoint-service-fails-to-start-automatically-after-installation"></a><span data-ttu-id="b110a-667">Beheerde metagegevensservice (of andere SharePoint-service) kan niet automatisch worden begonnen na de installatie</span><span class="sxs-lookup"><span data-stu-id="b110a-667">Managed Metadata service (or other SharePoint service) fails to start automatically after installation</span></span>

<span data-ttu-id="b110a-668">Het kan enkele minuten duren voordat services zijn begonnen, afhankelijk van de prestaties en de huidige belasting van uw SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="b110a-668">Services might take several minutes to start, depending on the performance and current load of your SharePoint Server.</span></span> <span data-ttu-id="b110a-669">Klik handmatig op **Start** voor de service en geef voldoende tijd om op te starten terwijl u af en toe het scherm Services op Server ververst om de status ervan te controleren.</span><span class="sxs-lookup"><span data-stu-id="b110a-669">Manually click **Start** for the service and provide adequate time for startup while occasionally refreshing the Services on Server screen to monitor its status.</span></span> <span data-ttu-id="b110a-670">Als de service wordt stopgezet, schakelt u diagnostische logboekregistratie van SharePoint in, probeert u de service opnieuw te starten en controleert u het logboek op fouten.</span><span class="sxs-lookup"><span data-stu-id="b110a-670">In case the service remains stopped, enable SharePoint diagnostic logging, attempt to start the service again, and then check the log for errors.</span></span> <span data-ttu-id="b110a-671">Zie Diagnostische logboekregistratie [configureren in SharePoint 2013](/sharepoint/administration/configure-diagnostic-logging) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b110a-671">For more information, see [Configure diagnostic logging in SharePoint 2013](/sharepoint/administration/configure-diagnostic-logging)</span></span>
  
### <a name="after-changing-dns-to-the-azure-failover-environment-client-browsers-continue-to-use-the-old-ip-address-for-the-sharepoint-site"></a><span data-ttu-id="b110a-672">Nadat u DNS hebt veranderd in de Azure Failover-omgeving, blijven clientbrowsers het oude IP-adres voor de SharePoint-site gebruiken</span><span class="sxs-lookup"><span data-stu-id="b110a-672">After changing DNS to the Azure failover environment, client browsers continue to use the old IP address for the SharePoint site</span></span>

<span data-ttu-id="b110a-673">Uw DNS-wijziging is mogelijk niet direct zichtbaar voor alle clients.</span><span class="sxs-lookup"><span data-stu-id="b110a-673">Your DNS change might not be visible to all clients immediately.</span></span> <span data-ttu-id="b110a-674">Voer in een testclient de volgende opdracht uit vanuit een verhoogde opdrachtprompt en probeer de site opnieuw te openen.</span><span class="sxs-lookup"><span data-stu-id="b110a-674">On a test client, perform the following command from an elevated command prompt and attempt to access the site again.</span></span>
  
```
Ipconfig /flushdns
```

## <a name="additional-resources"></a><span data-ttu-id="b110a-675">Aanvullende bronnen</span><span class="sxs-lookup"><span data-stu-id="b110a-675">Additional resources</span></span>

[<span data-ttu-id="b110a-676">Ondersteunde opties voor hoge beschikbaarheid en herstel na noodherstel voor SharePoint-databases</span><span class="sxs-lookup"><span data-stu-id="b110a-676">Supported high availability and disaster recovery options for SharePoint databases</span></span>](/sharepoint/administration/supported-high-availability-and-disaster-recovery-options-for-sharepoint-databas)
  
[<span data-ttu-id="b110a-677">SQL Server 2012 altijdop beschikbaarheidsgroepen configureren voor SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="b110a-677">Configure SQL Server 2012 AlwaysOn Availability Groups for SharePoint 2013</span></span>](/SharePoint/administration/configure-an-alwayson-availability-group)
  
## <a name="see-also"></a><span data-ttu-id="b110a-678">Zie ook</span><span class="sxs-lookup"><span data-stu-id="b110a-678">See Also</span></span>

[<span data-ttu-id="b110a-679">Microsoft 365-oplossings- en -architectuurcentrum</span><span class="sxs-lookup"><span data-stu-id="b110a-679">Microsoft 365 solution and architecture center</span></span>](../solutions/index.yml)